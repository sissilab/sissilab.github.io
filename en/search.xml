<?xml version="1.0" encoding="utf-8"?>
<search>
    
    
    
    <entry>
        <title>Arch Linux KDE Hibernate Configuration</title>
        <link href="/en/os/arch-linux-kde-hibernate-configuration/"/>
        <url>/en/os/arch-linux-kde-hibernate-configuration/</url>
        
        <content type="html"><![CDATA[<details class="custom-callout info" open><summary class="callout-title"><div class="callout-icon"></div><div>Power Management/Suspend and Hibernate</div><div class="callout-fold"></div></summary><div class="callout-body"><p>Usually, on Linux, there are various methods available for suspending the system. The system state is saved in memory or on the disk, entering a low-power mode. When the computer is resumed, it allows for a quick recovery to the previous state.</p><ul><li><strong>Suspend to RAM (Suspend to memory, commonly known as suspend/sleep)</strong>: Saves the current system state in RAM by powering down most components in the machine that are not related to RAM. In this case, RAM is necessary to restore the machine’s state and must continue to be powered. Since the system state is stored in RAM, the system recovery speed is very fast.</li><li><strong>Suspend to disk (Suspend to hard disk, commonly known as hibernate)</strong>: Saves the current system state on the disk (usually in a swap partition or swap file) and then turns off the power. When resuming, the system recovers data from the disk. Compared to the RAM method, hibernation can maintain the system state for a longer period, but the recovery time is longer. This article mainly introduces how to enable and configure hibernation mode.</li><li><strong>Suspend to both (Suspend to both/hybrid suspend)</strong>: Combines the advantages of suspending to RAM and disk methods. It saves the current system state on the disk (swap space) and then enters sleep mode while keeping RAM powered. When resuming, the system will first recover quickly from RAM, and if RAM is lost, it will recover from the disk. For example, if the battery is depleted, the system will recover from the disk.</li></ul></div></details><h1 id="adding-swap"><a class="markdownIt-Anchor" href="#adding-swap"></a> Adding Swap</h1><blockquote><p><a href="https://wiki.archlinux.org/title/Swap">Swap - ArchWiki</a></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If there is no swap space currently, a new swap needs to be created</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Use <span class="built_in">dd</span> to create a 15 GiB swap file</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=/swapfile bs=1M count=15k status=progress</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Set the right permissions (a world-readable swap file is a huge <span class="built_in">local</span> vulnerability):</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">chmod</span> 0600 /swapfile</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">After creating the correctly sized file, format it to swap:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo mkswap -U clear /swapfile</span></span><br><span class="line">mkswap: /swapfile: warning: wiping old swap signature.</span><br><span class="line">Setting up swapspace version 1, size = 15 GiB (16106123264 bytes)</span><br><span class="line">no label, UUID=00000000-0000-0000-0000-000000000000</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Activate the swap file:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo swapon /swapfile</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Finally, edit the fstab configuration to add an entry <span class="keyword">for</span> the swap file:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo vim /etc/fstab</span></span><br><span class="line">/swapfile none swap defaults 0 0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Verify <span class="keyword">if</span> the swap is active:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo swapon --show</span></span><br><span class="line">NAME      TYPE SIZE USED PRIO</span><br><span class="line">/swapfile file  15G 256K   -2</span><br></pre></td></tr></table></figure><h1 id="hibernate"><a class="markdownIt-Anchor" href="#hibernate"></a> Hibernate</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Confirm the UUID of the partition <span class="built_in">where</span> the swap file is located</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">findmnt -no UUID -T /swapfile</span></span><br><span class="line">0fdd557a-e3bb-4db4-a93a-0d1ebcf75769</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check the swapfile offset <span class="keyword">for</span> use with resume_offset</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo filefrag -v /swapfile | awk <span class="string">&#x27;&#123; if($1==&quot;0:&quot;)&#123;print substr($4, 1, length($4)-2)&#125; &#125;&#x27;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The resume parameter is the partition <span class="built_in">where</span> the swap file is located, <span class="built_in">which</span> can be specified as /dev/nvme0n1p5 or UUID=0fdd557a-e3bb-4db4-a93a-0d1ebcf75769</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">resume_offset is the physical offset of the file<span class="string">&#x27;s beginning in this partition, which can be viewed with `filefrag -v /swapfile`.</span></span></span><br><span class="line">resume=UUID=0fdd557a-e3bb-4db4-a93a-0d1ebcf75769 resume_offset=17278976</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Regarding the setting of kernel parameters, if using GRUB, append to GRUB_CMDLINE_LINUX_DEFAULT</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo vim /etc/default/grub</span></span></span><br><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=&quot;loglevel=3 quiet resume=UUID=0fdd557a-e3bb-4db4-a93a-0d1ebcf75769 resume_offset=17278976&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Regenerate grub.cfg</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo grub-mkconfig -o /boot/grub/grub.cfg</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">##################</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If your initramfs does not use the systemd hook (uses base), then you also need to add a resume hook to attempt to recover from hibernation:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Edit the /etc/mkinitcpio.conf file, add resume to any position after udev in HOOKS=(...).</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo vim /etc/mkinitcpio.conf</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Finally, regenerate the initramfs:</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo mkinitcpio -p linux</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The configuration work is all done, hibernate through `systemctl hibernate`, and then press the power button to start up and check if the hibernation function is working properly.</span></span></span><br></pre></td></tr></table></figure><h1 id="references"><a class="markdownIt-Anchor" href="#references"></a> References</h1><ul><li><a href="https://wiki.archlinux.org/title/Power_management/Suspend_and_hibernate">Power management/Suspend and hibernate - ArchWiki</a></li><li><a href="https://timothyqiu.com/archives/104/">给 Arch 添加 Swap 文件</a></li><li><a href="https://wiki.archlinux.org/title/Power_management/Suspend_and_hibernate#Hibernation">Power management/Suspend and hibernate - ArchWiki</a></li><li><a href="https://harttle.land/2019/10/19/hibernate-archlinux.html">ArchLinux 休眠到交换文件 | Harttle Land</a></li></ul>]]></content>
        
        
        <categories>
            
            <category> Arch Linux Series </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Arch_Linux </tag>
            
            <tag> OS </tag>
            
        </tags>
        
    </entry>
    
    
    
    <entry>
        <title>Common Software and Configuration for Arch Linux</title>
        <link href="/en/os/common-software-and-configuration-for-arch-linux/"/>
        <url>/en/os/common-software-and-configuration-for-arch-linux/</url>
        
        <content type="html"><![CDATA[<h1 id="input-method"><a class="markdownIt-Anchor" href="#input-method"></a> Input method</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install Pinyin Input Method fcitx5</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. Install fcitx5 related packages</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">fcitx5-pinyin-zhwiki: Offline dictionary</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-material-color fcitx5-pinyin-zhwiki</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. Configure environment variables</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo vim /etc/environment</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> fcitx5</span></span><br><span class="line">INPUT_METHOD=fcitx5  </span><br><span class="line">GTK_IM_MODULE=fcitx5  </span><br><span class="line">QT_IM_MODULE=fcitx5  </span><br><span class="line">XMODIFIERS=@im=fcitx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Supplement:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim ~/.xprofile</span></span><br><span class="line">export INPUT_METHOD=fcitx5</span><br><span class="line">export GTK_IM_MODULE=fcitx5</span><br><span class="line">export QT_IM_MODULE=fcitx5</span><br><span class="line">export XMODIFIERS=@im=fcitx5</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. Add autostart</span></span><br><span class="line">System Settings / Startup and shutdown / Autostart：点击 Add / Add Application，搜索 fcitx5，并添加 /usr/bin/fcitx5。</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4. Restart, take effect</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5. Add input method</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">System Setting / Search `Input method`: Click `Add Input Method`, search <span class="keyword">for</span> `pinyin`, and add.</span></span><br></pre></td></tr></table></figure><h1 id="install-zshoh-my-zsh-and-related-plugins"><a class="markdownIt-Anchor" href="#install-zshoh-my-zsh-and-related-plugins"></a> Install zsh/oh-my-zsh and related plugins</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Most default shells are bash, it is recommended to use zsh, <span class="built_in">which</span> provides more useful features</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install zsh</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S zsh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Change default shell, or edit /etc/passwd file, modify the default shell (/bin/zsh) after the username to change the default shell</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">chsh -s /bin/zsh</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install oh-my-zsh-git: It is a community-driven zsh management tool that provides rich plugins and themes</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S oh-my-zsh-git</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Default configuration</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">cp</span> /usr/share/oh-my-zsh/zshrc ~/.zshrc</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Change theme: Modify ZSH_THEME to the theme you want, themes can be seen at: https://github.com/ohmyzsh/ohmyzsh/wiki/Themes</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim ~/.zshrc</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Plugins: https://github.com/ohmyzsh/ohmyzsh/wiki/Plugins-Overview</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install plugins:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zsh-syntax-highlighting: Provides <span class="built_in">command</span> highlighting, <span class="keyword">for</span> example, commands that are entered incorrectly are displayed <span class="keyword">in</span> red, and commands that are entered correctly are displayed <span class="keyword">in</span> green</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zsh-autosuggestions: Provides <span class="built_in">command</span> suggestions, <span class="built_in">which</span> can automatically suggest completion based on the Shell commands you execute</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S zsh-syntax-highlighting zsh-autosuggestions</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Plugins that need to be installed are placed <span class="keyword">in</span> `/usr/share/oh-my-zsh/custom/plugins/`</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">ln</span> -s /usr/share/zsh/plugins/zsh-syntax-highlighting /usr/share/oh-my-zsh/custom/plugins/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">ln</span> -s /usr/share/zsh/plugins/zsh-autosuggestions /usr/share/oh-my-zsh/custom/plugins/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">autojump: Fuzzy address jump based on access records, usage document: https://github.com/wting/autojump</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S autojump</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Configure plugins to be added</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim ~/.zshrc</span></span><br><span class="line">plugins=(</span><br><span class="line">        git</span><br><span class="line">        autojump</span><br><span class="line">        zsh-syntax-highlighting</span><br><span class="line">        zsh-autosuggestions</span><br><span class="line">)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Take effect .zshrc</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">source</span> ~/.zshrc</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">After the autojump plugin is configured, you can view the recorded access paths (stored <span class="keyword">in</span> autojump.tx)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">j --<span class="built_in">stat</span></span></span><br><span class="line">10.0:   /home/ray/Project</span><br><span class="line">14.1:   /usr/share/fonts</span><br><span class="line">________________________________________</span><br><span class="line"></span><br><span class="line">24:      total weight</span><br><span class="line">2:       number of entries</span><br><span class="line">0.00:    current directory weight</span><br><span class="line"></span><br><span class="line">data:    /home/ray/.local/share/autojump/autojump.tx</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Fuzzy match <span class="string">&quot;pro&quot;</span> directory, and open it with file manager</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">jo pro</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Create personal profile file: Since the shell is changed to zsh, you need to activate the configuration `.profile` <span class="keyword">in</span> `.zshrc`, subsequent personal environment variables and other configurations can be written to `~/.profile`</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Or you can add `\<span class="variable">$HOME</span>/.profile` to the end of `.zshrc` yourself</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="string">&quot;\n# activate home custom profile\n. \$HOME/.profile&quot;</span> &gt;&gt; ~/.zshrc</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Activate the newly added configuration</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">source</span> ~/.zshrc</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Supplement: Install the required symbol fonts</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">https://github.com/powerline/fonts</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S powerline-fonts</span>   </span><br></pre></td></tr></table></figure><h1 id="system-common-toolscommands"><a class="markdownIt-Anchor" href="#system-common-toolscommands"></a> System common tools/commands</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Support <span class="keyword">for</span> recognizing ntfs format hard drives</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S ntfs-3g</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Common commands</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">net-tools: Supports ifconfig, netstat, route, ...</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">dnsutils (<span class="built_in">bind</span>): Supports dig, nslookup, ...</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">inetutils: Supports hostname, telnet, ...</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">iproute2: Supports ip, nstat, ...</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">htop: A process management tool similar to top</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S net-tools dnsutils inetutils iproute2 htop</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">System monitor: If you want to use Netspeed Widget (depends on ksysguard), you need to install this, otherwise it won<span class="string">&#x27;t display</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S ksysguard</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">dialog is a tool that can be used with Shell scripts to create dialog boxes in a text interface (useful when writing shell scripts)</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S dialog</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">View most of the system hardware information, including difficult-to-get memory frequencies, motherboard BIOS, etc.</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S dmidecode</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Linux power management, can save battery for laptops</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">TLP Wiki: https://wiki.archlinux.org/title/TLP_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S tlp</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo systemctl enable --now tlp</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Theme with Kvantum Manager can achieve better results</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S kvantum-qt5</span></span></span><br></pre></td></tr></table></figure><h2 id="software-package-management"><a class="markdownIt-Anchor" href="#software-package-management"></a> Software Package Management</h2><h3 id="downgrade"><a class="markdownIt-Anchor" href="#downgrade"></a> Downgrade</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">expac: Can <span class="built_in">print</span> various formats of Pacman package information</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S expac</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Sort by package size</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">expac -H M <span class="string">&#x27;%m\t%n&#x27;</span> | <span class="built_in">sort</span> -h</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">View the 100 most recently installed packages</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">expac --timefmt=<span class="string">&#x27;%Y-%m-%d %T&#x27;</span> <span class="string">&#x27;%l\t%n&#x27;</span> | <span class="built_in">sort</span> | <span class="built_in">tail</span> -n 100</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Draw package graph http://kmkeen.com/pacgraph/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S pacgraph</span></span><br></pre></td></tr></table></figure><h3 id="paru"><a class="markdownIt-Anchor" href="#paru"></a> Paru</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Based on Yay, a new AUR helper</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Official GitHub: https://github.com/Morganamilo/paru</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">https://dbigr.com/article/481262/</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install Paru</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S --needed base-devel</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> https://aur.archlinux.org/paru.git</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> paru</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">makepkg -si</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Paru can use proxychains</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">proxychains paru -S &lt;package&gt;</span></span><br></pre></td></tr></table></figure><h3 id="other-package-management-software"><a class="markdownIt-Anchor" href="#other-package-management-software"></a> Other Package Management Software</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">expac: Can <span class="built_in">print</span> various formats of Pacman package information</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S expac</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Sort by package size</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">expac -H M <span class="string">&#x27;%m\t%n&#x27;</span> | <span class="built_in">sort</span> -h</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">View the 100 most recently installed packages</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">expac --timefmt=<span class="string">&#x27;%Y-%m-%d %T&#x27;</span> <span class="string">&#x27;%l\t%n&#x27;</span> | <span class="built_in">sort</span> | <span class="built_in">tail</span> -n 100</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Draw package graph http://kmkeen.com/pacgraph/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S pacgraph</span></span><br></pre></td></tr></table></figure><h2 id="bluetooth"><a class="markdownIt-Anchor" href="#bluetooth"></a> Bluetooth</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Bluetooth</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">bluedevil: Bluetooth graphical management tool</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">pulseaudio-bluetooth: Supports Bluetooth speakers, Bluetooth headsets</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S bluez bluez-utils bluedevil pulseaudio-bluetooth</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enable startup</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl <span class="built_in">enable</span> bluetooth.service</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start immediately</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">sudo systemctl start bluetooth.service</span></span><br></pre></td></tr></table></figure><h2 id="ssh-service"><a class="markdownIt-Anchor" href="#ssh-service"></a> SSH Service</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ssh tool</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S openssh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start ssh service</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl start sshd.service</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enable ssh service to start on boot</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl <span class="built_in">enable</span> sshd.service</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Stop ssh service</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl stop sshd.service</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Restart ssh service</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl restart sshd.service</span></span><br></pre></td></tr></table></figure><h2 id="fzf-file-fuzzy-search"><a class="markdownIt-Anchor" href="#fzf-file-fuzzy-search"></a> fzf File Fuzzy Search</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">fzf: Fuzzy search file artifact https://github.com/junegunn/fzf</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S fzf</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">You can <span class="built_in">set</span> the fzf display style as needed</span></span><br><span class="line">export FZF_DEFAULT_OPTS=&quot;--height 50% --reverse --border --preview &#x27;cat &#123;&#125;&#x27;&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Personal preference, add to startup configuration file</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim ~/.profile</span></span><br><span class="line">export FZF_DEFAULT_OPTS=&quot;--border --preview &#x27;cat &#123;&#125;&#x27;&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Take effect immediately, but closing the current terminal will be invalid</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">. ~/.profile</span></span><br></pre></td></tr></table></figure><h1 id="fonts"><a class="markdownIt-Anchor" href="#fonts"></a> Fonts</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install fonts</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S noto-fonts-cjk noto-fonts-emoji noto-fonts-extra adobe-source-han-serif-cn-fonts wqy-zenhei ttf-dejavu wqy-microhei</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install windows fonts - Method 1:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">mkdir</span> /usr/share/fonts/winfonts</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Copy windows fonts to Linux, win_font_path represents the absolute path of your `C:/Windows/Fonts`, here is `/run/media/ray/OS/Windows/Fonts`</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">cp</span> win_font_path/* /usr/share/fonts/winfonts/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> /usr/share/fonts/winfonts/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">rm</span> *.fon</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Create font index information, update font cache</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo mkfontscale</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo mkfontdir</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">fc-cache -fv</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Or, install windows fonts - Method 2: https://wiki.archlinux.org/title/Microsoft_fonts</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S ttf-ms-win10</span></span><br></pre></td></tr></table></figure><h1 id="plasma-widgets"><a class="markdownIt-Anchor" href="#plasma-widgets"></a> Plasma Widgets</h1><ol><li><p><a href="https://store.kde.org/p/998895">Netspeed Widget</a>: Displays upload and download network speeds, depends on ksysguard<br /><img src="https://s2.loli.net/2024/11/20/2ZSse7MqjFrWEDi.png" alt="Pasted image 20230119145715.png"   srcFile="Pasted image 20230119145715.png"></p></li><li><p><a href="https://store.kde.org/p/998901">Event Calendar</a>: With time, calendar, weather, timer, Google Calendar/Tasks synchronization and other functions, highly configurable (only available for Plasma 5)<br /><img src="https://s2.loli.net/2024/11/20/tcdRJkwg35shDpI.png" alt="Pasted image 20230119195648.png" width="500"  srcFile="Pasted image 20230119195648.png"></p></li><li><p><a href="https://store.kde.org/p/1160672">Tiled Menu</a>: Magnetic start menu, similar to the start menu on Win10<br /><img src="https://s2.loli.net/2024/11/20/m4epin5aDJBR9X8.png" alt="Pasted image 20230119203204.png" width="600"  srcFile="Pasted image 20230119203204.png"></p></li><li><p>Sticky notes: Built-in widget, convenient for taking notes<br /><img src="https://s2.loli.net/2024/11/20/XSf7jyKBYvQiq2g.png" alt="Pasted image 20230119203834.png" width="300"  srcFile="Pasted image 20230119203834.png"></p></li></ol><h1 id="kde-apps"><a class="markdownIt-Anchor" href="#kde-apps"></a> KDE Apps</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kdeconnect: Enables Android phones and Arch Linux to interact on the same LAN, such as sending files, clipboard synchronization, message notifications, etc.</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S kdeconnect</span></span><br></pre></td></tr></table></figure><h1 id="dock-software-launcher"><a class="markdownIt-Anchor" href="#dock-software-launcher"></a> dock Software / Launcher</h1><h2 id="latte-dock"><a class="markdownIt-Anchor" href="#latte-dock"></a> latte-dock</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">latte dock: A dock software, similar to the dock area on macOS</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S latte-dock</span></span><br></pre></td></tr></table></figure><h2 id="rofi"><a class="markdownIt-Anchor" href="#rofi"></a> Rofi</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Rofi: https://wiki.archlinux.org/title/rofi</span></span><br><span class="line">$ sudo pacman -S rofi</span><br><span class="line"></span><br><span class="line"><span class="comment"># some commands:</span></span><br><span class="line">$ rofi -show drun -show-icons</span><br><span class="line">$ rofi -combi-modi window,drun -show combi -show-icons</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/Mange/rofi-emoji</span></span><br><span class="line">$ sudo pacman -S rofi-emoji</span><br><span class="line"><span class="comment"># Install adapters to copy and use emojis: https://github.com/Mange/rofi-emoji#optional-dependencies</span></span><br><span class="line">$ sudo pacman -S xdotool xsel</span><br></pre></td></tr></table></figure><h1 id="browsers"><a class="markdownIt-Anchor" href="#browsers"></a> Browsers</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Google Chrome (Stable version)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S google-chrome</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Microsoft Edge (Stable version)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S microsoft-edge-stable-bin</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Google<span class="string">&#x27;s open-source browser chromium</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S chromium</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Firefox browser</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S firefox</span></span></span><br></pre></td></tr></table></figure><h1 id="proxy"><a class="markdownIt-Anchor" href="#proxy"></a> Proxy</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. ssr</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S electron-ssr</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. shadowsocks-qt5</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S shadowsocks-qt5</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. clash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Usage document: https://docs.cfw.lbyczf.com/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Configuration reference: https://github.com/Dreamacro/clash/wiki/configuration</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">TUN mode: For software that does not follow system proxy, TUN mode can take over its traffic and hand it over to CFW <span class="keyword">for</span> processing</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Mixin: Supports injecting public attribute settings into all configuration files (the content of the configuration files will not be modified, and the mixing behavior will only occur <span class="keyword">in</span> memory)</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S clash-for-windows-bin</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">proxychains: For specific usage, please refer to https://wiki.archlinux.org/title/Proxy_server<span class="comment">#Using_a_SOCKS_proxy</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S proxychains</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo vim /etc/proxychains.conf</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Edit /etc/proxychains.conf, change the last line to:</span> </span><br><span class="line">socks5 127.0.0.1 1080</span><br></pre></td></tr></table></figure><h1 id="downloads"><a class="markdownIt-Anchor" href="#downloads"></a> Downloads</h1><h2 id="aria2"><a class="markdownIt-Anchor" href="#aria2"></a> aria2</h2><ul><li><a href="http://aria2.github.io/manual/en/html/index.html">aria2 official document</a></li><li><a href="https://cloud.tencent.com/developer/article/1959590">Configure aria2 on Arch Linux</a></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">aria2 is a lightweight, multi-protocol command-line download utility. It supports protocols including HTTP(S), FTP, BitTorrent, Metalink, etc. The aria2 tool can download concurrently and also supports splicing and resuming, automatically replacing slow threads, etc.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">After installation, you can use the aria2c <span class="built_in">command</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S aria2</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">You can directly refer to the configuration organized by the big guy, download to your Home directory<span class="string">&#x27;s .aria2 directory, because the default configuration file path of aria2 is $HOME/.aria2/aria2.conf</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">git clone https://github.com/P3TERX/aria2.conf ~/.aria2</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Simply modify the downloaded aria2 configuration:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">(1) dir=/root/Download change to the download directory you need, such as dir=/home/ray/Downloads</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">    You can directly replace the remaining /root in batches with your own Home directory path /home/ray</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">(2) rpc-secret=P3TERX it is recommended to modify</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If you encounter an error: Caught an exceptionException: [download_helper.cc:562] errorCode=1 Failed to open file $HOME/.aria2/aria2.session, reason: File not found or it is a directory</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">You can create the file by yourself</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">touch /home/ray/.aria2/aria2.session</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Start aria2c, it will start listening on port 6800</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">aria2c --enable-rpc</span></span></span><br><span class="line">01/26 09:45:38 [NOTICE] IPv4 RPC: Listening on TCP port 6800</span><br><span class="line">01/26 09:45:39 [NOTICE] The session has been successfully serialized to /home/ray/.aria2/aria2.session.</span><br></pre></td></tr></table></figure><p>Install Aria2 plugins for browsers:</p><ul><li><a href="https://microsoftedge.microsoft.com/addons/detail/aria2-for-edge/jjfgljkjddpcpfapejfkelkbjbehagbh?hl=zh-CN">Aria2 for Edge</a></li><li><a href="https://chrome.google.com/webstore/detail/aria2-for-chrome/mpkodccbngfoacfalldjimigbofkhgjn">Aria2 for Chrome</a></li></ul><p>After installing the browser plugin and enabling it, open the Aria2 plugin interface: Click AriaNG Settings -&gt; RPC (localhost:6800)<br /><img src="https://s2.loli.net/2024/11/20/1Fof6yILktaQTgD.png" alt="Pasted image 20230126095145.png" width="400"  srcFile="Pasted image 20230126095145.png"></p><p>Enter the RPC settings interface, you can see the default port is <code>6800</code>, no need to adjust, set the <strong>Aria2 RPC key</strong> to the just set <code>rpc-secret</code> value, and reload the interface, if successful, you can see <strong>Aria2 status</strong> display as connected.<br /><img src="https://s2.loli.net/2024/11/20/qRgHvMi4lZQsXNF.png" alt="Pasted image 20230126095304.png" width="600"  srcFile="Pasted image 20230126095304.png"></p><p>Every time you use it, you need to execute <code>aria2c --enable-rpc</code>, which is quite troublesome, change to start automatically.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> -p ~/.config/systemd/user</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> ~/.config/systemd/user</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim aria2.servide</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=Aria2 Daemon</span><br><span class="line">  </span><br><span class="line">[Service]  </span><br><span class="line">ExecStart=/usr/bin/aria2c</span><br><span class="line">  </span><br><span class="line">[Install]  </span><br><span class="line">WantedBy=default.target</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enable</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">systemctl --user <span class="built_in">enable</span> aria2.service</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">systemctl --user start aria2.service</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check status</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">systemctl --user status aria2.service</span></span><br></pre></td></tr></table></figure><h2 id="motrix"><a class="markdownIt-Anchor" href="#motrix"></a> Motrix</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Multi-threaded downloader</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S motrix</span></span><br></pre></td></tr></table></figure><h1 id="communicationconference-software"><a class="markdownIt-Anchor" href="#communicationconference-software"></a> Communication/Conference Software</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Telegram</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S telegram-desktop</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Team collaboration tool slack</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S slack-desktop</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cisco<span class="string">&#x27;s video conferencing software</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">yay -S webex-bin</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">VDI virtual desktop, for remote office use</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">yay -S vmware-horizon-client</span></span></span><br></pre></td></tr></table></figure><h2 id="wechat"><a class="markdownIt-Anchor" href="#wechat"></a> WeChat</h2><ul><li><a href="https://wiki.archlinuxcn.org/wiki/%E5%BE%AE%E4%BF%A1">WeChat wiki</a></li></ul><h3 id="docker-wechat"><a class="markdownIt-Anchor" href="#docker-wechat"></a> docker WeChat</h3><ul><li><a href="https://github.com/huan/docker-wechat">docker-wehcat github</a></li><li>Prerequisite for installation: Docker is installed, and sudo is set.</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## Installation ###</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Method 1: You can directly use the following <span class="built_in">command</span> to start</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl -sL https://raw.githubusercontent.com/huan/docker-wechat/master/dochat.sh | bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If the above installation is slow, domestic <span class="built_in">users</span> (Chinese) can use the following script</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl -sL https://gitee.com/mirrors/dochat/raw/main/dochat.sh | bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Method 2: Or, directly pull down the entire project with git</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">clone</span> https://github.com/huan/docker-wechat.git</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Then, enter the docker-wechat directory and execute the following script to automatically download the image and start:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./dochat.sh</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## Installation Issues ###</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. Permission is not enough, and the following prompt appears:</span></span><br><span class="line">[DoChat] Boxed WeChat v0.15.0</span><br><span class="line">Disabling patch for /home/user/.wine/drive_c/users/user/AppData/Roaming/Tencent/WeChat ...</span><br><span class="line">Disabling patch for /home/user/.wine/drive_c/users/user/Application Data/Tencent/WeChat ...</span><br><span class="line">mkdir: cannot create directory “/home/user/.wine/drive_c/users/user/Application Data/Tencent”: Permission denied</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Solution：Grant permissions to the DoChat directory under the home directory</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">chmod</span> -R 777 ~/DoChat</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. main:line 82: lshw: <span class="built_in">command</span> not found</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Solution: Install the `lshw` <span class="built_in">command</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S lshw</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. docker: Error response from daemon: could not select device driver <span class="string">&quot;&quot;</span> with capabilities: [[gpu]].</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Solution：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(1) First confirm whether the current NVIDIA installation is correct, refer to https://wiki.archlinuxcn.org/wiki/NVIDIA<span class="comment">#%E5%AE%89%E8%A3%85</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(2) Then consider whether to install nvidia-container-toolkit, refer to https://github.com/NVIDIA/nvidia-docker/issues/1243</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4. If it cannot be started, and there is no clear error message, such as `DoChat Exited with code [0]`, you can increase the debug start as follows to view:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl -sL https://gitee.com/mirrors/dochat/raw/main/dochat.sh | DOCHAT_DEBUG=<span class="literal">true</span> bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If it includes the following error message</span></span><br><span class="line">00dc:err:winediag:nodrv_CreateWindow Application tried to create a window, but no driver could be loaded.</span><br><span class="line">00dc:err:winediag:nodrv_CreateWindow Make sure that your X server is running and that $DISPLAY is set correctly.</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">You need to authorize access to the X server:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The following allows all <span class="built_in">users</span> to access the X server (https://wiki.archlinux.org/title/Xhost), and <span class="keyword">then</span> start wechat</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">xhost +</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## After Installation ###</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">View images</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker images</span></span><br><span class="line">REPOSITORY     TAG         IMAGE ID       CREATED        SIZE</span><br><span class="line">zixia/wechat   3.3.0.115   69b2b2eb6770   8 months ago   3.73GB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">After starting, you can see the container DoChat</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker ps</span>        </span><br><span class="line">CONTAINER ID   IMAGE                    COMMAND            CREATED          STATUS          PORTS     NAMES</span><br><span class="line">f6068b03e6e9   zixia/wechat:3.3.0.115   &quot;/entrypoint.sh&quot;   20 minutes ago   Up 20 minutes             DoChat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">But when you leave and <span class="built_in">exit</span> WeChat, the container will be automatically deleted because dochat.sh adds --<span class="built_in">rm</span> to docker run, <span class="built_in">which</span> automatically deletes the container after the container exits</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Create Desktop shortcut, more: https://wiki.archlinux.org/title/Desktop_entries</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Exec fill <span class="keyword">in</span> the specific <span class="built_in">command</span> to execute, use 1 as “curl -sL https://gitee.com/mirrors/dochat/raw/main/dochat.sh | bash”，use 2 as “/home/ray/Project/docker/docker-wechat/dochat.sh”``</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> ~/.local/share/applications/</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim wechat-docker.desktop</span></span><br><span class="line">[Desktop Entry]</span><br><span class="line">Name=WeChatDocker</span><br><span class="line">Comment=Dockerized WeChat (盒装微信) PC Windows Client for Linux</span><br><span class="line">Exec=curl -sL https://gitee.com/mirrors/dochat/raw/main/dochat.sh</span><br><span class="line">Icon=wechat</span><br><span class="line">Type=Application</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Verify the desktop file</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">desktop-file-validate wechat-docker.desktop</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Then you can search <span class="keyword">for</span> <span class="string">&quot;WeChatDocker&quot;</span> <span class="keyword">in</span> the Menu to see it</span></span><br></pre></td></tr></table></figure><h1 id="note-taking-software"><a class="markdownIt-Anchor" href="#note-taking-software"></a> Note-taking Software</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Obsidian note-taking software</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S obsidian</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Joplin note-taking software</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cli</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S joplin</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">desktop</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S joplin-desktop</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Trilium open-source electron note-taking software</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S trilium-bin</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S trilium-server-bin</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Markdown editor</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S marktext-git</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Mind map</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S xmind</span></span><br></pre></td></tr></table></figure><h1 id="drawing-software"><a class="markdownIt-Anchor" href="#drawing-software"></a> Drawing Software</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">drawio</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S drawio-desktop-bin</span></span><br></pre></td></tr></table></figure><h1 id="unarchiving-software"><a class="markdownIt-Anchor" href="#unarchiving-software"></a> Unarchiving Software</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ark belongs to the kde-utilities package group</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S ark</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">unar, lsar</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S unarchiver</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Unzip/zip</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S unzip zip</span></span><br></pre></td></tr></table></figure><h1 id="imagescreenshot-software"><a class="markdownIt-Anchor" href="#imagescreenshot-software"></a> Image/Screenshot Software</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">gwenview belongs to the kde-graphics package group</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S gwenview</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Flameshot</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S flameshot</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">You can configure the shortcut key Ctrl+Alt+A, the <span class="built_in">command</span> configuration is: flameshot gui</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Snipaste screenshot + <span class="built_in">paste</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S snipaste</span></span><br></pre></td></tr></table></figure><h1 id="audiovideo-software"><a class="markdownIt-Anchor" href="#audiovideo-software"></a> Audio/Video Software</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">NetEase Cloud Music</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S netease-cloud-music</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Audio/video player</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S vlc</span></span><br></pre></td></tr></table></figure><h1 id="officereadingpdf-software"><a class="markdownIt-Anchor" href="#officereadingpdf-software"></a> Office/Reading/PDF Software</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">LibreOffice stable version</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S libreoffice-still</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">KDE<span class="string">&#x27;s default PDF lightweight reader</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S okular</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">A highly customizable, feature-rich, minimalist, vim-like shortcut key PDF reader</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Official doc: https://pwmt.org/projects/zathura/documentation/</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Supported plugins: https://pwmt.org/projects/zathura/plugins/</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S zathura-pdf-mupdf</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Foxit Reader</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">yay -S foxitreader</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">WPS Office</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">wps-office-mui-zh-cn: Chinese language pack</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">yay -S wps-office wps-office-mui-zh-cn wps-office-mime-cn wps-office-fonts ttf-ms-fonts ttf-wps-fonts wps-office-all-dicts-win-languages</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If wps pdf cannot start, then install libtiff5 dependency</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">yay -S libtiff5</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Comic reader</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">yay -S yacreader-poppler</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Reader suitable for touch screens</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">yay -S koreader-bin</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Hammer PDF: A new scientific and technological intelligent reader developed and maintained by the DataHammer research group of the Computer College of Beijing Institute of Technology, which can quickly analyze PDF academic literature and provide reliable academic information in real-time.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">https://github.com/HammerPDF/Smart-Scientific-Reader</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">yay -S hammer-pdf</span></span></span><br></pre></td></tr></table></figure><h1 id="software-development-related-tools"><a class="markdownIt-Anchor" href="#software-development-related-tools"></a> Software Development Related Tools</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vscode</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S visual-studio-code-bin</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If vscode<span class="string">&#x27;s terminal cannot display some characters when using zsh, you can install the font patch</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="string">sudo pacman -S powerline-fonts</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Open vsode&#x27;</span>s configuration and find Terminal › Integrated: Font Family: You can change the font to Hack, it will work</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nodejs npm environment</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S nodejs npm</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Configuration: <span class="string">&quot;/home/ray/&quot;</span> is your home directory, adjust as needed</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm config <span class="built_in">set</span> prefix <span class="string">&quot;/home/ray/.nodejs&quot;</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">npm config <span class="built_in">set</span> cache <span class="string">&quot;/home/ray/.nodejs/cache&quot;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Database management tool</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S dbeaver</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RESP.app: Redis visualization management tool</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S resp-app</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ZooKeeper visualization management tool</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S prettyzoo</span></span><br></pre></td></tr></table></figure><h1 id="rdp"><a class="markdownIt-Anchor" href="#rdp"></a> RDP</h1><h2 id="xfreerdp"><a class="markdownIt-Anchor" href="#xfreerdp"></a> xfreerdp</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">xfreerdp performs better than rdesktop</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S krdc-xfreerdp libvncserver</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Usage:</span> </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">xfreerdp [file] [options] [/v:&lt;server&gt;[:port]]</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/sec:rdp       Force specific rdp protocol security</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/f             Fullscreen mode (&lt;Ctrl&gt;+&lt;Alt&gt;+&lt;Enter&gt; toggles fullscreen)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">+smart-sizing  Allow RDP client to dynamically adjust the resolution of the remote desktop according to the window size</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">+clipboard     Enable Redirect clipboard</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/bpp:&lt;depth&gt;   Set the color depth of the session, such as 16 efficient color depth, suitable <span class="keyword">for</span> situations with limited bandwidth; 24: Provides richer colors, suitable <span class="keyword">for</span> most scenarios; 32: The highest color depth, suitable <span class="keyword">for</span> applications that require high-quality images</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">+compression   Enable compression to improve performance</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">xfreerdp /v:&lt;server&gt;[:port] /u:&lt;username&gt; /p:&lt;password&gt; /sec:rdp /f +smart-sizing +clipboard /bpp:24 +compression</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If you are not sure what the username of the Windows you want to connect to is, you can check it by entering <span class="built_in">whoami</span> <span class="keyword">in</span> the CMD</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If the following error occurs, try modifying the registry on the Windows to be connected: Open `Computer\HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp` and change `SecurityLayer` from 2 to 1</span></span><br><span class="line">[ERROR][com.freerdp.core] - transport_ssl_cb:freerdp_set_last_error_ex ERRCONNECT_PASSWORD_CERTAINLY_EXPIRED [0x0002000F]</span><br><span class="line">[ERROR][com.freerdp.core.transport] - BIO_read returned an error: error:0A000438:SSL routines::tlsv1 alert internal error</span><br></pre></td></tr></table></figure><h2 id="rdesktop"><a class="markdownIt-Anchor" href="#rdesktop"></a> rdesktop</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rdesktop: an open <span class="built_in">source</span> client <span class="keyword">for</span> Windows Remote Desktop Services.</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S rdesktop</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Usage:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">rdesktop -u &lt;username&gt; -p &lt;password&gt; &lt;server&gt;[:port]</span></span><br></pre></td></tr></table></figure><h1 id="virtual-machinestechnology"><a class="markdownIt-Anchor" href="#virtual-machinestechnology"></a> Virtual Machines/Technology</h1><h2 id="virtual-box"><a class="markdownIt-Anchor" href="#virtual-box"></a> Virtual Box</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install virtualbox</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Determine the kernel version</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">uname</span> -r</span> </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S linux-headers</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Choose virtualbox-host-dkms</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S virtualbox</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S virtualbox-guest-iso</span></span><br></pre></td></tr></table></figure><h2 id="vmware"><a class="markdownIt-Anchor" href="#vmware"></a> VMware</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install VMware</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S linux-headers</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S vmware-workstation</span></span><br></pre></td></tr></table></figure><h2 id="docker"><a class="markdownIt-Anchor" href="#docker"></a> Docker</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install docker</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S docker</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start docker</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl start docker</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Set to start on boot</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl <span class="built_in">enable</span> docker</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Set docker to run without sudo</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(1) Create a docker group</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo groupadd docker</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(2) Add the current user to the docker group</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo usermod -aG docker <span class="variable">$USER</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(3) Log out and <span class="built_in">log</span> back <span class="keyword">in</span> to the shell</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install docker compose: container orchestration tool</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S docker-compose</span></span><br></pre></td></tr></table></figure><h2 id="waydroid-android-emulator"><a class="markdownIt-Anchor" href="#waydroid-android-emulator"></a> Waydroid (Android Emulator)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check the kernel version: The default Arch Linux kernel does not support binder, you need to switch to another available kernel, such as linux-zen, DKMS</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">uname</span> -r</span></span><br><span class="line">6.2.6-arch1-1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install the available kernel module linux-zen</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S linux-zen</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Regenerate the grub configuration file, and restart to find the kernel <span class="keyword">in</span> the grub interface</span></span><br><span class="line">sudo grub-mkconfig -o /boot/grub/grub.cfg</span><br><span class="line">Generating grub configuration file ...</span><br><span class="line">Found Linux image: /boot/vmlinuz-linux-zen</span><br><span class="line">Found initrd image: /boot/intel-ucode.img /boot/initramfs-linux-zen.img</span><br><span class="line">Found fallback initrd image(s) in /boot:  intel-ucode.img initramfs-linux-zen-fallback.img</span><br><span class="line">Found Linux image: /boot/vmlinuz-linux</span><br><span class="line">Found initrd image: /boot/intel-ucode.img /boot/initramfs-linux.img</span><br><span class="line">Found fallback initrd image(s) in /boot:  intel-ucode.img initramfs-linux-fallback.img</span><br><span class="line">Warning: os-prober will run to detect other bootable partitions. It will use the output of os-prober to detect bootable binaries in the partitions and create new boot entries. Found Windows Boot Manager on /dev/nvme0n1p1@/EFI/Microsoft/Boot/bootmgfw.efi</span><br><span class="line">Adding UEFI firmware setup entries...</span><br><span class="line">Done</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Restart and switch to the linux-zen kernel: Select the advanced options <span class="keyword">in</span> the grub boot interface and choose to boot linux-zen</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">reboot</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Verify the current kernel, you can find that it has switched to linux-zen</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">uname</span> -r</span></span><br><span class="line">6.2.6-zen1-1-zen</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Waydroid requires Wayland</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$XDG_SESSION_TYPE</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">https://wiki.archlinux.org/title/Weston</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S weston</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S waydroid</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Initialize</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo waydroid init -s GAPPS -f</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start the service with systemctl</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl start waydroid-container.service</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start the UI</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">waydroid show-full-ui</span></span><br></pre></td></tr></table></figure><h3 id="common-issues"><a class="markdownIt-Anchor" href="#common-issues"></a> Common Issues</h3><h4 id="network-issues"><a class="markdownIt-Anchor" href="#network-issues"></a> Network Issues</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S ufw</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo ufw status</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo ufw <span class="built_in">enable</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo ufw allow 53</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo ufw allow 67</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo ufw default allow FORWARD</span></span><br></pre></td></tr></table></figure><h4 id="failed-to-start-clipboard-manager-service"><a class="markdownIt-Anchor" href="#failed-to-start-clipboard-manager-service"></a> Failed to start Clipboard manager service</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S python-pyclipper</span></span><br></pre></td></tr></table></figure><h4 id="google-play-this-device-is-not-certified-with-google-play-protect"><a class="markdownIt-Anchor" href="#google-play-this-device-is-not-certified-with-google-play-protect"></a> Google Play: This device is not certified with Google Play Protect</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Log <span class="keyword">in</span> to the shell</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo waydroid shell</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Then enter the following <span class="built_in">command</span> to get an android_id -&gt; Enter https://www.google.com/android/uncertified, enter this <span class="built_in">id</span> and register, <span class="built_in">wait</span> <span class="keyword">for</span> a <span class="keyword">while</span></span></span><br><span class="line">ANDROID_RUNTIME_ROOT=/apex/com.android.runtime ANDROID_DATA=/data ANDROID_TZDATA_ROOT=/apex/com.android.tzdata ANDROID_I18N_ROOT=/apex/com.android.i18n sqlite3 /data/data/com.google.android.gsf/databases/gservices.db &quot;select * from main where name = \&quot;android_id\&quot;;&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl restart waydroid-container.service</span></span><br></pre></td></tr></table></figure><ul><li><a href="https://ivonblog.com/posts/archlinux-waydroid/">https://ivonblog.com/posts/archlinux-waydroid/</a></li><li><a href="https://wiki.archlinux.org/title/Waydroid#Usage">https://wiki.archlinux.org/title/Waydroid#Usage</a></li><li><a href="https://docs.waydro.id/usage/waydroid-prop-options">https://docs.waydro.id/usage/waydroid-prop-options</a></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">https://github.com/casualsnek/waydroid_script</span></span><br></pre></td></tr></table></figure><h1 id="file-sharing"><a class="markdownIt-Anchor" href="#file-sharing"></a> File Sharing</h1><h2 id="alibaba-cloud-drive-webdav-service"><a class="markdownIt-Anchor" href="#alibaba-cloud-drive-webdav-service"></a> Alibaba Cloud Drive WebDAV Service</h2><ul><li><a href="https://github.com/messense/aliyundrive-webdav">aliyundrive-webdav github</a>: The main scenario is to cooperate with client apps that support the WebDAV protocol such as Infuse, nPlayer, etc., to directly watch videos in the cloud drive on the TV, support client apps to directly obtain files from Alibaba Cloud Drive for playback without going through the server where this app is running, support file uploads, but limited by the WebDAV protocol does not support file second transmission.</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Method one: Install Alibaba Cloud Drive WebDAV Service</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S aliyundrive-webdav-bin</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start the service</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. Get the Alibaba Cloud Drive refresh token, refer to: https://github.com/messense/aliyundrive-webdav<span class="comment">#%E8%8E%B7%E5%8F%96-refresh-token</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. Command to start, more <span class="built_in">command</span> <span class="built_in">help</span> can refer to: aliyundrive-webdav --<span class="built_in">help</span></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">aliyundrive-webdav -p &lt;port&gt; --auth-user &lt;user&gt; --auth-password &lt;password&gt; --refresh-token &lt;refresh token&gt;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Usage</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. Access with Dolphin:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1.1. Direct url access: webdav://&lt;ip&gt;:&lt;port&gt;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1.2. Create a new network folder: Click <span class="string">&quot;Network&quot;</span> -&gt; Click <span class="string">&quot;Add Network Folder&quot;</span> -&gt; Choose <span class="string">&quot;Web Folder (webdav)&quot;</span> and click Next -&gt; Fill <span class="keyword">in</span> the information as needed, and click Save and Connect (<span class="keyword">if</span> you have <span class="built_in">set</span> a password, it will prompt you to enter the password at this time) -&gt; Done, you can see the newly added webdav folder <span class="keyword">in</span> the <span class="string">&quot;Network&quot;</span> folder (click to go <span class="keyword">in</span>, you can see the files <span class="keyword">in</span> your Alibaba Cloud Drive)</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Method two: Run with docker, more can refer to: https://github.com/messense/aliyundrive-webdav<span class="comment">#docker-%E8%BF%90%E8%A1%8C</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--restart=unless-stopped: It means that the container will always restart when it exits, but it does not consider containers that have already stopped when the docker daemon is running</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run -d --name=aliyundrive-webdav --restart=unless-stopped -p &lt;port&gt;:8080 \</span></span><br><span class="line"><span class="language-bash">  -v /etc/aliyundrive-webdav/:/etc/aliyundrive-webdav/ \</span></span><br><span class="line"><span class="language-bash">  -e REFRESH_TOKEN=<span class="string">&#x27;&lt;refresh token&gt;&#x27;</span> \</span></span><br><span class="line"><span class="language-bash">  -e WEBDAV_AUTH_USER=&lt;user&gt; \</span></span><br><span class="line"><span class="language-bash">  -e WEBDAV_AUTH_PASSWORD=&lt;password&gt; \</span></span><br><span class="line"><span class="language-bash">  messense/aliyundrive-webdav</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">After starting, you will see the refresh_token file <span class="keyword">in</span> the /etc/aliyundrive-webdav directory of the host machine, <span class="keyword">if</span> the refresh token is invalid, you can directly change the file here</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> /etc/aliyundrive-webdav</span>                       </span><br><span class="line">refresh_token</span><br></pre></td></tr></table></figure><h2 id="alist"><a class="markdownIt-Anchor" href="#alist"></a> AList</h2><ul><li><a href="https://alist.nn.ci/zh/guide/">AList official document（Very Detailed）</a>：A file list program that supports multiple storages, supports WebDAV, and supports file/video/audio/image preview.</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Installation (one-click script): After successful installation (default installation <span class="keyword">in</span> /opt/alist), it will prompt the access address and admin account password -&gt; Log <span class="keyword">in</span>, click on the management at the bottom of the page to <span class="built_in">set</span> up storage, such as adding Alibaba Cloud storage -&gt; After setting up, you can see the files <span class="keyword">in</span> your Alibaba Cloud</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl -fsSL <span class="string">&quot;https://alist.nn.ci/v3.sh&quot;</span> | sudo bash -s install</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Update</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl -fsSL <span class="string">&quot;https://alist.nn.ci/v3.sh&quot;</span> | sudo bash -s update</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Uninstall</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl -fsSL <span class="string">&quot;https://alist.nn.ci/v3.sh&quot;</span> | sudo bash -s uninstall</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check status:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl status alist</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start service:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl start alist</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Restart service:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl restart alist</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Stop service:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl stop alist</span></span><br></pre></td></tr></table></figure><h1 id="keyboard-mapping"><a class="markdownIt-Anchor" href="#keyboard-mapping"></a> Keyboard Mapping</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">https://github.com/houmain/keymapper</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yay -S keymapper</span></span><br></pre></td></tr></table></figure><h1 id="others"><a class="markdownIt-Anchor" href="#others"></a> Others</h1><h2 id="custom-notification-reminders"><a class="markdownIt-Anchor" href="#custom-notification-reminders"></a> Custom Notification Reminders</h2><p>Send reminder notifications with notify-send, found online that dbus-monitor can monitor tray signals, I tried it, not sure how to implement specifically</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">D-Bus visualization debugging tool</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S d-feet</span></span><br></pre></td></tr></table></figure><h2 id="pandoc"><a class="markdownIt-Anchor" href="#pandoc"></a> pandoc</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">A cross-platform, free and open-source command-line tool <span class="keyword">for</span> converting between markup languages, known as the <span class="string">&quot;Swiss Army Knife&quot;</span> <span class="keyword">in</span> this field</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S pandoc</span></span><br></pre></td></tr></table></figure><h1 id="common-issues-2"><a class="markdownIt-Anchor" href="#common-issues-2"></a> Common Issues</h1><ol><li>Change single-click to double-click to open folders in file managers?</li></ol><blockquote><p>System Settings / Workspace Behavior / General Behavior: In “When clicking files or folders”, select “Select them (double-click to open files/folders)”.</p></blockquote>]]></content>
        
        
        <categories>
            
            <category> Arch Linux Series </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Arch_Linux </tag>
            
            <tag> OS </tag>
            
        </tags>
        
    </entry>
    
    
    
    <entry>
        <title>Dual Boot Installation Guide of Arch Linux &amp; Windows 10</title>
        <link href="/en/os/dual-boot-installation-guide-of-arch-linux-win-10/"/>
        <url>/en/os/dual-boot-installation-guide-of-arch-linux-win-10/</url>
        
        <content type="html"><![CDATA[<h1 id="0-introduction"><a class="markdownIt-Anchor" href="#0-introduction"></a> 0. Introduction</h1><p>☀ The weather is nice, perfect for reinstalling a dual boot (Windows 10 + Arch Linux (KDE)) on my personal laptop, the ThinkPad T470p. Here’s a system info screenshot from Arch Linux:</p><img src="https://s2.loli.net/2021/12/12/pZtSERuQMW4ilkV.png" alt="Arch_Linux_system_info.png"   srcFile="Arch_Linux_system_info.png"><p>Currently, there are two storage drives: a <strong>500GB HDD</strong> and a <strong>250GB SSD</strong>. Both systems are installed on the SSD, while the HDD is used as a data storage drive for both systems. First, the Windows system is installed, followed by Arch Linux. The disk space allocation is as follows:</p><table><thead><tr><th>Disk Type</th><th>Windows 10</th><th>Arch Linux</th></tr></thead><tbody><tr><td>500G HD</td><td>140G for application data</td><td>Remaining (approx. 325.76GB) for user home directory <code>/home</code></td></tr><tr><td>250G SSD</td><td>500M EFI, 50M MSR, 100G OS</td><td>Remaining (approx. 137.94GB) for root directory <code>/</code></td></tr></tbody></table><h1 id="1-installing-windows"><a class="markdownIt-Anchor" href="#1-installing-windows"></a> 1. Installing Windows</h1><h2 id="11-preparing-the-windows-system-image"><a class="markdownIt-Anchor" href="#11-preparing-the-windows-system-image"></a> 1.1. Preparing the Windows System Image</h2><p>Choose any version of Windows that you prefer:</p><p>Download URL:</p><ul><li><a href="https://msdn.itellyou.cn/">MSDN, itellyou.cn</a></li></ul><p>Win10 image ed2k link:</p><ul><li><a href="ed2k://%7Cfile%7Ccn_windows_10_business_editions_version_1909_updated_jan_2020_x64_dvd_b3e1f3a6.iso%7C5311711232%7C3527D2A9845FF4105F485CC364655B66%7C/">Windows 10 (business editions), version 1909 (updated Jan 2020) (x64) - DVD (Chinese-Simplified)</a></li><li><a href="ed2k://%7Cfile%7Ccn_windows_10_consumer_editions_version_1909_updated_jan_2020_x64_dvd_47161f17.iso%7C5417457664%7C274FEBA5BF0C874C291674182FA9C851%7C/">Windows 10 (consumer editions), version 1909 (updated Jan 2020) (x64) - DVD (Chinese-Simplified)</a></li><li><a href="ed2k://%7Cfile%7Ccn_windows_10_consumer_editions_version_21h1_x64_dvd_1baf479d.iso%7C5807677440%7CE53960C7CAD323F60442A8AB9C269C2E%7C/">Windows 10 21H1 Simplified Chinese Multi-Edition Official Original Clean Image Download</a></li></ul><h2 id="12-create-a-bootable-usb-drive-using-rufus"><a class="markdownIt-Anchor" href="#12-create-a-bootable-usb-drive-using-rufus"></a> 1.2. Create a Bootable USB Drive (Using Rufus)</h2><p>Use <a href="https://rufus.ie/">Rufus</a> (Linux users can use <code>dd</code>) to create a bootable USB drive. Select the Windows 10 ISO image, set the partition scheme to GPT, and the target system type to UEFI. Leave other options as default, then click “Start”.</p><img src="https://s2.loli.net/2021/12/12/KMUG8bdRpsaJ1lP.png" alt="Rufus制作Win10启动U盘" width="300"  srcFile="win10_make_USB.png"><h2 id="13-configure-the-bios"><a class="markdownIt-Anchor" href="#13-configure-the-bios"></a> 1.3. Configure the BIOS</h2><p>Insert the USB drive and restart the computer. Enter the BIOS settings menu:</p><ul><li>Disable Secure Boot in the motherboard settings.</li><li>Set the boot mode to UEFI (UEFI Only).</li></ul><h2 id="14-access-the-boot-menu-custom-installation"><a class="markdownIt-Anchor" href="#14-access-the-boot-menu-custom-installation"></a> 1.4. Access the Boot Menu (Custom Installation)</h2><p>After restarting, when you see the boot screen, press F12 repeatedly (or the key specific to your device) to enter the boot menu. Follow the on-screen instructions until you reach the installation type selection screen. Choose “Custom” at this stage.</p><img src="https://s2.loli.net/2021/12/12/I6LrAz3SPy9MH57.png" alt="win10安装类型选择" width="400"  srcFile="win10_installation_type.png"><h2 id="15-disk-partitioning"><a class="markdownIt-Anchor" href="#15-disk-partitioning"></a> 1.5. Disk Partitioning</h2><p>Press <code>Shift + F10</code> to open the Command Prompt window.</p><p>(1) Enter diskpart mode:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Open Microsoft DiskPart partition tool</span></span><br><span class="line">X:\Sources&gt; diskpart</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">View disk information:</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">list disk</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2021/12/12/tTkSayBFmb8IeND.png" alt="进入diskpart模式" width="400"  srcFile="win10_enter_diskpart.png"><p>(2) Clear partitions on Disk 0 (<mark>Warning: This will format the disk. Please back up important data in advance</mark>)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Select Disk 0 (500GB hard drive)</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">select disk 0</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Clear existing partitions and data on the hard drive</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">clean</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Convert the selected disk to GPT format</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">convert gpt</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2021/12/12/mhwBLij9OTxCtU1.png" alt="格式化disk0" width="300"  srcFile="win10_clean_disk0.png"><p>(3) Clear partitions on Disk 1 (<mark>Note: This will format the disk. Please back up important data in advance</mark>)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Select disk 1 (250G SSD)</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">select disk 1</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Clear existing partitions and data on the disk</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">clean</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Convert the currently selected disk to GPT format</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">convert gpt</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Verify the clearing result</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">list disk</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2021/12/12/5DPzliur9Lj2hY1.png" alt="格式化disk1" width="400"  srcFile="win10_clean_disk1.png"><p>(4) System Partition</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Select disk 1 (SSD) as the system disk</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">select disk 1</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Create EFI partition 500M</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">create partition efi size=500</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Create MSR partition 50M</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">create partition msr size=50</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Create primary system partition 100G</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">create partition primary size=102400</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2021/12/12/coe1GhN2AgYyVbM.png" alt="系统分区disk1" width="400"  srcFile="win10_os_partition.png"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Confirm the current disk</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">list disk</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">View the information of the created partitions</span></span><br><span class="line"><span class="meta prompt_">DISKPART&gt; </span><span class="language-bash">list partition</span></span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2021/12/12/XcqgGzwSUPvdAhB.png" alt="查看disk1分区结果" width="400"  srcFile="win10_os_partition_result.png"><h2 id="16-system-installation"><a class="markdownIt-Anchor" href="#16-system-installation"></a> 1.6. System Installation</h2><p>After completing the partitioning, in the Windows installation location selection screen, click “Refresh” to display the result of the partitioning done through the command line, as shown in the following image:<br /><img src="https://s2.loli.net/2021/12/12/KEMVJR9nuo7BeOj.png" alt="选择安装win10的分区" width="500"  srcFile="win10_installation_location.png"></p><p>Select “Drive 1 Partition 3” (the 100G space for system installation), and click “Next” to begin the Windows installation.<br /><img src="https://s2.loli.net/2021/12/12/jtOylnUk3VMK7RT.png" alt="正在安装Windows" width="600"  srcFile="win10_installing_page.png"></p><h2 id="17-installation-success"><a class="markdownIt-Anchor" href="#17-installation-success"></a> 1.7. Installation Success</h2><p>After the system is installed, it will automatically restart. At this point, you can remove the USB drive.<br />After rebooting, a series of configurations will take place, which will not be elaborated here.</p><p>After installation is successful, go to the Disk Management interface and allocate 140G from the 500G HD disk for personal application data storage, as shown in the following image:<br /><img src="https://s2.loli.net/2021/12/12/ac8CiwWUbFljrGY.png" alt="win10磁盘管理"   srcFile="win10_create_HD_partition.png"></p><h1 id="2-install-arch-linux"><a class="markdownIt-Anchor" href="#2-install-arch-linux"></a> 2. Install Arch Linux</h1><p>When installing Arch Linux, you can refer to the <a href="https://wiki.archlinux.org/title/Installation_guide">official Arch Linux installation guide</a> as the primary resource, with this document as a supplementary reference.</p><h2 id="21-prepare-arch-linux-image"><a class="markdownIt-Anchor" href="#21-prepare-arch-linux-image"></a> 2.1. Prepare Arch Linux Image</h2><p>You can visit the Arch Linux Downloads official website to choose and download the latest system package:</p><ul><li>Download website: <a href="https://archlinux.org/download/">Arch Linux - Downloads</a></li><li>Magnet link for the image (2021.10.01 version, it is recommended to choose the latest version): <a href="magnet:?xt=urn:btih:50f06e56adac70e52fddb37ad6ee331564d6aba1&amp;dn=archlinux-2021.10.01-x86_64.iso">Magnet link for 2021.10.01</a></li></ul><h2 id="22-create-bootable-usb-drive-using-rufus"><a class="markdownIt-Anchor" href="#22-create-bootable-usb-drive-using-rufus"></a> 2.2. Create Bootable USB Drive (Using Rufus)</h2><p>Select the Arch Linux iso image, use UEFI + GPT, and click Start to begin the writing process.<br /><img src="https://s2.loli.net/2021/12/12/oT3vqK4Brl9tCA5.png" alt="制作Arch Linux启动盘" width="300"  srcFile="archlinux_make_usb.png"></p><p>When clicking Start, select “<strong>Write in DD image mode</strong>”:<br /><img src="https://s2.loli.net/2021/12/12/LAOyVPfhpvambNT.png" alt="以DD镜像写入" width="400"  srcFile="archlinux_make_usb_dd.png"></p><h2 id="23-boot-into-live-environment"><a class="markdownIt-Anchor" href="#23-boot-into-live-environment"></a> 2.3. Boot into Live Environment</h2><p>After restarting, when you see the boot screen, press F12 (this may vary depending on the machine) to enter the boot menu, usually selecting the first option by default.<br />When you see the following screen, it means the boot was successful.</p><img src="https://s2.loli.net/2021/12/12/ty19bQhfAvmMWHr.png" alt="成功进入Arch Linux" width="500"  srcFile="archlinux_live_env.png"><h2 id="24-verify-boot-mode"><a class="markdownIt-Anchor" href="#24-verify-boot-mode"></a> 2.4. Verify Boot Mode</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If the result shows directories without errors, the system is booted <span class="keyword">in</span> UEFI mode. Otherwise, it may be booted <span class="keyword">in</span> BIOS mode.</span></span><br><span class="line">root@archiso ~ # ls /sys/firmware/efi/efivars</span><br></pre></td></tr></table></figure><h2 id="25-disable-reflector"><a class="markdownIt-Anchor" href="#25-disable-reflector"></a> 2.5. Disable Reflector</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Disable reflector to prevent updating the mirrorlist automatically</span></span><br><span class="line">root@archiso ~ # systemctl stop reflector.service</span><br></pre></td></tr></table></figure><h2 id="26-connect-to-network"><a class="markdownIt-Anchor" href="#26-connect-to-network"></a> 2.6. Connect to Network</h2><p>You can first check if the wireless device is disabled:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check the wireless device status</span></span><br><span class="line">root@archiso ~ # rfkill list</span><br><span class="line">0: tpacpi_bluetooth_sw: Bluetooth</span><br><span class="line">    Soft blocked: no</span><br><span class="line">    Hard blocked: no</span><br><span class="line">1: phy0: Wireless LAN</span><br><span class="line">    Soft blocked: no</span><br><span class="line">    Hard blocked: no</span><br><span class="line">2: hci0: Bluetooth</span><br><span class="line">    Soft blocked: no</span><br><span class="line">    Hard blocked: no</span><br><span class="line">    </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If Wireless LAN shows blocked: <span class="built_in">yes</span>, it means the wireless connection is disabled</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enable wireless connection (<span class="keyword">if</span> not already disabled, skip the <span class="built_in">command</span> below)</span></span><br><span class="line">root@archiso ~ # rfkill unblock wifi</span><br></pre></td></tr></table></figure><p>Use <code>iwctl</code> to connect to a wireless network:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">View network device information</span></span><br><span class="line">root@archiso ~ # ip a</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Use iwctl to connect to WiFi</span></span><br><span class="line">root@archiso ~ # iwctl</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">List all WiFi devices</span></span><br><span class="line"><span class="meta prompt_">[iwd]# </span><span class="language-bash">device list</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Scan <span class="keyword">for</span> networks (wlan0 is your device)</span></span><br><span class="line"><span class="meta prompt_">[iwd]# </span><span class="language-bash">station wlan0 scan</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">List all available networks</span></span><br><span class="line"><span class="meta prompt_">[iwd]# </span><span class="language-bash">station wlan0 get-networks</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Choose a wireless network to connect to (xixi is your network name)</span></span><br><span class="line"><span class="meta prompt_">[iwd]# </span><span class="language-bash">station wlan0 connect xixi</span></span><br><span class="line">Type the network passphrase for xixi psk.</span><br><span class="line">Passphrase: # Enter password</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">After successful connection, <span class="built_in">exit</span> iwctl</span></span><br><span class="line"><span class="meta prompt_">[iwd]# </span><span class="language-bash"><span class="built_in">exit</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Verify <span class="keyword">if</span> the network connection was successful</span></span><br><span class="line">root@archiso ~ # ping -c 5 baidu.com</span><br></pre></td></tr></table></figure><p>For a wired connection, theoretically, just plug in the network cable, and you should be able to connect to the internet directly.</p><h2 id="27-update-system-time"><a class="markdownIt-Anchor" href="#27-update-system-time"></a> 2.7. Update System Time</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@archiso ~ # timedatectl set-ntp true</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check service status</span></span><br><span class="line">root@archiso ~ # timedatectl status</span><br></pre></td></tr></table></figure><h2 id="28-create-disk-partitions"><a class="markdownIt-Anchor" href="#28-create-disk-partitions"></a> 2.8. Create Disk Partitions</h2><p><strong>(1) View Disk Information</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">View Disk Information</span></span><br><span class="line">root@archiso ~ # fdisk -l</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Alternatively, use lsblk to view the disks. Disks without partitions will not be displayed as blocks.</span></span><br><span class="line">root@archiso ~ # lsblk</span><br></pre></td></tr></table></figure><p><code>lsblk</code> displays as shown in the following image:<br /><img src="https://s2.loli.net/2021/12/12/mGCcbKqvwR3Wod9.png" alt="lsblk展示磁盘信息" width="500"  srcFile="archlinux_first_lsblk.png"></p><ul><li>sda is a 500G hard drive, with 140G of sda1 used as the Win10 personal application data storage partition, and the remaining space allocated for the Arch Linux user home directory <code>/home</code>;</li><li>nvme0n1 is a 250G SSD, with 500M of nvme0n1p1 used for the Win10 EFI, 50M of nvme0n1p2 for the Win10 MSR, 99.4G (approximately 100G) of nvme0n1p3 for the Win10 system partition, nvme0n1p4 for the Win10 recovery system partition, and the remaining space allocated for the Arch Linux root directory <code>/</code>.</li></ul><p><strong>(2) Create/Format/Mount Root Directory</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@archiso ~ # cfdisk /dev/nvme0n1</span><br></pre></td></tr></table></figure><ul><li><strong>Create Partition</strong>: Use the down arrow key to select the row at the bottom of the Device list that shows “Free space.” Choose “New” and press Enter. The “Partition size” at the bottom left will automatically fill with the current maximum available space on the disk (which can be modified). After confirming the partition size, press Enter.</li><li><strong>Write Partition</strong>: Select “Write” and press Enter, then type yes to confirm writing the partition to the disk.</li><li><strong>Exit cfdisk</strong>: Select “Quit” to exit.</li></ul><p>At this point, you can use <code>lsblk</code> to view the newly added partition, such as a new partition nvme0n1p5 under nvme0n1.</p><ul><li><strong>Partition Formatting</strong>:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Format the newly created partition to ext4 format. Ensure the partition number is nvme0n1p5.</span></span><br><span class="line">root@archiso ~ # mkfs.ext4 /dev/nvme0n1p5</span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2021/12/12/54vitAId8xjobMy.png" alt="格式化nvme0n1p5为ext4" width="550"  srcFile="archlinux_mkfs_ext4_root.png"><ul><li><strong>Mount Partition</strong>:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Mount the root partition to `/mnt`</span></span><br><span class="line">root@archiso ~ #  mount /dev/nvme0n1p5 /mnt</span><br></pre></td></tr></table></figure><blockquote><p>Note: When mounting partitions, it’s essential to follow the correct order: first mount the root partition (to /mnt), then mount the boot partition (to /mnt/boot or /mnt/efi, if it’s separated), and finally mount any other partitions. Otherwise, you may encounter issues with booting the system after installation.</p></blockquote><p><strong>(3) Create/Format/Mount User Home Directory</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@archiso ~ # cfdisk /dev/sda</span><br></pre></td></tr></table></figure><p>Create and write partitions as described above.</p><p>At this point, you can use <code>lsblk</code> to view the newly added partition, such as an additional partition sda2 under sda.</p><ul><li><strong>Partition Formatting</strong>:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Format the newly created partition as ext4, ensuring the partition number is sda2</span></span><br><span class="line">root@archiso ~ # mkfs.ext4 /dev/sda2</span><br></pre></td></tr></table></figure><ul><li><strong>Mounting the Partition</strong>:</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@archiso ~ # mkdir /mnt/home</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Mount the user home directory to /mnt/home</span></span><br><span class="line">root@archiso ~ # mount /dev/sda2 /mnt/home</span><br></pre></td></tr></table></figure><p><strong>(4) Mount EFI</strong><br />Since it’s a dual-boot installation, the EFI partition for Arch Linux shares the one used by Windows.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@archiso ~ # mkdir /mnt/efi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Mount the EFI partition</span></span><br><span class="line">root@archiso ~ # mount /dev/nvme0n1p1 /mnt/efi</span><br></pre></td></tr></table></figure><p><strong>(5) Confirm All Mounting Status</strong><br /><img src="https://s2.loli.net/2021/12/12/VqCgIlS6v8ZMLoy.png" alt="lsblk确认挂载情况" width="500"  srcFile="archlinux_final_lsblk.png"></p><h2 id="29-install-the-basic-system"><a class="markdownIt-Anchor" href="#29-install-the-basic-system"></a> 2.9. Install the Basic System</h2><p>Before installation, consider changing to a domestic mirror source to speed up download speeds, such as USTC or Tsinghua. (For Chinese user!)</p><p>Use <code>vim /etc/pacman.d/mirrorlist</code> to modify the mirror sources, adding the following lines at the top:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Tsinghua University</span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch </span><br><span class="line"># USTC</span><br><span class="line">Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch</span><br></pre></td></tr></table></figure><p>Update the package cache:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@archiso ~ # pacman -Syy</span><br></pre></td></tr></table></figure><p>Install the base packages:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install the base software package, Linux kernel, and firmware <span class="keyword">for</span> common hardware</span></span><br><span class="line">root@archiso ~ # pacstrap /mnt base base-devel linux linux-firmware</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install functional software: dhcpcd <span class="keyword">for</span> wired, iwd <span class="keyword">for</span> wireless, vim editor, sudo <span class="keyword">for</span> privilege escalation</span></span><br><span class="line">root@archiso ~ # pacstrap /mnt dhcpcd iwd vim sudo</span><br></pre></td></tr></table></figure><h2 id="210-generate-the-fstab-file"><a class="markdownIt-Anchor" href="#210-generate-the-fstab-file"></a> 2.10. Generate the fstab File</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@archiso ~ # genfstab -U /mnt &gt;&gt; /mnt/etc/fstab</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check the generated fstab file</span></span><br><span class="line">root@archiso ~ # cat /mnt/etc/fstab</span><br></pre></td></tr></table></figure><h2 id="211-chroot"><a class="markdownIt-Anchor" href="#211-chroot"></a> 2.11. Chroot</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Change root to the newly installed system</span></span><br><span class="line">root@archiso ~ # arch-chroot /mnt</span><br></pre></td></tr></table></figure><h2 id="212-set-the-time-zone"><a class="markdownIt-Anchor" href="#212-set-the-time-zone"></a> 2.12. Set the Time Zone</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Set the time zone</span></span><br><span class="line">[root@archiso /]# ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Or</span></span><br><span class="line">[root@archiso /]# timedatectl set-timezone Asia/Shanghai</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Synchronize the hardware clock</span></span><br><span class="line">[root@archiso /]# hwclock --systohc</span><br></pre></td></tr></table></figure><h2 id="213-set-locale"><a class="markdownIt-Anchor" href="#213-set-locale"></a> 2.13. Set Locale</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@archiso /]# vim /etc/locale.gen</span><br></pre></td></tr></table></figure><p>Find the lines for <code>en_US.UTF-8 UTF-8</code> and <code>zh_CN.UTF-8 UTF-8</code>, remove the <code>#</code> at the beginning of each line, and save and exit.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Generate locale information</span></span><br><span class="line">[root@archiso /]# locale-gen</span><br></pre></td></tr></table></figure><p>Create and write to the <code>/etc/locale.conf</code> file: <code>vim /etc/locale.conf</code><br />Add the following content: <code>LANG=en_US.UTF-8</code><br />Exit and save.</p><h2 id="214-set-the-hostname"><a class="markdownIt-Anchor" href="#214-set-the-hostname"></a> 2.14. Set the Hostname</h2><p>Create and write the hostname: <code>vim /etc/hostname</code><br />Add the following content (modify as needed): <code>utopia</code></p><p>Modify the hosts file: <code>vim /etc/hosts</code><br />Add the following content:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost</span><br><span class="line">::1         localhost</span><br><span class="line">127.0.0.1   utopia</span><br></pre></td></tr></table></figure><p>Exit and save.</p><h2 id="215-set-the-root-user-password"><a class="markdownIt-Anchor" href="#215-set-the-root-user-password"></a> 2.15. Set the Root User Password</h2><p>Create a password for the root user:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@archiso /]# passwd root</span><br></pre></td></tr></table></figure><h2 id="216-create-the-bootloader"><a class="markdownIt-Anchor" href="#216-create-the-bootloader"></a> 2.16. Create the Bootloader</h2><ul><li><strong>Install Microcode</strong>:<br />If you’re unsure of your CPU model, you can install <code>pacman -S neofetch</code> to check your computer’s CPU model.</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For Intel CPUs, install intel-ucode</span></span><br><span class="line">[root@archiso /]# pacman -S intel-ucode</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For AMD CPUs, install amd-ucode</span></span><br><span class="line">[root@archiso /]# pacman -S amd-ucode</span><br></pre></td></tr></table></figure><p>For UEFI boot mode, you need to install both grub and efibootmgr:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">grub is the bootloader, and efibootmgr is used by grub scripts to write boot entries to NVRAM</span></span><br><span class="line">[root@archiso /]# pacman -S grub efibootmgr</span><br><span class="line">[root@archiso /]# pacman -S os-prober dosfstools</span><br></pre></td></tr></table></figure><blockquote><p>Grub 2.06 update requires user intervention for os-prober:</p><ol><li>If you are using os-prober to generate boot entries for other systems, grub 2.06 no longer automatically enables os-prober. You need to add <code>GRUB_DISABLE_OS_PROBER=false</code> to the /etc/default/grub configuration file and re-run grub-mkconfig.</li><li>Grub 2.06 will now automatically add firmware setup menu boot entries, eliminating the need to create them manually.</li></ol></blockquote><p>Given this, you need to manually enable os-prober to ensure Windows is correctly recognized:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@archiso /]# vim /etc/default/grub</span><br></pre></td></tr></table></figure><p>Find an empty line and add: <code>GRUB_DISABLE_OS_PROBER=false</code>, then save and exit.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install the GRUB EFI application grubx64.efi to /efi and its modules to /boot/grub/x86_64-efi/</span></span><br><span class="line">[root@archiso /]# grub-install --target=x86_64-efi --efi-directory=/efi --bootloader-id=GRUB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Generate grub.cfg</span></span><br><span class="line">[root@archiso /]# grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure><img src="https://s2.loli.net/2021/12/12/2DAXIRQFtSTPlwf.png" alt="安装grub引导程序" width="600"  srcFile="archlinux_grub_mkconfig.png"><h2 id="217-complete-the-installation"><a class="markdownIt-Anchor" href="#217-complete-the-installation"></a> 2.17. Complete the Installation</h2><p>Exit the new system and unmount:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Exit arch-chroot</span></span><br><span class="line">[root@archiso /]# exit</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Unmount all</span></span><br><span class="line">root@archiso ~ # umount -R /mnt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Reboot, please remove the USB drive during startup</span></span><br><span class="line">root@archiso ~ # reboot</span><br></pre></td></tr></table></figure><p>After rebooting, log in with the root user and password.<br />Connect to the network:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start DHCP immediately</span></span><br><span class="line">[root@utopia ~]# systemctl start dhcpcd</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For wireless connections, you need to start iwd and connect via iwctl</span></span><br><span class="line">[root@utopia ~]# systemctl start iwd</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Connect using iwctl as mentioned above</span></span><br><span class="line">[root@utopia ~]# iwctl</span><br></pre></td></tr></table></figure><h1 id="3-arch-linux-desktop-environment-and-common-applications"><a class="markdownIt-Anchor" href="#3-arch-linux-desktop-environment-and-common-applications"></a> 3. Arch Linux Desktop Environment and Common Applications</h1><h2 id="31-set-up-the-archlinuxcn-repository-and-install-yay"><a class="markdownIt-Anchor" href="#31-set-up-the-archlinuxcn-repository-and-install-yay"></a> 3.1. Set Up the archlinuxcn Repository and Install yay</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Modify /etc/pacman.conf and add the following at the end:</span></span><br><span class="line">[archlinuxcn]</span><br><span class="line">SigLevel = Optional TrustedOnly</span><br><span class="line">Include = /etc/pacman.d/archlinuxcn</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Then create /etc/pacman.d/archlinuxcn and add:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">USTC</span></span><br><span class="line">Server = https://mirrors.ustc.edu.cn/archlinuxcn/$arch</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Tsinghua University</span></span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">After setting up, update the package sources</span></span><br><span class="line">[root@utopia ~]# pacman -Syyu</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install the keyring</span></span><br><span class="line">[root@utopia ~]# pacman -Sy archlinuxcn-keyring</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install yay (Yet Another Yaourt): not included <span class="keyword">in</span> the official repository, only available <span class="keyword">in</span> archlinuxcn</span></span><br><span class="line">[root@utopia ~]# pacman -S yay</span><br></pre></td></tr></table></figure><blockquote><p>The AUR is a software repository maintained by the Arch Linux community. The official address is: <a href="https://aur.archlinux.org/">AUR (en) - Home (archlinux.org)</a>.<br />You can use AUR software through yaourt (previously popular but now discontinued) and yay (currently the preferred option).</p></blockquote><h2 id="32-add-a-non-root-user-set-up-a-personal-account"><a class="markdownIt-Anchor" href="#32-add-a-non-root-user-set-up-a-personal-account"></a> 3.2. Add a Non-root User (Set Up a Personal Account)</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The wheel group can use sudo <span class="keyword">for</span> privilege escalation. -m creates the user<span class="string">&#x27;s home directory, and ray is the username (set as needed).</span></span></span><br><span class="line">[root@utopia ~]# useradd -m -G wheel -s /bin/bash ray</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Set a new password for the newly created user ray</span></span></span><br><span class="line">[root@utopia ~]# passwd ray</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Edit the sudo file</span></span></span><br><span class="line">[root@utopia ~]# EDITOR=vim visudo</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Find the line #%wheel ALL=(ALL) ALL and remove the # at the beginning, then :wq to save and exit.</span></span></span><br></pre></td></tr></table></figure><h2 id="33-install-dual-graphics-card-driver"><a class="markdownIt-Anchor" href="#33-install-dual-graphics-card-driver"></a> 3.3. Install Dual Graphics Card Driver</h2><p><strong>(0) Check Graphics Card Devices:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Check graphics card information</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">lspci -k | grep -A 2 -E <span class="string">&quot;(VGA|3D)&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">I have a dual graphics card:</span></span><br><span class="line">00:02.0 VGA compatible controller: Intel Corporation HD Graphics 630 (rev 04)</span><br><span class="line">        Subsystem: Lenovo Device 505e</span><br><span class="line">        Kernel driver in use: i915</span><br><span class="line">--</span><br><span class="line">02:00.0 3D controller: NVIDIA Corporation GM108M [GeForce 940MX] (rev a2)</span><br><span class="line">        Subsystem: Lenovo Device 505e</span><br><span class="line">        Kernel modules: nouveau</span><br></pre></td></tr></table></figure><p><strong>(1) Install xorg:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Essential <span class="keyword">for</span> graphical interface</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">xorg is a specific open-source implementation of X11, providing an X Server responsible <span class="keyword">for</span> low-level operations. When you run a program, it connects to the X server, <span class="built_in">which</span> handles keyboard and mouse input, manages screen output, window movement, window title styles, and more.</span></span><br><span class="line">[root@utopia ~]# pacman -S xorg</span><br></pre></td></tr></table></figure><blockquote><p>It is recommended to use open-source drivers for all AMD graphics cards and closed-source drivers for NVIDIA graphics cards.</p></blockquote><p><strong>(2) Installing Intel Graphics:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@utopia ~]# pacman -S mesa lib32-mesa vulkan-intel lib32-vulkan-intel</span><br></pre></td></tr></table></figure><blockquote><p>Intel Graphics Wiki: <a href="https://wiki.archlinux.org/title/Intel_graphics">Intel graphics - ArchWiki (archlinux.org)</a><br />Arch Wiki generally does not recommend installing xf86-video-intel, but instead using xorg’s modesetting driver (more stable).<br />Note: Only Intel HD 4000 and above integrated graphics support Vulkan.</p></blockquote><p><strong>(3) Installing NVIDIA Graphics Card:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">For GeForce 930 and above, 10 series to 20 series, Quadro / Tesla / Tegra K-series, and newer GPUs (NV110 and newer GPU families), install the nvidia package (<span class="keyword">for</span> linux package) or nvidia-lts package (<span class="keyword">for</span> linux-lts package).</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">NVIDIA Installation Wiki: https://wiki.archlinuxcn.org/wiki/NVIDIA<span class="comment">#%E5%AE%89%E8%A3%85</span></span></span><br><span class="line">[root@utopia ~]# pacman -S nvidia</span><br></pre></td></tr></table></figure><blockquote><p>NVIDIA Wiki: <a href="https://wiki.archlinux.org/title/NVIDIA">NVIDIA - ArchWiki (archlinux.org)</a></p></blockquote><p><strong>(4) Installing Switchable Graphics Tool:</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@utopia ~]# yay -S optimus-manager optimus-manager-qt</span><br></pre></td></tr></table></figure><blockquote><p>optimus-manager provides three modes: dedicated GPU only, integrated GPU only, and hybrid dynamic switching mode.</p><p>After installation, simply restart to use. Upon installation, optimus-manager will automatically enable its service. You can check its status before rebooting; if not enabled, you can <code>sudo systemctl enable optimus-manager</code>.</p><p>Reference:</p><ul><li><a href="https://wiki.archlinux.org/title/NVIDIA_Optimus">NVIDIA Optimus - ArchWiki (archlinux.org)</a></li><li><a href="https://github.com/Askannz/optimus-manager/wiki">Home · Askannz/optimus-manager Wiki (github.com)</a></li><li><a href="https://archlinuxstudio.github.io/ArchLinuxTutorial/#/rookie/graphic_driver">Graphics Card Driver (archlinuxstudio.github.io)</a></li></ul></blockquote><h2 id="34-installing-graphic-interface-kde-plasma"><a class="markdownIt-Anchor" href="#34-installing-graphic-interface-kde-plasma"></a> 3.4. Installing Graphic Interface - KDE Plasma</h2><h3 id="341-installing-kde-desktop"><a class="markdownIt-Anchor" href="#341-installing-kde-desktop"></a> 3.4.1. Installing KDE Desktop</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install the plasma-meta meta package</span></span><br><span class="line">[root@utopia ~]# pacman -S plasma-meta</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install konsole terminal, dolphin file manager</span></span><br><span class="line">[root@utopia ~]# pacman -S konsole dolphin </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Configure greeter sddm</span></span><br><span class="line">[root@utopia ~]# systemctl enable sddm</span><br></pre></td></tr></table></figure><blockquote><ul><li><strong>KDE wiki</strong>: <a href="https://wiki.archlinux.org/title/KDE_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">KDE (Simplified Chinese) - ArchWiki (archlinux.org)</a></li><li>The difference between <strong>meta package (such as plasma-meta) and package group (such as plasma)</strong> can be found here: <a href="https://wiki.archlinux.org/title/Meta_package_and_package_group_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Meta package and package group (Simplified Chinese) - ArchWiki (archlinux.org)</a><br /><strong>plasma-meta</strong>: Meta package that installs software packages through dependencies. If new software packages are added later, they will be automatically installed during updates; users cannot choose to install only a part of the software that the meta package depends on.<br /><strong>plasma</strong>: Package group that is just a list, providing similar functionality to plasma-meta. If new software packages are added later, they <strong>will not</strong> be automatically installed during updates; users can choose to install some software in the group or choose to only remove some software from the package group.</li></ul></blockquote><p>After rebooting, you can enter the KDE graphical interface. For more information on using KDE, you can refer to <a href="https://userbase.kde.org/Welcome_to_KDE_UserBase/zh-cn">KDE UserBase</a>.</p><h3 id="342-network-setup-and-connection"><a class="markdownIt-Anchor" href="#342-network-setup-and-connection"></a> 3.4.2. Network Setup and Connection</h3><p>After completing the reboot and entering the desktop by entering the user password, open the konsole command terminal to configure the network settings.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ensure that iwd is disabled at boot as its wireless connections may conflict with NetworkManager</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl <span class="built_in">disable</span> iwd</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl stop iwd</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Make sure to start NetworkManager first and establish a network connection</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo systemctl <span class="built_in">enable</span> --now NetworkManager</span></span><br></pre></td></tr></table></figure><h3 id="343-setting-up-swap-file"><a class="markdownIt-Anchor" href="#343-setting-up-swap-file"></a> 3.4.3. Setting Up Swap File</h3><p>In a desktop environment, a swap partition or file is used to implement hibernation, which saves the current environment to a swap file or partition on disk. The performance of swap files and partitions is similar, but swap files are more flexible, allowing for changes in size, addition, and deletion at any time.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Create 16G of swap space, size can be adjusted as needed</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=/swapfile bs=1M count=16384 status=progress</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Set the correct permissions</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">chmod</span> 600 /swapfile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Format the swap file</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">mkswap /swapfile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Enable the swap file</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">swapon /swapfile</span></span><br></pre></td></tr></table></figure><p>Finally, append the following content to <code>/etc/fstab</code>: <code>/swapfile none swap defaults 0 0</code><br />KDE itself provides an out-of-the-box suspend function, which suspends the system to memory, consuming only a small amount of power. Hibernate will suspend the system to a swap partition or file, consuming almost no power.</p><blockquote><p>Hibernate function: <a href="https://wiki.archlinux.org/title/Power_management/Suspend_and_hibernate">Power management/Suspend and hibernate - ArchWiki (archlinux.org)</a></p></blockquote><h3 id="344-install-kde-applications"><a class="markdownIt-Anchor" href="#344-install-kde-applications"></a> 3.4.4. Install KDE Applications</h3><p>Here is the translation, keeping the format intact:</p><h3 id="344-install-kde-applications-2"><a class="markdownIt-Anchor" href="#344-install-kde-applications-2"></a> 3.4.4. Install KDE Applications</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Install the KDE application package repository: such as kde-applications or kde-applications-meta, you can also choose to install:</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">It is recommended to install system utilities, <span class="built_in">which</span> include basic applications required by the KDE desktop environment, such as the terminal tool Konsole, file editor Kate, dropdown terminal yakuake, compression tool Ark, etc.</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S kde-utilities</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Graphics tool collection, including image viewer Gwenview, PDF viewer Okular, screenshot tool Spectacle, etc.</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S kde-graphics</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">System tool collection, including file manager dolphin, partition manager partitionmanager, etc.</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S kde-system</span></span><br></pre></td></tr></table></figure><p>The above are optional installations. Alternatively, you can choose to install the full KDE suite. The <code>kde-applications-meta / kde-applications</code> package includes a variety of software, and while it offers a comprehensive set of applications, it also means the space usage after installation is quite large. It is generally not recommended to install it, and you can choose to install selectively based on your actual needs. For the difference between a <strong>meta package</strong> and a <strong>package group</strong>, refer to: <a href="https://wiki.archlinux.org/title/Meta_package_and_package_group_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Meta package and package group</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">meta package</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S kde-applications-meta</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">package group</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pacman -S kde-applications</span></span><br></pre></td></tr></table></figure><h1 id="references"><a class="markdownIt-Anchor" href="#references"></a> References</h1><ul><li><a href="https://wiki.archlinuxcn.org/wiki/%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97">Arch Linux 安装指南 (wiki)</a></li><li><a href="https://archlinuxstudio.github.io/ArchLinuxTutorial/#/">Arch Linux 安装使用教程 - ArchTutorial - Arch Linux Studio</a></li><li><a href="https://zhuanlan.zhihu.com/p/138951848">2021 Archlinux双系统安装教程（超详细）</a></li><li><a href="https://www.jianshu.com/p/7c2ab582e13d">Arch Linux + KDE安装教程</a></li></ul>]]></content>
        
        
        <categories>
            
            <category> Arch Linux Series </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Arch_Linux </tag>
            
            <tag> OS </tag>
            
            <tag> Windows </tag>
            
        </tags>
        
    </entry>
    
    
    
    <entry>
        <title>Abstract Factory Pattern</title>
        <link href="/en/design-pattern/abstract-factory-pattern/"/>
        <url>/en/design-pattern/abstract-factory-pattern/</url>
        
        <content type="html"><![CDATA[<h1 id="0-overview"><a class="markdownIt-Anchor" href="#0-overview"></a> 0. Overview</h1><p><strong>Abstract Factory Pattern</strong>: is defined as a design pattern that provides an interface for creating a group of related or interdependent objects, allowing the client to access these objects without specifying their concrete classes. This way, clients can obtain various products of the same family at different levels without knowing the specifics of the products’ classes.</p><p>The <strong>Abstract Factory Pattern</strong> is a type of creational pattern and can be considered an advanced version of the <a href="/en/design-pattern/factory-method-pattern">Factory Method Pattern</a>. In the Factory Method Pattern, the focus is on <u>one product level structure</u>, while the Abstract Factory Pattern deals with <u>multiple product level structures</u>. When a factory structure can create an entire family of objects across different product level structures, the Abstract Factory Pattern becomes simpler and more efficient compared to the Factory Method Pattern.</p><ul><li><strong>Product Family</strong>: Refers to a family of products that are functionally related and belong to different product level structures; it is <span style="background:#fff88f">a group of products produced by the same factory, each belonging to a distinct product level</span>. For example, Huawei’s family includes a phone, laptop, and earphones, while Apple’s family includes a phone, laptop, and earphones. Both families represent three product levels: phone, laptop, and earphones.</li><li><strong>Product Class (Product Level)</strong>: This refers to <span style="background:#fff88f">a product’s inheritance structure</span>. For instance, if the abstract product is a phone, its subclasses might include Huawei and Apple phones. The abstract phone and its specific brands constitute a product level structure, with the abstract phone as the parent class and specific brand phones as its subclasses.</li></ul><p>The diagram below illustrates the relationship between product families and product levels. The horizontal axis represents product levels, while the vertical axis represents product families. There are two product families (Huawei Factory, Apple Factory), each with three product levels (phone, laptop, earphones). By identifying the product family and its level, a product can be uniquely determined.</p><img src="https://s2.loli.net/2024/11/07/vAQbriLUPkR4GON.png" alt="abstract_factory_product_concept" width="500"  srcFile="abstract_factory_product_concept.png"><p>From the diagram above, we can see that each concrete factory can produce all the products belonging to one product family, so the Abstract Factory Pattern only requires two concrete factories. In contrast, using the Factory Method Pattern for six concrete products would require six concrete factories, increasing complexity and the number of classes in the system.</p><h1 id="1-structure-and-implementation"><a class="markdownIt-Anchor" href="#1-structure-and-implementation"></a> 1. Structure and Implementation</h1><p>Like the Factory Method Pattern, the Abstract Factory Pattern consists of four main elements: abstract factory, concrete factory, abstract product, and concrete product. However, the Abstract Factory Pattern differs in the number of methods within the abstract factory and the number of abstract products.</p><p>The main roles are as follows:</p><ul><li><strong>Abstract Factory</strong> (IFactory): Provides an interface for creating a series of products, containing multiple product creation methods such as <code>makePhone()</code>, <code>makeLaptop()</code>, and <code>makeEarphone()</code>, allowing the creation of products across different levels.</li><li><strong>Concrete Factory</strong> (HuaweiFactory, AppleFactory): Implements the methods defined in the abstract factory to create specific products within its product family.</li><li><strong>Abstract Product</strong> (IProduct, AbstractPhone, AbstractLaptop, AbstractEarphone): Defines product specifications, describing the main characteristics and functions of the products.</li><li><strong>Concrete Product</strong> (HuaweiPhone, HuaweiLaptop, HuaweiEarphone, ApplePhone, AppleLaptop, AppleEarphone): Implements the interfaces defined by the abstract product role. Each concrete product is created by a corresponding concrete factory.</li></ul><p>The class diagram is as follows:</p><img class="kroki" src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXMtYXNjaWkiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSI4NDJweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjE3NDdweDtoZWlnaHQ6ODQycHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMTc0NyA4NDIiIHdpZHRoPSIxNzQ3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48IS0tY2x1c3RlciBQcm9kdWN0LS0+PGcgaWQ9ImNsdXN0ZXJfUHJvZHVjdCI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIzMzEuNDUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjE3MzQiIHg9IjciIHk9IjUwNC43OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2MiIgeD0iODQzIiB5PSI1MTkuNzc1MSI+UHJvZHVjdDwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgSHVhd2VpLS0+PGcgaWQ9ImNsdXN0ZXJfSHVhd2VpIj48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjI0OC40NSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7IiB3aWR0aD0iNTYzIiB4PSI1NDMiIHk9IjU1NS43OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1OCIgeD0iNzk1LjUiIHk9IjU3MC43NzUxIj5IdWF3ZWk8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIEFwcGxlLS0+PGcgaWQ9ImNsdXN0ZXJfQXBwbGUiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjQ4LjQ1IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiIHdpZHRoPSI1NjMiIHg9IjExNDYiIHk9IjU1NS43OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0NSIgeD0iMTQwNSIgeT0iNTcwLjc3NTEiPkFwcGxlPC90ZXh0PjwvZz48IS0tY2x1c3RlciBGYWN0b3J5LS0+PGcgaWQ9ImNsdXN0ZXJfRmFjdG9yeSI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIzMjEuNzgiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjQ5NSIgeD0iNjQ3IiB5PSIxMjYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTkiIHg9Ijg2NSIgeT0iMTQwLjk5NTEiPkZhY3Rvcnk8L3RleHQ+PC9nPjwhLS1jbGFzcyBJUHJvZHVjdC0tPjxnIGlkPSJlbGVtX0lQcm9kdWN0Ij48cmVjdCBjb2RlTGluZT0iNCIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iSVByb2R1Y3QiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMiIgeD0iMjMwIiB5PSI1OTAuNjQiLz48ZWxsaXBzZSBjeD0iMjUwLjg1IiBjeT0iNjA2LjY0IiBmaWxsPSIjQjRBN0U1IiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTI0Ni43NzE5LDYwMi40MDU2IEwyNDYuNzcxOSw2MDAuMjQ5NCBMMjU0LjE2MjUsNjAwLjI0OTQgTDI1NC4xNjI1LDYwMi40MDU2IEwyNTEuNjkzOCw2MDIuNDA1NiBMMjUxLjY5MzgsNjEwLjQ4MzggTDI1NC4xNjI1LDYxMC40ODM4IEwyNTQuMTYyNSw2MTIuNjQgTDI0Ni43NzE5LDYxMi42NCBMMjQ2Ljc3MTksNjEwLjQ4MzggTDI0OS4yNDA2LDYxMC40ODM4IEwyNDkuMjQwNiw2MDIuNDA1NiBMMjQ2Ljc3MTksNjAyLjQwNTYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC1zdHlsZT0iaXRhbGljIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU3IiB4PSIyNjYuMTUiIHk9IjYxMS40ODY3Ij5JUHJvZHVjdDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyMzEiIHgyPSIzMzEiIHkxPSI2MjIuNjQiIHkyPSI2MjIuNjQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyMzEiIHgyPSIzMzEiIHkxPSI2MzAuNjQiIHkyPSI2MzAuNjQiLz48ZWxsaXBzZSBjeD0iMjQxIiBjeT0iNjQ0LjI4ODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzYiIHg9IjI1MCIgeT0iNjQ3LjYzNTEiPnZvaWQgZGVzYygpPC90ZXh0PjwvZz48IS0tY2xhc3MgQWJzdHJhY3RQaG9uZS0tPjxnIGlkPSJlbGVtX0Fic3RyYWN0UGhvbmUiPjxyZWN0IGNvZGVMaW5lPSI4IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJBYnN0cmFjdFBob25lIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMzQiIHg9IjIxNCIgeT0iNzE1LjkzIi8+PGVsbGlwc2UgY3g9IjIyOSIgY3k9IjczMS45MyIgZmlsbD0iI0E5RENERiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0yMjkuMTA5NCw3MjcuMjczOCBMMjI3Ljk1MzEsNzMyLjM1MTkgTDIzMC4yODEzLDczMi4zNTE5IEwyMjkuMTA5NCw3MjcuMjczOCBaIE0yMjcuNjI1LDcyNS4wMzk0IEwyMzAuNjA5NCw3MjUuMDM5NCBMMjMzLjk2ODgsNzM3LjQzIEwyMzEuNTE1Niw3MzcuNDMgTDIzMC43NSw3MzQuMzY3NSBMMjI3LjQ2ODgsNzM0LjM2NzUgTDIyNi43MTg4LDczNy40MyBMMjI0LjI4MTMsNzM3LjQzIEwyMjcuNjI1LDcyNS4wMzk0IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDIiIHg9IjI0MyIgeT0iNzM2Ljc3NjciPkFic3RyYWN0UGhvbmU8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjE1IiB4Mj0iMzQ3IiB5MT0iNzQ3LjkzIiB5Mj0iNzQ3LjkzIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjE1IiB4Mj0iMzQ3IiB5MT0iNzU1LjkzIiB5Mj0iNzU1LjkzIi8+PGVsbGlwc2UgY3g9IjIyNSIgY3k9Ijc2OS41Nzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXN0eWxlPSJpdGFsaWMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzYiIHg9IjIzNCIgeT0iNzcyLjkyNTEiPnZvaWQgZGVzYygpPC90ZXh0PjwvZz48IS0tY2xhc3MgQWJzdHJhY3RMYXB0b3AtLT48ZyBpZD0iZWxlbV9BYnN0cmFjdExhcHRvcCI+PHJlY3QgY29kZUxpbmU9IjExIiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJBYnN0cmFjdExhcHRvcCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTM2IiB4PSIzODMiIHk9IjcxNS45MyIvPjxlbGxpcHNlIGN4PSIzOTgiIGN5PSI3MzEuOTMiIGZpbGw9IiNBOURDREYiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMzk4LjEwOTQsNzI3LjI3MzggTDM5Ni45NTMxLDczMi4zNTE5IEwzOTkuMjgxMyw3MzIuMzUxOSBMMzk4LjEwOTQsNzI3LjI3MzggWiBNMzk2LjYyNSw3MjUuMDM5NCBMMzk5LjYwOTQsNzI1LjAzOTQgTDQwMi45Njg4LDczNy40MyBMNDAwLjUxNTYsNzM3LjQzIEwzOTkuNzUsNzM0LjM2NzUgTDM5Ni40Njg4LDczNC4zNjc1IEwzOTUuNzE4OCw3MzcuNDMgTDM5My4yODEzLDczNy40MyBMMzk2LjYyNSw3MjUuMDM5NCBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXN0eWxlPSJpdGFsaWMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA0IiB4PSI0MTIiIHk9IjczNi43NzY3Ij5BYnN0cmFjdExhcHRvcDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzODQiIHgyPSI1MTgiIHkxPSI3NDcuOTMiIHkyPSI3NDcuOTMiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzODQiIHgyPSI1MTgiIHkxPSI3NTUuOTMiIHkyPSI3NTUuOTMiLz48ZWxsaXBzZSBjeD0iMzk0IiBjeT0iNzY5LjU3ODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NiIgeD0iNDAzIiB5PSI3NzIuOTI1MSI+dm9pZCBkZXNjKCk8L3RleHQ+PC9nPjwhLS1jbGFzcyBBYnN0cmFjdEVhcnBob25lLS0+PGcgaWQ9ImVsZW1fQWJzdHJhY3RFYXJwaG9uZSI+PHJlY3QgY29kZUxpbmU9IjE0IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJBYnN0cmFjdEVhcnBob25lIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTYiIHg9IjIzIiB5PSI3MTUuOTMiLz48ZWxsaXBzZSBjeD0iMzgiIGN5PSI3MzEuOTMiIGZpbGw9IiNBOURDREYiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMzguMTA5NCw3MjcuMjczOCBMMzYuOTUzMSw3MzIuMzUxOSBMMzkuMjgxMyw3MzIuMzUxOSBMMzguMTA5NCw3MjcuMjczOCBaIE0zNi42MjUsNzI1LjAzOTQgTDM5LjYwOTQsNzI1LjAzOTQgTDQyLjk2ODgsNzM3LjQzIEw0MC41MTU2LDczNy40MyBMMzkuNzUsNzM0LjM2NzUgTDM2LjQ2ODgsNzM0LjM2NzUgTDM1LjcxODgsNzM3LjQzIEwzMy4yODEzLDczNy40MyBMMzYuNjI1LDcyNS4wMzk0IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjQiIHg9IjUyIiB5PSI3MzYuNzc2NyI+QWJzdHJhY3RFYXJwaG9uZTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyNCIgeDI9IjE3OCIgeTE9Ijc0Ny45MyIgeTI9Ijc0Ny45MyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjI0IiB4Mj0iMTc4IiB5MT0iNzU1LjkzIiB5Mj0iNzU1LjkzIi8+PGVsbGlwc2UgY3g9IjM0IiBjeT0iNzY5LjU3ODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NiIgeD0iNDMiIHk9Ijc3Mi45MjUxIj52b2lkIGRlc2MoKTwvdGV4dD48L2c+PCEtLWNsYXNzIEh1YXdlaVBob25lLS0+PGcgaWQ9ImVsZW1fSHVhd2VpUGhvbmUiPjxyZWN0IGNvZGVMaW5lPSIxOSIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iSHVhd2VpUGhvbmUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEyNyIgeD0iOTUxLjUiIHk9IjcxNS45MyIvPjxlbGxpcHNlIGN4PSI5NjYuNSIgY3k9IjczMS45MyIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik05NjkuNDY4OCw3MzcuNTcwNiBROTY4Ljg5MDYsNzM3Ljg2NzUgOTY4LjI1LDczOC4wMDgxIFE5NjcuNjA5NCw3MzguMTY0NCA5NjYuOTA2Myw3MzguMTY0NCBROTY0LjQwNjMsNzM4LjE2NDQgOTYzLjA3ODEsNzM2LjUyMzggUTk2MS43NjU2LDczNC44Njc1IDk2MS43NjU2LDczMS43NDI1IFE5NjEuNzY1Niw3MjguNjE3NSA5NjMuMDc4MSw3MjYuOTYxMyBROTY0LjQwNjMsNzI1LjMwNSA5NjYuOTA2Myw3MjUuMzA1IFE5NjcuNjA5NCw3MjUuMzA1IDk2OC4yNSw3MjUuNDYxMyBROTY4LjkwNjMsNzI1LjYxNzUgOTY5LjQ2ODgsNzI1LjkxNDQgTDk2OS40Njg4LDcyOC42MzMxIFE5NjguODQzOCw3MjguMDU1IDk2OC4yNSw3MjcuNzg5NCBROTY3LjY1NjMsNzI3LjUwODEgOTY3LjAzMTMsNzI3LjUwODEgUTk2NS42ODc1LDcyNy41MDgxIDk2NSw3MjguNTg2MyBROTY0LjMxMjUsNzI5LjY0ODggOTY0LjMxMjUsNzMxLjc0MjUgUTk2NC4zMTI1LDczMy44MzYzIDk2NSw3MzQuOTE0NCBROTY1LjY4NzUsNzM1Ljk3NjkgOTY3LjAzMTMsNzM1Ljk3NjkgUTk2Ny42NTYzLDczNS45NzY5IDk2OC4yNSw3MzUuNzExMyBROTY4Ljg0MzgsNzM1LjQzIDk2OS40Njg4LDczNC44NTE5IEw5NjkuNDY4OCw3MzcuNTcwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk1IiB4PSI5ODAuNSIgeT0iNzM2Ljc3NjciPkh1YXdlaVBob25lPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9Ijk1Mi41IiB4Mj0iMTA3Ny41IiB5MT0iNzQ3LjkzIiB5Mj0iNzQ3LjkzIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOTUyLjUiIHgyPSIxMDc3LjUiIHkxPSI3NTUuOTMiIHkyPSI3NTUuOTMiLz48ZWxsaXBzZSBjeD0iOTYyLjUiIGN5PSI3NjkuNTc4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NiIgeD0iOTcxLjUiIHk9Ijc3Mi45MjUxIj52b2lkIGRlc2MoKTwvdGV4dD48L2c+PCEtLWNsYXNzIEFic3RyYWN0UGhvbmUtLT48ZyBpZD0iZWxlbV9BYnN0cmFjdFBob25lIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjQ4IiBpZD0iQWJzdHJhY3RQaG9uZSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTM0IiB4PSI5NDgiIHk9IjU5OC43OCIvPjxlbGxpcHNlIGN4PSI5NjMiIGN5PSI2MTQuNzgiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNOTY1Ljk2ODgsNjIwLjQyMDYgUTk2NS4zOTA2LDYyMC43MTc1IDk2NC43NSw2MjAuODU4MSBROTY0LjEwOTQsNjIxLjAxNDQgOTYzLjQwNjMsNjIxLjAxNDQgUTk2MC45MDYzLDYyMS4wMTQ0IDk1OS41NzgxLDYxOS4zNzM4IFE5NTguMjY1Niw2MTcuNzE3NSA5NTguMjY1Niw2MTQuNTkyNSBROTU4LjI2NTYsNjExLjQ2NzUgOTU5LjU3ODEsNjA5LjgxMTMgUTk2MC45MDYzLDYwOC4xNTUgOTYzLjQwNjMsNjA4LjE1NSBROTY0LjEwOTQsNjA4LjE1NSA5NjQuNzUsNjA4LjMxMTMgUTk2NS40MDYzLDYwOC40Njc1IDk2NS45Njg4LDYwOC43NjQ0IEw5NjUuOTY4OCw2MTEuNDgzMSBROTY1LjM0MzgsNjEwLjkwNSA5NjQuNzUsNjEwLjYzOTQgUTk2NC4xNTYzLDYxMC4zNTgxIDk2My41MzEzLDYxMC4zNTgxIFE5NjIuMTg3NSw2MTAuMzU4MSA5NjEuNSw2MTEuNDM2MyBROTYwLjgxMjUsNjEyLjQ5ODggOTYwLjgxMjUsNjE0LjU5MjUgUTk2MC44MTI1LDYxNi42ODYzIDk2MS41LDYxNy43NjQ0IFE5NjIuMTg3NSw2MTguODI2OSA5NjMuNTMxMyw2MTguODI2OSBROTY0LjE1NjMsNjE4LjgyNjkgOTY0Ljc1LDYxOC41NjEzIFE5NjUuMzQzOCw2MTguMjggOTY1Ljk2ODgsNjE3LjcwMTkgTDk2NS45Njg4LDYyMC40MjA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyIiB4PSI5NzciIHk9IjYxOS42MjY3Ij5BYnN0cmFjdFBob25lPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9Ijk0OSIgeDI9IjEwODEiIHkxPSI2MzAuNzgiIHkyPSI2MzAuNzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI5NDkiIHgyPSIxMDgxIiB5MT0iNjM4Ljc4IiB5Mj0iNjM4Ljc4Ii8+PC9nPjwhLS1jbGFzcyBIdWF3ZWlMYXB0b3AtLT48ZyBpZD0iZWxlbV9IdWF3ZWlMYXB0b3AiPjxyZWN0IGNvZGVMaW5lPSIyMiIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iSHVhd2VpTGFwdG9wIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMjkiIHg9Ijc4MC41IiB5PSI3MTUuOTMiLz48ZWxsaXBzZSBjeD0iNzk1LjUiIGN5PSI3MzEuOTMiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNNzk4LjQ2ODgsNzM3LjU3MDYgUTc5Ny44OTA2LDczNy44Njc1IDc5Ny4yNSw3MzguMDA4MSBRNzk2LjYwOTQsNzM4LjE2NDQgNzk1LjkwNjMsNzM4LjE2NDQgUTc5My40MDYzLDczOC4xNjQ0IDc5Mi4wNzgxLDczNi41MjM4IFE3OTAuNzY1Niw3MzQuODY3NSA3OTAuNzY1Niw3MzEuNzQyNSBRNzkwLjc2NTYsNzI4LjYxNzUgNzkyLjA3ODEsNzI2Ljk2MTMgUTc5My40MDYzLDcyNS4zMDUgNzk1LjkwNjMsNzI1LjMwNSBRNzk2LjYwOTQsNzI1LjMwNSA3OTcuMjUsNzI1LjQ2MTMgUTc5Ny45MDYzLDcyNS42MTc1IDc5OC40Njg4LDcyNS45MTQ0IEw3OTguNDY4OCw3MjguNjMzMSBRNzk3Ljg0MzgsNzI4LjA1NSA3OTcuMjUsNzI3Ljc4OTQgUTc5Ni42NTYzLDcyNy41MDgxIDc5Ni4wMzEzLDcyNy41MDgxIFE3OTQuNjg3NSw3MjcuNTA4MSA3OTQsNzI4LjU4NjMgUTc5My4zMTI1LDcyOS42NDg4IDc5My4zMTI1LDczMS43NDI1IFE3OTMuMzEyNSw3MzMuODM2MyA3OTQsNzM0LjkxNDQgUTc5NC42ODc1LDczNS45NzY5IDc5Ni4wMzEzLDczNS45NzY5IFE3OTYuNjU2Myw3MzUuOTc2OSA3OTcuMjUsNzM1LjcxMTMgUTc5Ny44NDM4LDczNS40MyA3OTguNDY4OCw3MzQuODUxOSBMNzk4LjQ2ODgsNzM3LjU3MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NyIgeD0iODA5LjUiIHk9IjczNi43NzY3Ij5IdWF3ZWlMYXB0b3A8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNzgxLjUiIHgyPSI5MDguNSIgeTE9Ijc0Ny45MyIgeTI9Ijc0Ny45MyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9Ijc4MS41IiB4Mj0iOTA4LjUiIHkxPSI3NTUuOTMiIHkyPSI3NTUuOTMiLz48ZWxsaXBzZSBjeD0iNzkxLjUiIGN5PSI3NjkuNTc4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NiIgeD0iODAwLjUiIHk9Ijc3Mi45MjUxIj52b2lkIGRlc2MoKTwvdGV4dD48L2c+PCEtLWNsYXNzIEFic3RyYWN0TGFwdG9wLS0+PGcgaWQ9ImVsZW1fQWJzdHJhY3RMYXB0b3AiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDgiIGlkPSJBYnN0cmFjdExhcHRvcCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTM2IiB4PSI3NzciIHk9IjU5OC43OCIvPjxlbGxpcHNlIGN4PSI3OTIiIGN5PSI2MTQuNzgiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNNzk0Ljk2ODgsNjIwLjQyMDYgUTc5NC4zOTA2LDYyMC43MTc1IDc5My43NSw2MjAuODU4MSBRNzkzLjEwOTQsNjIxLjAxNDQgNzkyLjQwNjMsNjIxLjAxNDQgUTc4OS45MDYzLDYyMS4wMTQ0IDc4OC41NzgxLDYxOS4zNzM4IFE3ODcuMjY1Niw2MTcuNzE3NSA3ODcuMjY1Niw2MTQuNTkyNSBRNzg3LjI2NTYsNjExLjQ2NzUgNzg4LjU3ODEsNjA5LjgxMTMgUTc4OS45MDYzLDYwOC4xNTUgNzkyLjQwNjMsNjA4LjE1NSBRNzkzLjEwOTQsNjA4LjE1NSA3OTMuNzUsNjA4LjMxMTMgUTc5NC40MDYzLDYwOC40Njc1IDc5NC45Njg4LDYwOC43NjQ0IEw3OTQuOTY4OCw2MTEuNDgzMSBRNzk0LjM0MzgsNjEwLjkwNSA3OTMuNzUsNjEwLjYzOTQgUTc5My4xNTYzLDYxMC4zNTgxIDc5Mi41MzEzLDYxMC4zNTgxIFE3OTEuMTg3NSw2MTAuMzU4MSA3OTAuNSw2MTEuNDM2MyBRNzg5LjgxMjUsNjEyLjQ5ODggNzg5LjgxMjUsNjE0LjU5MjUgUTc4OS44MTI1LDYxNi42ODYzIDc5MC41LDYxNy43NjQ0IFE3OTEuMTg3NSw2MTguODI2OSA3OTIuNTMxMyw2MTguODI2OSBRNzkzLjE1NjMsNjE4LjgyNjkgNzkzLjc1LDYxOC41NjEzIFE3OTQuMzQzOCw2MTguMjggNzk0Ljk2ODgsNjE3LjcwMTkgTDc5NC45Njg4LDYyMC40MjA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA0IiB4PSI4MDYiIHk9IjYxOS42MjY3Ij5BYnN0cmFjdExhcHRvcDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI3NzgiIHgyPSI5MTIiIHkxPSI2MzAuNzgiIHkyPSI2MzAuNzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI3NzgiIHgyPSI5MTIiIHkxPSI2MzguNzgiIHkyPSI2MzguNzgiLz48L2c+PCEtLWNsYXNzIEh1YXdlaUVhcnBob25lLS0+PGcgaWQ9ImVsZW1fSHVhd2VpRWFycGhvbmUiPjxyZWN0IGNvZGVMaW5lPSIyNSIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iSHVhd2VpRWFycGhvbmUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE0OSIgeD0iNTg5LjUiIHk9IjcxNS45MyIvPjxlbGxpcHNlIGN4PSI2MDQuNSIgY3k9IjczMS45MyIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik02MDcuNDY4OCw3MzcuNTcwNiBRNjA2Ljg5MDYsNzM3Ljg2NzUgNjA2LjI1LDczOC4wMDgxIFE2MDUuNjA5NCw3MzguMTY0NCA2MDQuOTA2Myw3MzguMTY0NCBRNjAyLjQwNjMsNzM4LjE2NDQgNjAxLjA3ODEsNzM2LjUyMzggUTU5OS43NjU2LDczNC44Njc1IDU5OS43NjU2LDczMS43NDI1IFE1OTkuNzY1Niw3MjguNjE3NSA2MDEuMDc4MSw3MjYuOTYxMyBRNjAyLjQwNjMsNzI1LjMwNSA2MDQuOTA2Myw3MjUuMzA1IFE2MDUuNjA5NCw3MjUuMzA1IDYwNi4yNSw3MjUuNDYxMyBRNjA2LjkwNjMsNzI1LjYxNzUgNjA3LjQ2ODgsNzI1LjkxNDQgTDYwNy40Njg4LDcyOC42MzMxIFE2MDYuODQzOCw3MjguMDU1IDYwNi4yNSw3MjcuNzg5NCBRNjA1LjY1NjMsNzI3LjUwODEgNjA1LjAzMTMsNzI3LjUwODEgUTYwMy42ODc1LDcyNy41MDgxIDYwMyw3MjguNTg2MyBRNjAyLjMxMjUsNzI5LjY0ODggNjAyLjMxMjUsNzMxLjc0MjUgUTYwMi4zMTI1LDczMy44MzYzIDYwMyw3MzQuOTE0NCBRNjAzLjY4NzUsNzM1Ljk3NjkgNjA1LjAzMTMsNzM1Ljk3NjkgUTYwNS42NTYzLDczNS45NzY5IDYwNi4yNSw3MzUuNzExMyBRNjA2Ljg0MzgsNzM1LjQzIDYwNy40Njg4LDczNC44NTE5IEw2MDcuNDY4OCw3MzcuNTcwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNyIgeD0iNjE4LjUiIHk9IjczNi43NzY3Ij5IdWF3ZWlFYXJwaG9uZTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI1OTAuNSIgeDI9IjczNy41IiB5MT0iNzQ3LjkzIiB5Mj0iNzQ3LjkzIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTkwLjUiIHgyPSI3MzcuNSIgeTE9Ijc1NS45MyIgeTI9Ijc1NS45MyIvPjxlbGxpcHNlIGN4PSI2MDAuNSIgY3k9Ijc2OS41Nzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc2IiB4PSI2MDkuNSIgeT0iNzcyLjkyNTEiPnZvaWQgZGVzYygpPC90ZXh0PjwvZz48IS0tY2xhc3MgQWJzdHJhY3RFYXJwaG9uZS0tPjxnIGlkPSJlbGVtX0Fic3RyYWN0RWFycGhvbmUiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDgiIGlkPSJBYnN0cmFjdEVhcnBob25lIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTYiIHg9IjU4NiIgeT0iNTk4Ljc4Ii8+PGVsbGlwc2UgY3g9IjYwMSIgY3k9IjYxNC43OCIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik02MDMuOTY4OCw2MjAuNDIwNiBRNjAzLjM5MDYsNjIwLjcxNzUgNjAyLjc1LDYyMC44NTgxIFE2MDIuMTA5NCw2MjEuMDE0NCA2MDEuNDA2Myw2MjEuMDE0NCBRNTk4LjkwNjMsNjIxLjAxNDQgNTk3LjU3ODEsNjE5LjM3MzggUTU5Ni4yNjU2LDYxNy43MTc1IDU5Ni4yNjU2LDYxNC41OTI1IFE1OTYuMjY1Niw2MTEuNDY3NSA1OTcuNTc4MSw2MDkuODExMyBRNTk4LjkwNjMsNjA4LjE1NSA2MDEuNDA2Myw2MDguMTU1IFE2MDIuMTA5NCw2MDguMTU1IDYwMi43NSw2MDguMzExMyBRNjAzLjQwNjMsNjA4LjQ2NzUgNjAzLjk2ODgsNjA4Ljc2NDQgTDYwMy45Njg4LDYxMS40ODMxIFE2MDMuMzQzOCw2MTAuOTA1IDYwMi43NSw2MTAuNjM5NCBRNjAyLjE1NjMsNjEwLjM1ODEgNjAxLjUzMTMsNjEwLjM1ODEgUTYwMC4xODc1LDYxMC4zNTgxIDU5OS41LDYxMS40MzYzIFE1OTguODEyNSw2MTIuNDk4OCA1OTguODEyNSw2MTQuNTkyNSBRNTk4LjgxMjUsNjE2LjY4NjMgNTk5LjUsNjE3Ljc2NDQgUTYwMC4xODc1LDYxOC44MjY5IDYwMS41MzEzLDYxOC44MjY5IFE2MDIuMTU2Myw2MTguODI2OSA2MDIuNzUsNjE4LjU2MTMgUTYwMy4zNDM4LDYxOC4yOCA2MDMuOTY4OCw2MTcuNzAxOSBMNjAzLjk2ODgsNjIwLjQyMDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjQiIHg9IjYxNSIgeT0iNjE5LjYyNjciPkFic3RyYWN0RWFycGhvbmU8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTg3IiB4Mj0iNzQxIiB5MT0iNjMwLjc4IiB5Mj0iNjMwLjc4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTg3IiB4Mj0iNzQxIiB5MT0iNjM4Ljc4IiB5Mj0iNjM4Ljc4Ii8+PC9nPjwhLS1jbGFzcyBBcHBsZVBob25lLS0+PGcgaWQ9ImVsZW1fQXBwbGVQaG9uZSI+PHJlY3QgY29kZUxpbmU9IjMxIiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJBcHBsZVBob25lIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTYiIHg9IjE1NjAiIHk9IjcxNS45MyIvPjxlbGxpcHNlIGN4PSIxNTc1IiBjeT0iNzMxLjkzIiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTE1NzcuOTY4OCw3MzcuNTcwNiBRMTU3Ny4zOTA2LDczNy44Njc1IDE1NzYuNzUsNzM4LjAwODEgUTE1NzYuMTA5NCw3MzguMTY0NCAxNTc1LjQwNjMsNzM4LjE2NDQgUTE1NzIuOTA2Myw3MzguMTY0NCAxNTcxLjU3ODEsNzM2LjUyMzggUTE1NzAuMjY1Niw3MzQuODY3NSAxNTcwLjI2NTYsNzMxLjc0MjUgUTE1NzAuMjY1Niw3MjguNjE3NSAxNTcxLjU3ODEsNzI2Ljk2MTMgUTE1NzIuOTA2Myw3MjUuMzA1IDE1NzUuNDA2Myw3MjUuMzA1IFExNTc2LjEwOTQsNzI1LjMwNSAxNTc2Ljc1LDcyNS40NjEzIFExNTc3LjQwNjMsNzI1LjYxNzUgMTU3Ny45Njg4LDcyNS45MTQ0IEwxNTc3Ljk2ODgsNzI4LjYzMzEgUTE1NzcuMzQzOCw3MjguMDU1IDE1NzYuNzUsNzI3Ljc4OTQgUTE1NzYuMTU2Myw3MjcuNTA4MSAxNTc1LjUzMTMsNzI3LjUwODEgUTE1NzQuMTg3NSw3MjcuNTA4MSAxNTczLjUsNzI4LjU4NjMgUTE1NzIuODEyNSw3MjkuNjQ4OCAxNTcyLjgxMjUsNzMxLjc0MjUgUTE1NzIuODEyNSw3MzMuODM2MyAxNTczLjUsNzM0LjkxNDQgUTE1NzQuMTg3NSw3MzUuOTc2OSAxNTc1LjUzMTMsNzM1Ljk3NjkgUTE1NzYuMTU2Myw3MzUuOTc2OSAxNTc2Ljc1LDczNS43MTEzIFExNTc3LjM0MzgsNzM1LjQzIDE1NzcuOTY4OCw3MzQuODUxOSBMMTU3Ny45Njg4LDczNy41NzA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODQiIHg9IjE1ODkiIHk9IjczNi43NzY3Ij5BcHBsZVBob25lPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjE1NjEiIHgyPSIxNjc1IiB5MT0iNzQ3LjkzIiB5Mj0iNzQ3LjkzIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTU2MSIgeDI9IjE2NzUiIHkxPSI3NTUuOTMiIHkyPSI3NTUuOTMiLz48ZWxsaXBzZSBjeD0iMTU3MSIgY3k9Ijc2OS41Nzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc2IiB4PSIxNTgwIiB5PSI3NzIuOTI1MSI+dm9pZCBkZXNjKCk8L3RleHQ+PC9nPjwhLS1jbGFzcyBBYnN0cmFjdFBob25lLS0+PGcgaWQ9ImVsZW1fQWJzdHJhY3RQaG9uZSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0OCIgaWQ9IkFic3RyYWN0UGhvbmUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEzNCIgeD0iMTU1MSIgeT0iNTk4Ljc4Ii8+PGVsbGlwc2UgY3g9IjE1NjYiIGN5PSI2MTQuNzgiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMTU2OC45Njg4LDYyMC40MjA2IFExNTY4LjM5MDYsNjIwLjcxNzUgMTU2Ny43NSw2MjAuODU4MSBRMTU2Ny4xMDk0LDYyMS4wMTQ0IDE1NjYuNDA2Myw2MjEuMDE0NCBRMTU2My45MDYzLDYyMS4wMTQ0IDE1NjIuNTc4MSw2MTkuMzczOCBRMTU2MS4yNjU2LDYxNy43MTc1IDE1NjEuMjY1Niw2MTQuNTkyNSBRMTU2MS4yNjU2LDYxMS40Njc1IDE1NjIuNTc4MSw2MDkuODExMyBRMTU2My45MDYzLDYwOC4xNTUgMTU2Ni40MDYzLDYwOC4xNTUgUTE1NjcuMTA5NCw2MDguMTU1IDE1NjcuNzUsNjA4LjMxMTMgUTE1NjguNDA2Myw2MDguNDY3NSAxNTY4Ljk2ODgsNjA4Ljc2NDQgTDE1NjguOTY4OCw2MTEuNDgzMSBRMTU2OC4zNDM4LDYxMC45MDUgMTU2Ny43NSw2MTAuNjM5NCBRMTU2Ny4xNTYzLDYxMC4zNTgxIDE1NjYuNTMxMyw2MTAuMzU4MSBRMTU2NS4xODc1LDYxMC4zNTgxIDE1NjQuNSw2MTEuNDM2MyBRMTU2My44MTI1LDYxMi40OTg4IDE1NjMuODEyNSw2MTQuNTkyNSBRMTU2My44MTI1LDYxNi42ODYzIDE1NjQuNSw2MTcuNzY0NCBRMTU2NS4xODc1LDYxOC44MjY5IDE1NjYuNTMxMyw2MTguODI2OSBRMTU2Ny4xNTYzLDYxOC44MjY5IDE1NjcuNzUsNjE4LjU2MTMgUTE1NjguMzQzOCw2MTguMjggMTU2OC45Njg4LDYxNy43MDE5IEwxNTY4Ljk2ODgsNjIwLjQyMDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDIiIHg9IjE1ODAiIHk9IjYxOS42MjY3Ij5BYnN0cmFjdFBob25lPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjE1NTIiIHgyPSIxNjg0IiB5MT0iNjMwLjc4IiB5Mj0iNjMwLjc4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTU1MiIgeDI9IjE2ODQiIHkxPSI2MzguNzgiIHkyPSI2MzguNzgiLz48L2c+PCEtLWNsYXNzIEFwcGxlTGFwdG9wLS0+PGcgaWQ9ImVsZW1fQXBwbGVMYXB0b3AiPjxyZWN0IGNvZGVMaW5lPSIzNCIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iQXBwbGVMYXB0b3AiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExOCIgeD0iMTM4OSIgeT0iNzE1LjkzIi8+PGVsbGlwc2UgY3g9IjE0MDQiIGN5PSI3MzEuOTMiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMTQwNi45Njg4LDczNy41NzA2IFExNDA2LjM5MDYsNzM3Ljg2NzUgMTQwNS43NSw3MzguMDA4MSBRMTQwNS4xMDk0LDczOC4xNjQ0IDE0MDQuNDA2Myw3MzguMTY0NCBRMTQwMS45MDYzLDczOC4xNjQ0IDE0MDAuNTc4MSw3MzYuNTIzOCBRMTM5OS4yNjU2LDczNC44Njc1IDEzOTkuMjY1Niw3MzEuNzQyNSBRMTM5OS4yNjU2LDcyOC42MTc1IDE0MDAuNTc4MSw3MjYuOTYxMyBRMTQwMS45MDYzLDcyNS4zMDUgMTQwNC40MDYzLDcyNS4zMDUgUTE0MDUuMTA5NCw3MjUuMzA1IDE0MDUuNzUsNzI1LjQ2MTMgUTE0MDYuNDA2Myw3MjUuNjE3NSAxNDA2Ljk2ODgsNzI1LjkxNDQgTDE0MDYuOTY4OCw3MjguNjMzMSBRMTQwNi4zNDM4LDcyOC4wNTUgMTQwNS43NSw3MjcuNzg5NCBRMTQwNS4xNTYzLDcyNy41MDgxIDE0MDQuNTMxMyw3MjcuNTA4MSBRMTQwMy4xODc1LDcyNy41MDgxIDE0MDIuNSw3MjguNTg2MyBRMTQwMS44MTI1LDcyOS42NDg4IDE0MDEuODEyNSw3MzEuNzQyNSBRMTQwMS44MTI1LDczMy44MzYzIDE0MDIuNSw3MzQuOTE0NCBRMTQwMy4xODc1LDczNS45NzY5IDE0MDQuNTMxMyw3MzUuOTc2OSBRMTQwNS4xNTYzLDczNS45NzY5IDE0MDUuNzUsNzM1LjcxMTMgUTE0MDYuMzQzOCw3MzUuNDMgMTQwNi45Njg4LDczNC44NTE5IEwxNDA2Ljk2ODgsNzM3LjU3MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4NiIgeD0iMTQxOCIgeT0iNzM2Ljc3NjciPkFwcGxlTGFwdG9wPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjEzOTAiIHgyPSIxNTA2IiB5MT0iNzQ3LjkzIiB5Mj0iNzQ3LjkzIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTM5MCIgeDI9IjE1MDYiIHkxPSI3NTUuOTMiIHkyPSI3NTUuOTMiLz48ZWxsaXBzZSBjeD0iMTQwMCIgY3k9Ijc2OS41Nzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc2IiB4PSIxNDA5IiB5PSI3NzIuOTI1MSI+dm9pZCBkZXNjKCk8L3RleHQ+PC9nPjwhLS1jbGFzcyBBYnN0cmFjdExhcHRvcC0tPjxnIGlkPSJlbGVtX0Fic3RyYWN0TGFwdG9wIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjQ4IiBpZD0iQWJzdHJhY3RMYXB0b3AiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEzNiIgeD0iMTM4MCIgeT0iNTk4Ljc4Ii8+PGVsbGlwc2UgY3g9IjEzOTUiIGN5PSI2MTQuNzgiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMTM5Ny45Njg4LDYyMC40MjA2IFExMzk3LjM5MDYsNjIwLjcxNzUgMTM5Ni43NSw2MjAuODU4MSBRMTM5Ni4xMDk0LDYyMS4wMTQ0IDEzOTUuNDA2Myw2MjEuMDE0NCBRMTM5Mi45MDYzLDYyMS4wMTQ0IDEzOTEuNTc4MSw2MTkuMzczOCBRMTM5MC4yNjU2LDYxNy43MTc1IDEzOTAuMjY1Niw2MTQuNTkyNSBRMTM5MC4yNjU2LDYxMS40Njc1IDEzOTEuNTc4MSw2MDkuODExMyBRMTM5Mi45MDYzLDYwOC4xNTUgMTM5NS40MDYzLDYwOC4xNTUgUTEzOTYuMTA5NCw2MDguMTU1IDEzOTYuNzUsNjA4LjMxMTMgUTEzOTcuNDA2Myw2MDguNDY3NSAxMzk3Ljk2ODgsNjA4Ljc2NDQgTDEzOTcuOTY4OCw2MTEuNDgzMSBRMTM5Ny4zNDM4LDYxMC45MDUgMTM5Ni43NSw2MTAuNjM5NCBRMTM5Ni4xNTYzLDYxMC4zNTgxIDEzOTUuNTMxMyw2MTAuMzU4MSBRMTM5NC4xODc1LDYxMC4zNTgxIDEzOTMuNSw2MTEuNDM2MyBRMTM5Mi44MTI1LDYxMi40OTg4IDEzOTIuODEyNSw2MTQuNTkyNSBRMTM5Mi44MTI1LDYxNi42ODYzIDEzOTMuNSw2MTcuNzY0NCBRMTM5NC4xODc1LDYxOC44MjY5IDEzOTUuNTMxMyw2MTguODI2OSBRMTM5Ni4xNTYzLDYxOC44MjY5IDEzOTYuNzUsNjE4LjU2MTMgUTEzOTcuMzQzOCw2MTguMjggMTM5Ny45Njg4LDYxNy43MDE5IEwxMzk3Ljk2ODgsNjIwLjQyMDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDQiIHg9IjE0MDkiIHk9IjYxOS42MjY3Ij5BYnN0cmFjdExhcHRvcDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxMzgxIiB4Mj0iMTUxNSIgeTE9IjYzMC43OCIgeTI9IjYzMC43OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjEzODEiIHgyPSIxNTE1IiB5MT0iNjM4Ljc4IiB5Mj0iNjM4Ljc4Ii8+PC9nPjwhLS1jbGFzcyBBcHBsZUVhcnBob25lLS0+PGcgaWQ9ImVsZW1fQXBwbGVFYXJwaG9uZSI+PHJlY3QgY29kZUxpbmU9IjM3IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJBcHBsZUVhcnBob25lIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMzgiIHg9IjExOTgiIHk9IjcxNS45MyIvPjxlbGxpcHNlIGN4PSIxMjEzIiBjeT0iNzMxLjkzIiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTEyMTUuOTY4OCw3MzcuNTcwNiBRMTIxNS4zOTA2LDczNy44Njc1IDEyMTQuNzUsNzM4LjAwODEgUTEyMTQuMTA5NCw3MzguMTY0NCAxMjEzLjQwNjMsNzM4LjE2NDQgUTEyMTAuOTA2Myw3MzguMTY0NCAxMjA5LjU3ODEsNzM2LjUyMzggUTEyMDguMjY1Niw3MzQuODY3NSAxMjA4LjI2NTYsNzMxLjc0MjUgUTEyMDguMjY1Niw3MjguNjE3NSAxMjA5LjU3ODEsNzI2Ljk2MTMgUTEyMTAuOTA2Myw3MjUuMzA1IDEyMTMuNDA2Myw3MjUuMzA1IFExMjE0LjEwOTQsNzI1LjMwNSAxMjE0Ljc1LDcyNS40NjEzIFExMjE1LjQwNjMsNzI1LjYxNzUgMTIxNS45Njg4LDcyNS45MTQ0IEwxMjE1Ljk2ODgsNzI4LjYzMzEgUTEyMTUuMzQzOCw3MjguMDU1IDEyMTQuNzUsNzI3Ljc4OTQgUTEyMTQuMTU2Myw3MjcuNTA4MSAxMjEzLjUzMTMsNzI3LjUwODEgUTEyMTIuMTg3NSw3MjcuNTA4MSAxMjExLjUsNzI4LjU4NjMgUTEyMTAuODEyNSw3MjkuNjQ4OCAxMjEwLjgxMjUsNzMxLjc0MjUgUTEyMTAuODEyNSw3MzMuODM2MyAxMjExLjUsNzM0LjkxNDQgUTEyMTIuMTg3NSw3MzUuOTc2OSAxMjEzLjUzMTMsNzM1Ljk3NjkgUTEyMTQuMTU2Myw3MzUuOTc2OSAxMjE0Ljc1LDczNS43MTEzIFExMjE1LjM0MzgsNzM1LjQzIDEyMTUuOTY4OCw3MzQuODUxOSBMMTIxNS45Njg4LDczNy41NzA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA2IiB4PSIxMjI3IiB5PSI3MzYuNzc2NyI+QXBwbGVFYXJwaG9uZTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxMTk5IiB4Mj0iMTMzNSIgeTE9Ijc0Ny45MyIgeTI9Ijc0Ny45MyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjExOTkiIHgyPSIxMzM1IiB5MT0iNzU1LjkzIiB5Mj0iNzU1LjkzIi8+PGVsbGlwc2UgY3g9IjEyMDkiIGN5PSI3NjkuNTc4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NiIgeD0iMTIxOCIgeT0iNzcyLjkyNTEiPnZvaWQgZGVzYygpPC90ZXh0PjwvZz48IS0tY2xhc3MgQWJzdHJhY3RFYXJwaG9uZS0tPjxnIGlkPSJlbGVtX0Fic3RyYWN0RWFycGhvbmUiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDgiIGlkPSJBYnN0cmFjdEVhcnBob25lIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTYiIHg9IjExODkiIHk9IjU5OC43OCIvPjxlbGxpcHNlIGN4PSIxMjA0IiBjeT0iNjE0Ljc4IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTEyMDYuOTY4OCw2MjAuNDIwNiBRMTIwNi4zOTA2LDYyMC43MTc1IDEyMDUuNzUsNjIwLjg1ODEgUTEyMDUuMTA5NCw2MjEuMDE0NCAxMjA0LjQwNjMsNjIxLjAxNDQgUTEyMDEuOTA2Myw2MjEuMDE0NCAxMjAwLjU3ODEsNjE5LjM3MzggUTExOTkuMjY1Niw2MTcuNzE3NSAxMTk5LjI2NTYsNjE0LjU5MjUgUTExOTkuMjY1Niw2MTEuNDY3NSAxMjAwLjU3ODEsNjA5LjgxMTMgUTEyMDEuOTA2Myw2MDguMTU1IDEyMDQuNDA2Myw2MDguMTU1IFExMjA1LjEwOTQsNjA4LjE1NSAxMjA1Ljc1LDYwOC4zMTEzIFExMjA2LjQwNjMsNjA4LjQ2NzUgMTIwNi45Njg4LDYwOC43NjQ0IEwxMjA2Ljk2ODgsNjExLjQ4MzEgUTEyMDYuMzQzOCw2MTAuOTA1IDEyMDUuNzUsNjEwLjYzOTQgUTEyMDUuMTU2Myw2MTAuMzU4MSAxMjA0LjUzMTMsNjEwLjM1ODEgUTEyMDMuMTg3NSw2MTAuMzU4MSAxMjAyLjUsNjExLjQzNjMgUTEyMDEuODEyNSw2MTIuNDk4OCAxMjAxLjgxMjUsNjE0LjU5MjUgUTEyMDEuODEyNSw2MTYuNjg2MyAxMjAyLjUsNjE3Ljc2NDQgUTEyMDMuMTg3NSw2MTguODI2OSAxMjA0LjUzMTMsNjE4LjgyNjkgUTEyMDUuMTU2Myw2MTguODI2OSAxMjA1Ljc1LDYxOC41NjEzIFExMjA2LjM0MzgsNjE4LjI4IDEyMDYuOTY4OCw2MTcuNzAxOSBMMTIwNi45Njg4LDYyMC40MjA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI0IiB4PSIxMjE4IiB5PSI2MTkuNjI2NyI+QWJzdHJhY3RFYXJwaG9uZTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxMTkwIiB4Mj0iMTM0NCIgeTE9IjYzMC43OCIgeTI9IjYzMC43OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjExOTAiIHgyPSIxMzQ0IiB5MT0iNjM4Ljc4IiB5Mj0iNjM4Ljc4Ii8+PC9nPjwhLS1jbGFzcyBJRmFjdG9yeS0tPjxnIGlkPSJlbGVtX0lGYWN0b3J5Ij48cmVjdCBjb2RlTGluZT0iNDQiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iOTYuODkwNiIgaWQ9IklGYWN0b3J5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMDIiIHg9IjgwMyIgeT0iMTY5Ii8+PGVsbGlwc2UgY3g9Ijg3My4yNSIgY3k9IjE4NSIgZmlsbD0iI0I0QTdFNSIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik04NjkuMTcxOSwxODAuNzY1NiBMODY5LjE3MTksMTc4LjYwOTQgTDg3Ni41NjI1LDE3OC42MDk0IEw4NzYuNTYyNSwxODAuNzY1NiBMODc0LjA5MzgsMTgwLjc2NTYgTDg3NC4wOTM4LDE4OC44NDM4IEw4NzYuNTYyNSwxODguODQzOCBMODc2LjU2MjUsMTkxIEw4NjkuMTcxOSwxOTEgTDg2OS4xNzE5LDE4OC44NDM4IEw4NzEuNjQwNiwxODguODQzOCBMODcxLjY0MDYsMTgwLjc2NTYgTDg2OS4xNzE5LDE4MC43NjU2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1MyIgeD0iODkzLjc1IiB5PSIxODkuODQ2NyI+SUZhY3Rvcnk8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iODA0IiB4Mj0iMTAwNCIgeTE9IjIwMSIgeTI9IjIwMSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjgwNCIgeDI9IjEwMDQiIHkxPSIyMDkiIHkyPSIyMDkiLz48ZWxsaXBzZSBjeD0iODE0IiBjeT0iMjIyLjY0ODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU0IiB4PSI4MjMiIHk9IjIyNS45OTUxIj5JUHJvZHVjdCBtYWtlUGhvbmUoKTwvdGV4dD48ZWxsaXBzZSBjeD0iODE0IiBjeT0iMjM4Ljk0NTMiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU2IiB4PSI4MjMiIHk9IjI0Mi4yOTIiPklQcm9kdWN0IG1ha2VMYXB0b3AoKTwvdGV4dD48ZWxsaXBzZSBjeD0iODE0IiBjeT0iMjU1LjI0MjIiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc2IiB4PSI4MjMiIHk9IjI1OC41ODg5Ij5JUHJvZHVjdCBtYWtlRWFycGhvbmUoKTwvdGV4dD48L2c+PCEtLWNsYXNzIEh1YXdlaUZhY3RvcnktLT48ZyBpZD0iZWxlbV9IdWF3ZWlGYWN0b3J5Ij48cmVjdCBjb2RlTGluZT0iNDkiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iOTYuODkwNiIgaWQ9Ikh1YXdlaUZhY3RvcnkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjIwMiIgeD0iNjc5IiB5PSIzMjYuODkiLz48ZWxsaXBzZSBjeD0iNzI1Ljc1IiBjeT0iMzQyLjg5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTcyOC43MTg4LDM0OC41MzA2IFE3MjguMTQwNiwzNDguODI3NSA3MjcuNSwzNDguOTY4MSBRNzI2Ljg1OTQsMzQ5LjEyNDQgNzI2LjE1NjMsMzQ5LjEyNDQgUTcyMy42NTYzLDM0OS4xMjQ0IDcyMi4zMjgxLDM0Ny40ODM4IFE3MjEuMDE1NiwzNDUuODI3NSA3MjEuMDE1NiwzNDIuNzAyNSBRNzIxLjAxNTYsMzM5LjU3NzUgNzIyLjMyODEsMzM3LjkyMTMgUTcyMy42NTYzLDMzNi4yNjUgNzI2LjE1NjMsMzM2LjI2NSBRNzI2Ljg1OTQsMzM2LjI2NSA3MjcuNSwzMzYuNDIxMyBRNzI4LjE1NjMsMzM2LjU3NzUgNzI4LjcxODgsMzM2Ljg3NDQgTDcyOC43MTg4LDMzOS41OTMxIFE3MjguMDkzOCwzMzkuMDE1IDcyNy41LDMzOC43NDk0IFE3MjYuOTA2MywzMzguNDY4MSA3MjYuMjgxMywzMzguNDY4MSBRNzI0LjkzNzUsMzM4LjQ2ODEgNzI0LjI1LDMzOS41NDYzIFE3MjMuNTYyNSwzNDAuNjA4OCA3MjMuNTYyNSwzNDIuNzAyNSBRNzIzLjU2MjUsMzQ0Ljc5NjMgNzI0LjI1LDM0NS44NzQ0IFE3MjQuOTM3NSwzNDYuOTM2OSA3MjYuMjgxMywzNDYuOTM2OSBRNzI2LjkwNjMsMzQ2LjkzNjkgNzI3LjUsMzQ2LjY3MTMgUTcyOC4wOTM4LDM0Ni4zOSA3MjguNzE4OCwzNDUuODExOSBMNzI4LjcxODgsMzQ4LjUzMDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDAiIHg9Ijc0Ni4yNSIgeT0iMzQ3LjczNjciPkh1YXdlaUZhY3Rvcnk8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNjgwIiB4Mj0iODgwIiB5MT0iMzU4Ljg5IiB5Mj0iMzU4Ljg5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNjgwIiB4Mj0iODgwIiB5MT0iMzY2Ljg5IiB5Mj0iMzY2Ljg5Ii8+PGVsbGlwc2UgY3g9IjY5MCIgY3k9IjM4MC41Mzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1NCIgeD0iNjk5IiB5PSIzODMuODg1MSI+SVByb2R1Y3QgbWFrZVBob25lKCk8L3RleHQ+PGVsbGlwc2UgY3g9IjY5MCIgY3k9IjM5Ni44MzUzIiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1NiIgeD0iNjk5IiB5PSI0MDAuMTgyIj5JUHJvZHVjdCBtYWtlTGFwdG9wKCk8L3RleHQ+PGVsbGlwc2UgY3g9IjY5MCIgY3k9IjQxMy4xMzIyIiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE3NiIgeD0iNjk5IiB5PSI0MTYuNDc4OSI+SVByb2R1Y3QgbWFrZUVhcnBob25lKCk8L3RleHQ+PC9nPjwhLS1jbGFzcyBBcHBsZUZhY3RvcnktLT48ZyBpZD0iZWxlbV9BcHBsZUZhY3RvcnkiPjxyZWN0IGNvZGVMaW5lPSI1NCIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI5Ni44OTA2IiBpZD0iQXBwbGVGYWN0b3J5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMDIiIHg9IjkxNiIgeT0iMzI2Ljg5Ii8+PGVsbGlwc2UgY3g9Ijk2OC4yNSIgY3k9IjM0Mi44OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik05NzEuMjE4OCwzNDguNTMwNiBROTcwLjY0MDYsMzQ4LjgyNzUgOTcwLDM0OC45NjgxIFE5NjkuMzU5NCwzNDkuMTI0NCA5NjguNjU2MywzNDkuMTI0NCBROTY2LjE1NjMsMzQ5LjEyNDQgOTY0LjgyODEsMzQ3LjQ4MzggUTk2My41MTU2LDM0NS44Mjc1IDk2My41MTU2LDM0Mi43MDI1IFE5NjMuNTE1NiwzMzkuNTc3NSA5NjQuODI4MSwzMzcuOTIxMyBROTY2LjE1NjMsMzM2LjI2NSA5NjguNjU2MywzMzYuMjY1IFE5NjkuMzU5NCwzMzYuMjY1IDk3MCwzMzYuNDIxMyBROTcwLjY1NjMsMzM2LjU3NzUgOTcxLjIxODgsMzM2Ljg3NDQgTDk3MS4yMTg4LDMzOS41OTMxIFE5NzAuNTkzOCwzMzkuMDE1IDk3MCwzMzguNzQ5NCBROTY5LjQwNjMsMzM4LjQ2ODEgOTY4Ljc4MTMsMzM4LjQ2ODEgUTk2Ny40Mzc1LDMzOC40NjgxIDk2Ni43NSwzMzkuNTQ2MyBROTY2LjA2MjUsMzQwLjYwODggOTY2LjA2MjUsMzQyLjcwMjUgUTk2Ni4wNjI1LDM0NC43OTYzIDk2Ni43NSwzNDUuODc0NCBROTY3LjQzNzUsMzQ2LjkzNjkgOTY4Ljc4MTMsMzQ2LjkzNjkgUTk2OS40MDYzLDM0Ni45MzY5IDk3MCwzNDYuNjcxMyBROTcwLjU5MzgsMzQ2LjM5IDk3MS4yMTg4LDM0NS44MTE5IEw5NzEuMjE4OCwzNDguNTMwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg5IiB4PSI5ODguNzUiIHk9IjM0Ny43MzY3Ij5BcHBsZUZhY3Rvcnk8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOTE3IiB4Mj0iMTExNyIgeTE9IjM1OC44OSIgeTI9IjM1OC44OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjkxNyIgeDI9IjExMTciIHkxPSIzNjYuODkiIHkyPSIzNjYuODkiLz48ZWxsaXBzZSBjeD0iOTI3IiBjeT0iMzgwLjUzODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU0IiB4PSI5MzYiIHk9IjM4My44ODUxIj5JUHJvZHVjdCBtYWtlUGhvbmUoKTwvdGV4dD48ZWxsaXBzZSBjeD0iOTI3IiBjeT0iMzk2LjgzNTMiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU2IiB4PSI5MzYiIHk9IjQwMC4xODIiPklQcm9kdWN0IG1ha2VMYXB0b3AoKTwvdGV4dD48ZWxsaXBzZSBjeD0iOTI3IiBjeT0iNDEzLjEzMjIiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc2IiB4PSI5MzYiIHk9IjQxNi40Nzg5Ij5JUHJvZHVjdCBtYWtlRWFycGhvbmUoKTwvdGV4dD48L2c+PCEtLWNsYXNzIEFic3RyYWN0RmFjdG9yeU1haW4tLT48ZyBpZD0iZWxlbV9BYnN0cmFjdEZhY3RvcnlNYWluIj48cmVjdCBjb2RlTGluZT0iNjEiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDgiIGlkPSJBYnN0cmFjdEZhY3RvcnlNYWluIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNzEiIHg9IjU2OS41IiB5PSI3Ii8+PGVsbGlwc2UgY3g9IjU4NC41IiBjeT0iMjMiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNNTg3LjQ2ODgsMjguNjQwNiBRNTg2Ljg5MDYsMjguOTM3NSA1ODYuMjUsMjkuMDc4MSBRNTg1LjYwOTQsMjkuMjM0NCA1ODQuOTA2MywyOS4yMzQ0IFE1ODIuNDA2MywyOS4yMzQ0IDU4MS4wNzgxLDI3LjU5MzggUTU3OS43NjU2LDI1LjkzNzUgNTc5Ljc2NTYsMjIuODEyNSBRNTc5Ljc2NTYsMTkuNjg3NSA1ODEuMDc4MSwxOC4wMzEzIFE1ODIuNDA2MywxNi4zNzUgNTg0LjkwNjMsMTYuMzc1IFE1ODUuNjA5NCwxNi4zNzUgNTg2LjI1LDE2LjUzMTMgUTU4Ni45MDYzLDE2LjY4NzUgNTg3LjQ2ODgsMTYuOTg0NCBMNTg3LjQ2ODgsMTkuNzAzMSBRNTg2Ljg0MzgsMTkuMTI1IDU4Ni4yNSwxOC44NTk0IFE1ODUuNjU2MywxOC41NzgxIDU4NS4wMzEzLDE4LjU3ODEgUTU4My42ODc1LDE4LjU3ODEgNTgzLDE5LjY1NjMgUTU4Mi4zMTI1LDIwLjcxODggNTgyLjMxMjUsMjIuODEyNSBRNTgyLjMxMjUsMjQuOTA2MyA1ODMsMjUuOTg0NCBRNTgzLjY4NzUsMjcuMDQ2OSA1ODUuMDMxMywyNy4wNDY5IFE1ODUuNjU2MywyNy4wNDY5IDU4Ni4yNSwyNi43ODEzIFE1ODYuODQzOCwyNi41IDU4Ny40Njg4LDI1LjkyMTkgTDU4Ny40Njg4LDI4LjY0MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzkiIHg9IjU5OC41IiB5PSIyNy44NDY3Ij5BYnN0cmFjdEZhY3RvcnlNYWluPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjU3MC41IiB4Mj0iNzM5LjUiIHkxPSIzOSIgeTI9IjM5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTcwLjUiIHgyPSI3MzkuNSIgeTE9IjQ3IiB5Mj0iNDciLz48L2c+PCEtLXJldmVyc2UgbGluayBJUHJvZHVjdCB0byBBYnN0cmFjdFBob25lLS0+PGcgaWQ9ImxpbmtfSVByb2R1Y3RfQWJzdHJhY3RQaG9uZSI+PHBhdGggZD0iTTI4MSw2NzMuMjIgQzI4MSw2OTEuNzcgMjgxLDY5Ny4xNyAyODEsNzE1LjcxICIgZmlsbD0ibm9uZSIgaWQ9IklQcm9kdWN0LWJhY2t0by1BYnN0cmFjdFBob25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSIyODEsNjU1LjIyLDI3NSw2NzMuMjIsMjg3LDY3My4yMiwyODEsNjU1LjIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48L2c+PCEtLXJldmVyc2UgbGluayBJUHJvZHVjdCB0byBBYnN0cmFjdExhcHRvcC0tPjxnIGlkPSJsaW5rX0lQcm9kdWN0X0Fic3RyYWN0TGFwdG9wIj48cGF0aCBkPSJNMzM4LjkxMTEsNjY1Ljc4OCBDMzY0LjM5MTEsNjg0LjI2OCAzODEuOTMsNjk2Ljk5IDQwNy40NSw3MTUuNDkgIiBmaWxsPSJub25lIiBpZD0iSVByb2R1Y3QtYmFja3RvLUFic3RyYWN0TGFwdG9wIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSIzMjQuMzQsNjU1LjIyLDMzNS4zODg0LDY3MC42NDUxLDM0Mi40MzM4LDY2MC45MzEsMzI0LjM0LDY1NS4yMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1yZXZlcnNlIGxpbmsgSVByb2R1Y3QgdG8gQWJzdHJhY3RFYXJwaG9uZS0tPjxnIGlkPSJsaW5rX0lQcm9kdWN0X0Fic3RyYWN0RWFycGhvbmUiPjxwYXRoIGQ9Ik0yMjAuMjYxNCw2NjUuMzk0NCBDMTkzLjI5MTQsNjgzLjg3NDQgMTc0LjEzLDY5Ni45OSAxNDcuMTIsNzE1LjQ5ICIgZmlsbD0ibm9uZSIgaWQ9IklQcm9kdWN0LWJhY2t0by1BYnN0cmFjdEVhcnBob25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSIyMzUuMTEsNjU1LjIyLDIxNi44Njk5LDY2MC40NDQ4LDIyMy42NTI4LDY3MC4zNDM5LDIzNS4xMSw2NTUuMjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIEFic3RyYWN0UGhvbmUgdG8gSHVhd2VpUGhvbmUtLT48ZyBpZD0ibGlua19BYnN0cmFjdFBob25lX0h1YXdlaVBob25lIj48cGF0aCBkPSJNMTAxNSw2NjUuMjcgQzEwMTUsNjg0LjY5IDEwMTUsNjk0LjQ1IDEwMTUsNzE1Ljc2ICIgZmlsbD0ibm9uZSIgaWQ9IkFic3RyYWN0UGhvbmUtYmFja3RvLUh1YXdlaVBob25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjEwMTUsNjQ3LjI3LDEwMDksNjY1LjI3LDEwMjEsNjY1LjI3LDEwMTUsNjQ3LjI3IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48L2c+PCEtLXJldmVyc2UgbGluayBBYnN0cmFjdExhcHRvcCB0byBIdWF3ZWlMYXB0b3AtLT48ZyBpZD0ibGlua19BYnN0cmFjdExhcHRvcF9IdWF3ZWlMYXB0b3AiPjxwYXRoIGQ9Ik04NDUsNjY1LjI3IEM4NDUsNjg0LjY5IDg0NSw2OTQuNDUgODQ1LDcxNS43NiAiIGZpbGw9Im5vbmUiIGlkPSJBYnN0cmFjdExhcHRvcC1iYWNrdG8tSHVhd2VpTGFwdG9wIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9Ijg0NSw2NDcuMjcsODM5LDY2NS4yNyw4NTEsNjY1LjI3LDg0NSw2NDcuMjciIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIEFic3RyYWN0RWFycGhvbmUgdG8gSHVhd2VpRWFycGhvbmUtLT48ZyBpZD0ibGlua19BYnN0cmFjdEVhcnBob25lX0h1YXdlaUVhcnBob25lIj48cGF0aCBkPSJNNjY0LDY2NS4yNyBDNjY0LDY4NC42OSA2NjQsNjk0LjQ1IDY2NCw3MTUuNzYgIiBmaWxsPSJub25lIiBpZD0iQWJzdHJhY3RFYXJwaG9uZS1iYWNrdG8tSHVhd2VpRWFycGhvbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iNjY0LDY0Ny4yNyw2NTgsNjY1LjI3LDY3MCw2NjUuMjcsNjY0LDY0Ny4yNyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1yZXZlcnNlIGxpbmsgQWJzdHJhY3RQaG9uZSB0byBBcHBsZVBob25lLS0+PGcgaWQ9ImxpbmtfQWJzdHJhY3RQaG9uZV9BcHBsZVBob25lIj48cGF0aCBkPSJNMTYxOCw2NjUuMjcgQzE2MTgsNjg0LjY5IDE2MTgsNjk0LjQ1IDE2MTgsNzE1Ljc2ICIgZmlsbD0ibm9uZSIgaWQ9IkFic3RyYWN0UGhvbmUtYmFja3RvLUFwcGxlUGhvbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iMTYxOCw2NDcuMjcsMTYxMiw2NjUuMjcsMTYyNCw2NjUuMjcsMTYxOCw2NDcuMjciIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIEFic3RyYWN0TGFwdG9wIHRvIEFwcGxlTGFwdG9wLS0+PGcgaWQ9ImxpbmtfQWJzdHJhY3RMYXB0b3BfQXBwbGVMYXB0b3AiPjxwYXRoIGQ9Ik0xNDQ4LDY2NS4yNyBDMTQ0OCw2ODQuNjkgMTQ0OCw2OTQuNDUgMTQ0OCw3MTUuNzYgIiBmaWxsPSJub25lIiBpZD0iQWJzdHJhY3RMYXB0b3AtYmFja3RvLUFwcGxlTGFwdG9wIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjE0NDgsNjQ3LjI3LDE0NDIsNjY1LjI3LDE0NTQsNjY1LjI3LDE0NDgsNjQ3LjI3IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48L2c+PCEtLXJldmVyc2UgbGluayBBYnN0cmFjdEVhcnBob25lIHRvIEFwcGxlRWFycGhvbmUtLT48ZyBpZD0ibGlua19BYnN0cmFjdEVhcnBob25lX0FwcGxlRWFycGhvbmUiPjxwYXRoIGQ9Ik0xMjY3LDY2NS4yNyBDMTI2Nyw2ODQuNjkgMTI2Nyw2OTQuNDUgMTI2Nyw3MTUuNzYgIiBmaWxsPSJub25lIiBpZD0iQWJzdHJhY3RFYXJwaG9uZS1iYWNrdG8tQXBwbGVFYXJwaG9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSIxMjY3LDY0Ny4yNywxMjYxLDY2NS4yNywxMjczLDY2NS4yNywxMjY3LDY0Ny4yNyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1yZXZlcnNlIGxpbmsgSUZhY3RvcnkgdG8gSHVhd2VpRmFjdG9yeS0tPjxnIGlkPSJsaW5rX0lGYWN0b3J5X0h1YXdlaUZhY3RvcnkiPjxwYXRoIGQ9Ik04NTQuOTE1LDI4MC4xNTcxIEM4MzkuNjc1LDI5OS4zMTcxIDgzMy4zMywzMDcuMjkgODE4LjA3LDMyNi40NyAiIGZpbGw9Im5vbmUiIGlkPSJJRmFjdG9yeS1iYWNrdG8tSHVhd2VpRmFjdG9yeSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo3LjAsNy4wOyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iODY2LjEyLDI2Ni4wNyw4NTAuMjE5MywyNzYuNDIyMSw4NTkuNjEwNywyODMuODkyMSw4NjYuMTIsMjY2LjA3IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48L2c+PCEtLXJldmVyc2UgbGluayBJRmFjdG9yeSB0byBBcHBsZUZhY3RvcnktLT48ZyBpZD0ibGlua19JRmFjdG9yeV9BcHBsZUZhY3RvcnkiPjxwYXRoIGQ9Ik05NDkuMDg0OSwyODAuNjQzMyBDOTYyLjk3NDksMjk5LjgwMzMgOTY4LjQsMzA3LjI5IDk4Mi4zLDMyNi40NyAiIGZpbGw9Im5vbmUiIGlkPSJJRmFjdG9yeS1iYWNrdG8tQXBwbGVGYWN0b3J5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSI5MzguNTIsMjY2LjA3LDk0NC4yMjcxLDI4NC4xNjUsOTUzLjk0MjcsMjc3LjEyMTcsOTM4LjUyLDI2Ni4wNyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1saW5rIEh1YXdlaUZhY3RvcnkgdG8gSHVhd2VpLS0+PGcgaWQ9ImxpbmtfSHVhd2VpRmFjdG9yeV9IdWF3ZWkiPjxwYXRoIGNvZGVMaW5lPSI2NCIgZD0iTTY3OC43Niw0MTEuODMgQzYzOC43Niw0MzAuOTEgNTk2LjE4LDQ1OC41NSA1NzAsNDk2Ljc4IEM1NjIuMTg3NSw1MDguMTkgNTU3LjA2OTQsNTIxLjU1NSA1NTMuNzkyNyw1MzUuMjIxNyBDNTUyLjE1NDMsNTQyLjA1NTEgNTUxLjcwMDcsNTQzLjAwNzggNTUwLjg3NjQsNTQ5Ljc4NTMgIiBmaWxsPSJub25lIiBpZD0iSHVhd2VpRmFjdG9yeS10by1IdWF3ZWkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU1MC4xNTIsNTU1Ljc0MTQsNTU1LjIwOTMsNTQ3LjI5MDIsNTUwLjc1NTcsNTUwLjc3OCw1NDcuMjY3OCw1NDYuMzI0Myw1NTAuMTUyLDU1NS43NDE0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MSIgeD0iNTkxIiB5PSI0ODQuODQ2OSI+Y3JlYXRlPC90ZXh0PjwvZz48IS0tbGluayBBcHBsZUZhY3RvcnkgdG8gQXBwbGUtLT48ZyBpZD0ibGlua19BcHBsZUZhY3RvcnlfQXBwbGUiPjxwYXRoIGNvZGVMaW5lPSI2NSIgZD0iTTEwNTEuODUsNDI0LjA4IEMxMDY2Ljk0LDQ0NS43MyAxMDg0LjI0LDQ3MiAxMDk4LDQ5Ni43OCBDMTExMi41NCw1MjIuOTggMTEyNi4zMzI1LDU1My42NzI1IDExMzYuNTkxMyw1NzguMDg3NSBDMTEzOS4xNTU5LDU4NC4xOTEzIDExNDEuNDk5OCw1ODkuOTAyNyAxMTQzLjU3OTIsNTk1LjA1MzQgQzExNDQuMDk5MSw1OTYuMzQxMSAxMTQ0LjYwMjQsNTk3LjU5MzggMTE0NS4wODg1LDU5OC44MDg4IEMxMTQ1LjMzMTYsNTk5LjQxNjMgMTE0NS41NzAzLDYwMC4wMTQzIDExNDUuODA0Nyw2MDAuNjAyNyBDMTE0NS44NjMzLDYwMC43NDk4IDExNDMuNzAzMiw1OTUuMzIxNCAxMTQzLjc2MTIsNTk1LjQ2NzMgIiBmaWxsPSJub25lIiBpZD0iQXBwbGVGYWN0b3J5LXRvLUFwcGxlIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMTQ1Ljk3OTcsNjAxLjA0MjEsMTE0Ni4zNjg1LDU5MS4yMDA5LDExNDQuMTMwOSw1OTYuMzk2NCwxMTM4LjkzNTQsNTk0LjE1ODksMTE0NS45Nzk3LDYwMS4wNDIxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MSIgeD0iMTA5MyIgeT0iNDg0Ljg0NjkiPmNyZWF0ZTwvdGV4dD48L2c+PCEtLWxpbmsgQWJzdHJhY3RGYWN0b3J5TWFpbiB0byBGYWN0b3J5LS0+PGcgaWQ9ImxpbmtfQWJzdHJhY3RGYWN0b3J5TWFpbl9GYWN0b3J5Ij48cGF0aCBjb2RlTGluZT0iNjYiIGQ9Ik02NTUsNTUuMzYgQzY1NSw2Ny41NzUgNjU1LDgzLjUzMzggNjU1LDEwMC42NTM5IEM2NTUsMTA0LjkzMzkgNjU1LDEwOS4yODY2IDY1NSwxMTMuNjcxNCBDNjU1LDExNS44NjM5IDY1NSwxMTguMDY0NCA2NTUsMTIwLjI2NzkgQzY1NSwxMjEuMzY5NiA2NTUsMTIyLjQ3MjEgNjU1LDEyMy41NzQ4IEM2NTUsMTI0LjEyNjEgNjU1LDExOC42Nzc0IDY1NSwxMTkuMjI4NyAiIGZpbGw9Im5vbmUiIGlkPSJBYnN0cmFjdEZhY3RvcnlNYWluLXRvLUZhY3RvcnkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjY1NSwxMjUuMjI4Nyw2NTksMTE2LjIyODcsNjU1LDEyMC4yMjg3LDY1MSwxMTYuMjI4Nyw2NTUsMTI1LjIyODciIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIzIiB4PSI2NTYiIHk9Ijk4LjA2NjkiPnVzZTwvdGV4dD48L2c+PCEtLVNSQz1bcExKUklpR200N3RGTC1IREhNcFZvckJPMXFMMU9WNEZuZEppYmN0SWFBSFVNRmhsZmNkSTZ2S0xoTVhVS1o4ZGZzVkVwRUhpUnVwS0lIcEI0ZUlmVUhjbllpVWkxQXNsaVc5bzFQbUcyVW0wRVRBVGdoQVE2UmhQRjI4cDhGOElxdkdVMlJNaDQwUkxDcDJhVG03TTFUZnJJTC1nOGdDUFFkUC11S3VSdVpQdXFhUTFuTXh6bnN2VjJRRzVib0xvNTRPbGludDNsTVExVTk3dDdnSWZ2MnlHTnVFSUZ6VmlqYzNwUkdzbE0yb3d0MnZONzBfZ3hDOHRXb0JKQ25FNzZ5aWI2OUFRaXRncHZoSi0gLUZreWxMVHB2WnhtVFV3UFByamZ0SnpYY1NFaXhQV1pOVHltSHhra055cW1vM1VNZXJCbGZtT3ZtQ1BqdEZTc1hxRGR2a1hOaXQyTl8tVm5hQ1BhbWlPRDRtSUNQLWlGSFJjWV8wakRqZlBVYWt5OGgtMDEyYzVMc0YzS20yWEFteEVJS0FPRzM5OTlEWXNXY3c0WGxhM1RtaUFMWERPUW9HUzBdLS0+PC9nPjwvc3ZnPg=='><h1 id="2-code-example"><a class="markdownIt-Anchor" href="#2-code-example"></a> 2. Code Example</h1><h2 id="21-abstract-products-and-concrete-products"><a class="markdownIt-Anchor" href="#21-abstract-products-and-concrete-products"></a> 2.1. Abstract Products and Concrete Products</h2><p>Abstract product interfaces and product abstract classes:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Abstract Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Product description</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Phone Abstract Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractPhone</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Laptop Abstract Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractLaptop</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Earphone Abstract Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractEarphone</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Concrete product implementations for the <strong>Huawei</strong> family:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Huawei Concrete Earphone Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HuaweiPhone</span> <span class="keyword">extends</span> <span class="title class_">AbstractPhone</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am Huawei phone.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Huawei Concrete Laptop Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HuaweiLaptop</span> <span class="keyword">extends</span> <span class="title class_">AbstractLaptop</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am Huawei laptop.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Huawei Concrete Earphone Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HuaweiEarphone</span> <span class="keyword">extends</span> <span class="title class_">AbstractEarphone</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am Huawei earphone.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Concrete product implementations for the <strong>Apple</strong> family:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Apple Concrete Phone Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplePhone</span> <span class="keyword">extends</span> <span class="title class_">AbstractPhone</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am Apple phone.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apple Concrete Laptop Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppleLaptop</span> <span class="keyword">extends</span> <span class="title class_">AbstractLaptop</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am Apple laptop.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Apple Concrete Earphone Product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppleEarphone</span> <span class="keyword">extends</span> <span class="title class_">AbstractEarphone</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am Apple earphone.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="22-abstract-factory-and-concrete-factory"><a class="markdownIt-Anchor" href="#22-abstract-factory-and-concrete-factory"></a> 2.2. Abstract Factory and Concrete Factory</h2><p>Abstract factory interface:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Abstract Factory: create different products</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    IProduct <span class="title function_">makePhone</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    IProduct <span class="title function_">makeLaptop</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    IProduct <span class="title function_">makeEarphone</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Huawei concrete factory implementation subclass: This class implements the creation of Huawei product family items.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Huawei Concrete Factory</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HuaweiFactory</span> <span class="keyword">implements</span> <span class="title class_">IFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">HuaweiFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Create Huawei factory.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * produce Huawei phones</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">makePhone</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Make Huawei phone...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HuaweiPhone</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * produce Huawei laptops</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">makeLaptop</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Make Huawei laptop...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HuaweiLaptop</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * produce Huawei earphones</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">makeEarphone</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Make Huawei earphone...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HuaweiEarphone</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Apple concrete factory implementation subclass: This class implements the creation of Apple product family items.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Apple Concrete Factory</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppleFactory</span> <span class="keyword">implements</span> <span class="title class_">IFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AppleFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Create Apple factory.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * produce Apple phones</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">makePhone</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Make Apple phone...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApplePhone</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * produce Apple laptops</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">makeLaptop</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Make Apple laptop...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AppleLaptop</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * produce Apple earphones</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">makeEarphone</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Make Apple earphone...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AppleEarphone</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="23-usage-example"><a class="markdownIt-Anchor" href="#23-usage-example"></a> 2.3. Usage Example</h2><p>Example code for using the Abstract Factory pattern:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AbstractFactoryMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// Create a Huawei factory to produce concrete products.</span></span><br><span class="line">        <span class="type">IFactory</span> <span class="variable">huaweiFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HuaweiFactory</span>();</span><br><span class="line">        <span class="comment">// Create a phone through the Huawei factory.</span></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">huaweiPhone</span> <span class="operator">=</span> huaweiFactory.makePhone();</span><br><span class="line">        huaweiPhone.desc();</span><br><span class="line">        <span class="comment">// Create a laptop through the Huawei factory.</span></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">huaweiLaptop</span> <span class="operator">=</span> huaweiFactory.makeLaptop();</span><br><span class="line">        huaweiLaptop.desc();</span><br><span class="line">        <span class="comment">// Create an earphone through the Huawei factory.</span></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">huaweiEarphone</span> <span class="operator">=</span> huaweiFactory.makeEarphone();</span><br><span class="line">        huaweiEarphone.desc();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;-----------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create a Apple factory to produce concrete products.</span></span><br><span class="line">        <span class="type">IFactory</span> <span class="variable">appleFactory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AppleFactory</span>();</span><br><span class="line">        <span class="comment">// Create a phone through the Apple factory.</span></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">applePhone</span> <span class="operator">=</span> appleFactory.makePhone();</span><br><span class="line">        applePhone.desc();</span><br><span class="line">        <span class="comment">// Create a laptop through the Apple factory.</span></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">appleLaptop</span> <span class="operator">=</span> appleFactory.makeLaptop();</span><br><span class="line">        appleLaptop.desc();</span><br><span class="line">        <span class="comment">// Create an earphone through the Apple factory.</span></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">appleEarphone</span> <span class="operator">=</span> appleFactory.makeEarphone();</span><br><span class="line">        appleEarphone.desc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Execution result:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Create Huawei factory.</span><br><span class="line">Make Huawei phone...</span><br><span class="line">I am Huawei phone.</span><br><span class="line">Make Huawei laptop...</span><br><span class="line">I am Huawei laptop.</span><br><span class="line">Make Huawei earphone...</span><br><span class="line">I am Huawei earphone.</span><br><span class="line">-----------------</span><br><span class="line">Create Apple factory.</span><br><span class="line">Make Apple phone...</span><br><span class="line">I am Apple phone.</span><br><span class="line">Make Apple laptop...</span><br><span class="line">I am Apple laptop.</span><br><span class="line">Make Huawei earphone...</span><br><span class="line">I am Huawei earphone.</span><br></pre></td></tr></table></figure><h1 id="3-application-in-source-code"><a class="markdownIt-Anchor" href="#3-application-in-source-code"></a> 3. Application in Source Code</h1><h2 id="31-jdk-javaxxmltransformtransformerfactory"><a class="markdownIt-Anchor" href="#31-jdk-javaxxmltransformtransformerfactory"></a> 3.1. JDK - javax.xml.transform.TransformerFactory</h2><p><code>TransformerFactory</code> as an abstract factory defines two abstract methods for creating different objects: <code>Transformer newTransformer()</code> and <code>Templates newTemplates()</code>. Its concrete implementation classes, <code>TransformerFactoryImpl</code> and <code>SmartTransformerFactoryImpl</code>, override and implement these methods to create the corresponding objects.</p><img class="kroki" src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXMtYXNjaWkiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIzOTJweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjcyNXB4O2hlaWdodDozOTJweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA3MjUgMzkyIiB3aWR0aD0iNzI1cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48IS0tY2xhc3MgVHJhbnNmb3JtZXJGYWN0b3J5LS0+PGcgaWQ9ImVsZW1fVHJhbnNmb3JtZXJGYWN0b3J5Ij48cmVjdCBjb2RlTGluZT0iMyIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMTMuMTg3NSIgaWQ9IlRyYW5zZm9ybWVyRmFjdG9yeSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMzM4IiB4PSIxOTMiIHk9IjciLz48ZWxsaXBzZSBjeD0iMjkwLjc1IiBjeT0iMjMiIGZpbGw9IiNBOURDREYiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMjkwLjg1OTQsMTguMzQzOCBMMjg5LjcwMzEsMjMuNDIxOSBMMjkyLjAzMTMsMjMuNDIxOSBMMjkwLjg1OTQsMTguMzQzOCBaIE0yODkuMzc1LDE2LjEwOTQgTDI5Mi4zNTk0LDE2LjEwOTQgTDI5NS43MTg4LDI4LjUgTDI5My4yNjU2LDI4LjUgTDI5Mi41LDI1LjQzNzUgTDI4OS4yMTg4LDI1LjQzNzUgTDI4OC40Njg4LDI4LjUgTDI4Ni4wMzEzLDI4LjUgTDI4OS4zNzUsMTYuMTA5NCBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXN0eWxlPSJpdGFsaWMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM0IiB4PSIzMTEuMjUiIHk9IjI3Ljg0NjciPlRyYW5zZm9ybWVyRmFjdG9yeTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxOTQiIHgyPSI1MzAiIHkxPSIzOSIgeTI9IjM5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTk0IiB4Mj0iNTMwIiB5MT0iNDciIHkyPSI0NyIvPjxlbGxpcHNlIGN4PSIyMDQiIGN5PSI2MC42NDg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHQtZGVjb3JhdGlvbj0idW5kZXJsaW5lIiB0ZXh0TGVuZ3RoPSIyMzYiIHg9IjIxMyIgeT0iNjMuOTk1MSI+VHJhbnNmb3JtZXJGYWN0b3J5IG5ld0luc3RhbmNlKCk8L3RleHQ+PGVsbGlwc2UgY3g9IjIwNCIgY3k9Ijc2Ljk0NTMiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMTIiIHg9IjIxMyIgeT0iODAuMjkyIj5UcmFuc2Zvcm1lciBuZXdUcmFuc2Zvcm1lcihTb3VyY2Ugc291cmNlKTwvdGV4dD48ZWxsaXBzZSBjeD0iMjA0IiBjeT0iOTMuMjQyMiIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC1zdHlsZT0iaXRhbGljIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIxMSIgeD0iMjEzIiB5PSI5Ni41ODg5Ij5UcmFuc2Zvcm1lciBuZXdUcmFuc2Zvcm1lcigpPC90ZXh0PjxlbGxpcHNlIGN4PSIyMDQiIGN5PSIxMDkuNTM5MSIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC1zdHlsZT0iaXRhbGljIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI5MCIgeD0iMjEzIiB5PSIxMTIuODg1NyI+VGVtcGxhdGVzIG5ld1RlbXBsYXRlcyhTb3VyY2Ugc291cmNlKTwvdGV4dD48L2c+PCEtLWNsYXNzIFNBWFRyYW5zZm9ybWVyRmFjdG9yeS0tPjxnIGlkPSJlbGVtX1NBWFRyYW5zZm9ybWVyRmFjdG9yeSI+PHJlY3QgY29kZUxpbmU9IjEwIiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjQ4IiBpZD0iU0FYVHJhbnNmb3JtZXJGYWN0b3J5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxOTMiIHg9IjI2NS41IiB5PSIxODAuMTkiLz48ZWxsaXBzZSBjeD0iMjgwLjUiIGN5PSIxOTYuMTkiIGZpbGw9IiNBOURDREYiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMjgwLjYwOTQsMTkxLjUzMzggTDI3OS40NTMxLDE5Ni42MTE5IEwyODEuNzgxMywxOTYuNjExOSBMMjgwLjYwOTQsMTkxLjUzMzggWiBNMjc5LjEyNSwxODkuMjk5NCBMMjgyLjEwOTQsMTg5LjI5OTQgTDI4NS40Njg4LDIwMS42OSBMMjgzLjAxNTYsMjAxLjY5IEwyODIuMjUsMTk4LjYyNzUgTDI3OC45Njg4LDE5OC42Mjc1IEwyNzguMjE4OCwyMDEuNjkgTDI3NS43ODEzLDIwMS42OSBMMjc5LjEyNSwxODkuMjk5NCBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXN0eWxlPSJpdGFsaWMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTYxIiB4PSIyOTQuNSIgeT0iMjAxLjAzNjciPlNBWFRyYW5zZm9ybWVyRmFjdG9yeTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyNjYuNSIgeDI9IjQ1Ny41IiB5MT0iMjEyLjE5IiB5Mj0iMjEyLjE5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjY2LjUiIHgyPSI0NTcuNSIgeTE9IjIyMC4xOSIgeTI9IjIyMC4xOSIvPjwvZz48IS0tY2xhc3MgVHJhbnNmb3JtZXJGYWN0b3J5SW1wbC0tPjxnIGlkPSJlbGVtX1RyYW5zZm9ybWVyRmFjdG9yeUltcGwiPjxyZWN0IGNvZGVMaW5lPSIxMyIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI5Ni44OTA2IiBpZD0iVHJhbnNmb3JtZXJGYWN0b3J5SW1wbCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMzM4IiB4PSI3IiB5PSIyODguMTkiLz48ZWxsaXBzZSBjeD0iOTAuNzUiIGN5PSIzMDQuMTkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNOTMuNzE4OCwzMDkuODMwNiBROTMuMTQwNiwzMTAuMTI3NSA5Mi41LDMxMC4yNjgxIFE5MS44NTk0LDMxMC40MjQ0IDkxLjE1NjMsMzEwLjQyNDQgUTg4LjY1NjMsMzEwLjQyNDQgODcuMzI4MSwzMDguNzgzOCBRODYuMDE1NiwzMDcuMTI3NSA4Ni4wMTU2LDMwNC4wMDI1IFE4Ni4wMTU2LDMwMC44Nzc1IDg3LjMyODEsMjk5LjIyMTMgUTg4LjY1NjMsMjk3LjU2NSA5MS4xNTYzLDI5Ny41NjUgUTkxLjg1OTQsMjk3LjU2NSA5Mi41LDI5Ny43MjEzIFE5My4xNTYzLDI5Ny44Nzc1IDkzLjcxODgsMjk4LjE3NDQgTDkzLjcxODgsMzAwLjg5MzEgUTkzLjA5MzgsMzAwLjMxNSA5Mi41LDMwMC4wNDk0IFE5MS45MDYzLDI5OS43NjgxIDkxLjI4MTMsMjk5Ljc2ODEgUTg5LjkzNzUsMjk5Ljc2ODEgODkuMjUsMzAwLjg0NjMgUTg4LjU2MjUsMzAxLjkwODggODguNTYyNSwzMDQuMDAyNSBRODguNTYyNSwzMDYuMDk2MyA4OS4yNSwzMDcuMTc0NCBRODkuOTM3NSwzMDguMjM2OSA5MS4yODEzLDMwOC4yMzY5IFE5MS45MDYzLDMwOC4yMzY5IDkyLjUsMzA3Ljk3MTMgUTkzLjA5MzgsMzA3LjY5IDkzLjcxODgsMzA3LjExMTkgTDkzLjcxODgsMzA5LjgzMDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjIiIHg9IjExMS4yNSIgeT0iMzA5LjAzNjciPlRyYW5zZm9ybWVyRmFjdG9yeUltcGw8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjM0NCIgeTE9IjMyMC4xOSIgeTI9IjMyMC4xOSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjgiIHgyPSIzNDQiIHkxPSIzMjguMTkiIHkyPSIzMjguMTkiLz48ZWxsaXBzZSBjeD0iMTgiIGN5PSIzNDEuODM4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMTIiIHg9IjI3IiB5PSIzNDUuMTg1MSI+VHJhbnNmb3JtZXIgbmV3VHJhbnNmb3JtZXIoU291cmNlIHNvdXJjZSk8L3RleHQ+PGVsbGlwc2UgY3g9IjE4IiBjeT0iMzU4LjEzNTMiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjExIiB4PSIyNyIgeT0iMzYxLjQ4MiI+VHJhbnNmb3JtZXIgbmV3VHJhbnNmb3JtZXIoKTwvdGV4dD48ZWxsaXBzZSBjeD0iMTgiIGN5PSIzNzQuNDMyMiIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyOTAiIHg9IjI3IiB5PSIzNzcuNzc4OSI+VGVtcGxhdGVzIG5ld1RlbXBsYXRlcyhTb3VyY2Ugc291cmNlKTwvdGV4dD48L2c+PCEtLWNsYXNzIFNtYXJ0VHJhbnNmb3JtZXJGYWN0b3J5SW1wbC0tPjxnIGlkPSJlbGVtX1NtYXJ0VHJhbnNmb3JtZXJGYWN0b3J5SW1wbCI+PHJlY3QgY29kZUxpbmU9IjE5IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9Ijk2Ljg5MDYiIGlkPSJTbWFydFRyYW5zZm9ybWVyRmFjdG9yeUltcGwiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjMzOCIgeD0iMzgwIiB5PSIyODguMTkiLz48ZWxsaXBzZSBjeD0iNDQzLjc1IiBjeT0iMzA0LjE5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTQ0Ni43MTg4LDMwOS44MzA2IFE0NDYuMTQwNiwzMTAuMTI3NSA0NDUuNSwzMTAuMjY4MSBRNDQ0Ljg1OTQsMzEwLjQyNDQgNDQ0LjE1NjMsMzEwLjQyNDQgUTQ0MS42NTYzLDMxMC40MjQ0IDQ0MC4zMjgxLDMwOC43ODM4IFE0MzkuMDE1NiwzMDcuMTI3NSA0MzkuMDE1NiwzMDQuMDAyNSBRNDM5LjAxNTYsMzAwLjg3NzUgNDQwLjMyODEsMjk5LjIyMTMgUTQ0MS42NTYzLDI5Ny41NjUgNDQ0LjE1NjMsMjk3LjU2NSBRNDQ0Ljg1OTQsMjk3LjU2NSA0NDUuNSwyOTcuNzIxMyBRNDQ2LjE1NjMsMjk3Ljg3NzUgNDQ2LjcxODgsMjk4LjE3NDQgTDQ0Ni43MTg4LDMwMC44OTMxIFE0NDYuMDkzOCwzMDAuMzE1IDQ0NS41LDMwMC4wNDk0IFE0NDQuOTA2MywyOTkuNzY4MSA0NDQuMjgxMywyOTkuNzY4MSBRNDQyLjkzNzUsMjk5Ljc2ODEgNDQyLjI1LDMwMC44NDYzIFE0NDEuNTYyNSwzMDEuOTA4OCA0NDEuNTYyNSwzMDQuMDAyNSBRNDQxLjU2MjUsMzA2LjA5NjMgNDQyLjI1LDMwNy4xNzQ0IFE0NDIuOTM3NSwzMDguMjM2OSA0NDQuMjgxMywzMDguMjM2OSBRNDQ0LjkwNjMsMzA4LjIzNjkgNDQ1LjUsMzA3Ljk3MTMgUTQ0Ni4wOTM4LDMwNy42OSA0NDYuNzE4OCwzMDcuMTExOSBMNDQ2LjcxODgsMzA5LjgzMDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMDIiIHg9IjQ2NC4yNSIgeT0iMzA5LjAzNjciPlNtYXJ0VHJhbnNmb3JtZXJGYWN0b3J5SW1wbDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzODEiIHgyPSI3MTciIHkxPSIzMjAuMTkiIHkyPSIzMjAuMTkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzODEiIHgyPSI3MTciIHkxPSIzMjguMTkiIHkyPSIzMjguMTkiLz48ZWxsaXBzZSBjeD0iMzkxIiBjeT0iMzQxLjgzODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzEyIiB4PSI0MDAiIHk9IjM0NS4xODUxIj5UcmFuc2Zvcm1lciBuZXdUcmFuc2Zvcm1lcihTb3VyY2Ugc291cmNlKTwvdGV4dD48ZWxsaXBzZSBjeD0iMzkxIiBjeT0iMzU4LjEzNTMiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjExIiB4PSI0MDAiIHk9IjM2MS40ODIiPlRyYW5zZm9ybWVyIG5ld1RyYW5zZm9ybWVyKCk8L3RleHQ+PGVsbGlwc2UgY3g9IjM5MSIgY3k9IjM3NC40MzIyIiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI5MCIgeD0iNDAwIiB5PSIzNzcuNzc4OSI+VGVtcGxhdGVzIG5ld1RlbXBsYXRlcyhTb3VyY2Ugc291cmNlKTwvdGV4dD48L2c+PCEtLXJldmVyc2UgbGluayBUcmFuc2Zvcm1lckZhY3RvcnkgdG8gU0FYVHJhbnNmb3JtZXJGYWN0b3J5LS0+PGcgaWQ9ImxpbmtfVHJhbnNmb3JtZXJGYWN0b3J5X1NBWFRyYW5zZm9ybWVyRmFjdG9yeSI+PHBhdGggZD0iTTM2MiwxMzguNTcgQzM2MiwxNTkuMyAzNjIsMTYzLjY5IDM2MiwxNzkuOTMgIiBmaWxsPSJub25lIiBpZD0iVHJhbnNmb3JtZXJGYWN0b3J5LWJhY2t0by1TQVhUcmFuc2Zvcm1lckZhY3RvcnkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iMzYyLDEyMC41NywzNTYsMTM4LjU3LDM2OCwxMzguNTcsMzYyLDEyMC41NyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1yZXZlcnNlIGxpbmsgU0FYVHJhbnNmb3JtZXJGYWN0b3J5IHRvIFRyYW5zZm9ybWVyRmFjdG9yeUltcGwtLT48ZyBpZD0ibGlua19TQVhUcmFuc2Zvcm1lckZhY3RvcnlfVHJhbnNmb3JtZXJGYWN0b3J5SW1wbCI+PHBhdGggZD0iTTMxNC4wMTM1LDIzOC44NDYyIEMyOTAuNTAzNSwyNTUuMzM2MiAyNzIuODksMjY3LjY4IDI0NC4wMiwyODcuOTMgIiBmaWxsPSJub25lIiBpZD0iU0FYVHJhbnNmb3JtZXJGYWN0b3J5LWJhY2t0by1UcmFuc2Zvcm1lckZhY3RvcnlJbXBsIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjMyOC43NSwyMjguNTEsMzEwLjU2ODEsMjMzLjkzNDEsMzE3LjQ1ODksMjQzLjc1ODQsMzI4Ljc1LDIyOC41MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1yZXZlcnNlIGxpbmsgU0FYVHJhbnNmb3JtZXJGYWN0b3J5IHRvIFNtYXJ0VHJhbnNmb3JtZXJGYWN0b3J5SW1wbC0tPjxnIGlkPSJsaW5rX1NBWFRyYW5zZm9ybWVyRmFjdG9yeV9TbWFydFRyYW5zZm9ybWVyRmFjdG9yeUltcGwiPjxwYXRoIGQ9Ik00MTAuMTkzMiwyMzguODA4IEM0MzMuODMzMiwyNTUuMjk4IDQ1MS41OSwyNjcuNjggNDgwLjYyLDI4Ny45MyAiIGZpbGw9Im5vbmUiIGlkPSJTQVhUcmFuc2Zvcm1lckZhY3RvcnktYmFja3RvLVNtYXJ0VHJhbnNmb3JtZXJGYWN0b3J5SW1wbCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSIzOTUuNDMsMjI4LjUxLDQwNi43NjA1LDI0My43MjkxLDQxMy42MjU4LDIzMy44ODY5LDM5NS40MywyMjguNTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tU1JDPVtyUDBfM3U4bTRDTHRGYUt0Q0tSUHRMbkNjNzVtRlNrZjlCR2Jyb0RnMkRfVHNlM3Vmb0dvc2dNdnd0bGxVaF9QY1Jjb3dvSWZJajFTZ3Q4YlpLZmEyVE9reW05RTEyZ0F1NjJQR0JCbVZSNFpxRlBlSTI1ak5UVkdKSkgySENBVFhNV2kwblVvM1FhcU5iQmp0aE40VTN1dS1sV3RwcUZ5S2lRUGdLY1lpRndRUVd4aEtSY2I2UXJOenlOdGVEUVJGbzVhY3RyV0d4bW93ZG1LS0hTclhaNXJWdFg2WDBTQ2VBVXAtV2RHSDJlVDMwTjRWeHZGVDBTMF0tLT48L2c+PC9zdmc+'><h2 id="32-jdk-javasqlconnection"><a class="markdownIt-Anchor" href="#32-jdk-javasqlconnection"></a> 3.2. JDK - java.sql.Connection</h2><p>The <code>java.sql.Connection</code> interface is analogous to the abstract factory interface, as it provides (produces) different product levels such as <code>Statement</code>, <code>PreparedStatement</code>, and <code>CallableStatement</code>. The products provided are all concrete products under the <code>java.sql.Statement</code> interface.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Connection</span> <span class="keyword">extends</span> <span class="title class_">Wrapper</span>, AutoCloseable &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return a regular SQL executor: A regular, parameter-less query SQL (each execution requires SQL to be compiled).</span></span><br><span class="line">    Statement <span class="title function_">createStatement</span><span class="params">()</span> <span class="keyword">throws</span> SQLException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return a SQL executor with pre-compilation functionality: Supports SQL with variable parameters (pre-compiles the SQL to prevent SQL injection).</span></span><br><span class="line">    PreparedStatement <span class="title function_">prepareStatement</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Return a SQL executor for executing stored procedures: Supports calling stored procedures and provides support for output and input/output parameters.</span></span><br><span class="line">    CallableStatement <span class="title function_">prepareCall</span><span class="params">(String sql)</span> <span class="keyword">throws</span> SQLException;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Class diagram of the Abstract Factory and its concrete factory implementations:</p><img class="kroki" src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXMtYXNjaWkiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSI4MDFweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjE2MzNweDtoZWlnaHQ6ODAxcHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMTYzMyA4MDEiIHdpZHRoPSIxNjMzcHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48IS0tY2x1c3RlciBqYXZhLS0+PGcgaWQ9ImNsdXN0ZXJfamF2YSI+PHBhdGggZD0iTTU3Mi41LDYgTDYwNC41LDYgQTMuNzUsMy43NSAwIDAgMSA2MDcsOC41IEw2MTQsMjguMjk2OSBMMTAxMS41LDI4LjI5NjkgQTIuNSwyLjUgMCAwIDEgMTAxNCwzMC43OTY5IEwxMDE0LDIxOC4zOSBBMi41LDIuNSAwIDAgMSAxMDExLjUsMjIwLjg5IEw1NzIuNSwyMjAuODkgQTIuNSwyLjUgMCAwIDEgNTcwLDIxOC4zOSBMNTcwLDguNSBBMi41LDIuNSAwIDAgMSA1NzIuNSw2ICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iNTcwIiB4Mj0iNjE0IiB5MT0iMjguMjk2OSIgeTI9IjI4LjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzEiIHg9IjU3NCIgeT0iMjAuOTk1MSI+amF2YTwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgc3FsLS0+PGcgaWQ9ImNsdXN0ZXJfc3FsIj48cGF0aCBkPSJNNTk2LjUsNDkgTDYyMC41LDQ5IEEzLjc1LDMuNzUgMCAwIDEgNjIzLDUxLjUgTDYzMCw3MS4yOTY5IEw5ODcuNSw3MS4yOTY5IEEyLjUsMi41IDAgMCAxIDk5MCw3My43OTY5IEw5OTAsMTk0LjM5IEEyLjUsMi41IDAgMCAxIDk4Ny41LDE5Ni44OSBMNTk2LjUsMTk2Ljg5IEEyLjUsMi41IDAgMCAxIDU5NCwxOTQuMzkgTDU5NCw1MS41IEEyLjUsMi41IDAgMCAxIDU5Ni41LDQ5ICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iNTk0IiB4Mj0iNjMwIiB5MT0iNzEuMjk2OSIgeTI9IjcxLjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjMiIHg9IjU5OCIgeT0iNjMuOTk1MSI+c3FsPC90ZXh0PjwvZz48IS0tY2x1c3RlciBjb20tLT48ZyBpZD0iY2x1c3Rlcl9jb20iPjxwYXRoIGQ9Ik04LjUsMjQ0Ljg5IEw0Mi41LDI0NC44OSBBMy43NSwzLjc1IDAgMCAxIDQ1LDI0Ny4zOSBMNTIsMjY3LjE4NjkgTDEwNTkuNSwyNjcuMTg2OSBBMi41LDIuNSAwIDAgMSAxMDYyLDI2OS42ODY5IEwxMDYyLDc5Mi4xNyBBMi41LDIuNSAwIDAgMSAxMDU5LjUsNzk0LjY3IEw4LjUsNzk0LjY3IEEyLjUsMi41IDAgMCAxIDYsNzkyLjE3IEw2LDI0Ny4zOSBBMi41LDIuNSAwIDAgMSA4LjUsMjQ0Ljg5ICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iNiIgeDI9IjUyIiB5MT0iMjY3LjE4NjkiIHkyPSIyNjcuMTg2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMyIgeD0iMTAiIHk9IjI1OS44ODUxIj5jb208L3RleHQ+PC9nPjwhLS1jbHVzdGVyIG15c3FsLS0+PGcgaWQ9ImNsdXN0ZXJfbXlzcWwiPjxwYXRoIGQ9Ik01NDguNSwzMTIuMzMgTDU5NS41LDMxMi4zMyBBMy43NSwzLjc1IDAgMCAxIDU5OCwzMTQuODMgTDYwNSwzMzQuNjI2OSBMMTAzNS41LDMzNC42MjY5IEEyLjUsMi41IDAgMCAxIDEwMzgsMzM3LjEyNjkgTDEwMzgsNzY4LjE3IEEyLjUsMi41IDAgMCAxIDEwMzUuNSw3NzAuNjcgTDU0OC41LDc3MC42NyBBMi41LDIuNSAwIDAgMSA1NDYsNzY4LjE3IEw1NDYsMzE0LjgzIEEyLjUsMi41IDAgMCAxIDU0OC41LDMxMi4zMyAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjU0NiIgeDI9IjYwNSIgeTE9IjMzNC42MjY5IiB5Mj0iMzM0LjYyNjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDYiIHg9IjU1MCIgeT0iMzI3LjMyNTEiPm15c3FsPC90ZXh0PjwvZz48IS0tY2x1c3RlciBjai0tPjxnIGlkPSJjbHVzdGVyX2NqIj48cGF0aCBkPSJNNTcyLjUsMzU1LjMzIEw1ODYuNSwzNTUuMzMgQTMuNzUsMy43NSAwIDAgMSA1ODksMzU3LjgzIEw1OTYsMzc3LjYyNjkgTDEwMTEuNSwzNzcuNjI2OSBBMi41LDIuNSAwIDAgMSAxMDE0LDM4MC4xMjY5IEwxMDE0LDc0NC4xNyBBMi41LDIuNSAwIDAgMSAxMDExLjUsNzQ2LjY3IEw1NzIuNSw3NDYuNjcgQTIuNSwyLjUgMCAwIDEgNTcwLDc0NC4xNyBMNTcwLDM1Ny44MyBBMi41LDIuNSAwIDAgMSA1NzIuNSwzNTUuMzMgIiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSI1NzAiIHgyPSI1OTYiIHkxPSIzNzcuNjI2OSIgeTI9IjM3Ny42MjY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzIiB4PSI1NzQiIHk9IjM3MC4zMjUxIj5jajwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgamRiYy0tPjxnIGlkPSJjbHVzdGVyX2pkYmMiPjxwYXRoIGQ9Ik01OTYuNSwzOTguMzMgTDYzMC41LDM5OC4zMyBBMy43NSwzLjc1IDAgMCAxIDYzMyw0MDAuODMgTDY0MCw0MjAuNjI2OSBMOTg3LjUsNDIwLjYyNjkgQTIuNSwyLjUgMCAwIDEgOTkwLDQyMy4xMjY5IEw5OTAsNzIwLjE3IEEyLjUsMi41IDAgMCAxIDk4Ny41LDcyMi42NyBMNTk2LjUsNzIyLjY3IEEyLjUsMi41IDAgMCAxIDU5NCw3MjAuMTcgTDU5NCw0MDAuODMgQTIuNSwyLjUgMCAwIDEgNTk2LjUsMzk4LjMzICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iNTk0IiB4Mj0iNjQwIiB5MT0iNDIwLjYyNjkiIHkyPSI0MjAuNjI2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMyIgeD0iNTk4IiB5PSI0MTMuMzI1MSI+amRiYzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgYWxpYmFiYS0tPjxnIGlkPSJjbHVzdGVyX2FsaWJhYmEiPjxwYXRoIGQ9Ik0zMi41LDI4Ny44OSBMODguNSwyODcuODkgQTMuNzUsMy43NSAwIDAgMSA5MSwyOTAuMzkgTDk4LDMxMC4xODY5IEw1MTkuNSwzMTAuMTg2OSBBMi41LDIuNSAwIDAgMSA1MjIsMzEyLjY4NjkgTDUyMiw1NjcuMjggQTIuNSwyLjUgMCAwIDEgNTE5LjUsNTY5Ljc4IEwzMi41LDU2OS43OCBBMi41LDIuNSAwIDAgMSAzMCw1NjcuMjggTDMwLDI5MC4zOSBBMi41LDIuNSAwIDAgMSAzMi41LDI4Ny44OSAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjMwIiB4Mj0iOTgiIHkxPSIzMTAuMTg2OSIgeTI9IjMxMC4xODY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1IiB4PSIzNCIgeT0iMzAyLjg4NTEiPmFsaWJhYmE8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGRydWlkLS0+PGcgaWQ9ImNsdXN0ZXJfZHJ1aWQiPjxwYXRoIGQ9Ik01Ni41LDMzMC44OSBMOTguNSwzMzAuODkgQTMuNzUsMy43NSAwIDAgMSAxMDEsMzMzLjM5IEwxMDgsMzUzLjE4NjkgTDQ5NS41LDM1My4xODY5IEEyLjUsMi41IDAgMCAxIDQ5OCwzNTUuNjg2OSBMNDk4LDU0My4yOCBBMi41LDIuNSAwIDAgMSA0OTUuNSw1NDUuNzggTDU2LjUsNTQ1Ljc4IEEyLjUsMi41IDAgMCAxIDU0LDU0My4yOCBMNTQsMzMzLjM5IEEyLjUsMi41IDAgMCAxIDU2LjUsMzMwLjg5ICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iNTQiIHgyPSIxMDgiIHkxPSIzNTMuMTg2OSIgeTI9IjM1My4xODY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxIiB4PSI1OCIgeT0iMzQ1Ljg4NTEiPmRydWlkPC90ZXh0PjwvZz48IS0tY2x1c3RlciBwb29sLS0+PGcgaWQ9ImNsdXN0ZXJfcG9vbCI+PHBhdGggZD0iTTgwLjUsMzczLjg5IEwxMTUuNSwzNzMuODkgQTMuNzUsMy43NSAwIDAgMSAxMTgsMzc2LjM5IEwxMjUsMzk2LjE4NjkgTDQ3MS41LDM5Ni4xODY5IEEyLjUsMi41IDAgMCAxIDQ3NCwzOTguNjg2OSBMNDc0LDUxOS4yOCBBMi41LDIuNSAwIDAgMSA0NzEuNSw1MjEuNzggTDgwLjUsNTIxLjc4IEEyLjUsMi41IDAgMCAxIDc4LDUxOS4yOCBMNzgsMzc2LjM5IEEyLjUsMi41IDAgMCAxIDgwLjUsMzczLjg5ICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iNzgiIHgyPSIxMjUiIHkxPSIzOTYuMTg2OSIgeTI9IjM5Ni4xODY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM0IiB4PSI4MiIgeT0iMzg4Ljg4NTEiPnBvb2w8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIG9yZy0tPjxnIGlkPSJjbHVzdGVyX29yZyI+PHBhdGggZD0iTTEwODguNSwyNDQuODkgTDExMTYuNSwyNDQuODkgQTMuNzUsMy43NSAwIDAgMSAxMTE5LDI0Ny4zOSBMMTEyNiwyNjcuMTg2OSBMMTYyMy41LDI2Ny4xODY5IEEyLjUsMi41IDAgMCAxIDE2MjYsMjY5LjY4NjkgTDE2MjYsNTkxLjI4IEEyLjUsMi41IDAgMCAxIDE2MjMuNSw1OTMuNzggTDEwODguNSw1OTMuNzggQTIuNSwyLjUgMCAwIDEgMTA4Niw1OTEuMjggTDEwODYsMjQ3LjM5IEEyLjUsMi41IDAgMCAxIDEwODguNSwyNDQuODkgIiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIxMDg2IiB4Mj0iMTEyNiIgeTE9IjI2Ny4xODY5IiB5Mj0iMjY3LjE4NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjciIHg9IjEwOTAiIHk9IjI1OS44ODUxIj5vcmc8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGFwYWNoZS0tPjxnIGlkPSJjbHVzdGVyX2FwYWNoZSI+PHBhdGggZD0iTTExMTIuNSwyODcuODkgTDExNzAuNSwyODcuODkgQTMuNzUsMy43NSAwIDAgMSAxMTczLDI5MC4zOSBMMTE4MCwzMTAuMTg2OSBMMTU5OS41LDMxMC4xODY5IEEyLjUsMi41IDAgMCAxIDE2MDIsMzEyLjY4NjkgTDE2MDIsNTY3LjI4IEEyLjUsMi41IDAgMCAxIDE1OTkuNSw1NjkuNzggTDExMTIuNSw1NjkuNzggQTIuNSwyLjUgMCAwIDEgMTExMCw1NjcuMjggTDExMTAsMjkwLjM5IEEyLjUsMi41IDAgMCAxIDExMTIuNSwyODcuODkgIiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIxMTEwIiB4Mj0iMTE4MCIgeTE9IjMxMC4xODY5IiB5Mj0iMzEwLjE4NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTciIHg9IjExMTQiIHk9IjMwMi44ODUxIj5hcGFjaGU8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGNvbW1vbnMtLT48ZyBpZD0iY2x1c3Rlcl9jb21tb25zIj48cGF0aCBkPSJNMTEzNi41LDMzMC44OSBMMTIxMy41LDMzMC44OSBBMy43NSwzLjc1IDAgMCAxIDEyMTYsMzMzLjM5IEwxMjIzLDM1My4xODY5IEwxNTc1LjUsMzUzLjE4NjkgQTIuNSwyLjUgMCAwIDEgMTU3OCwzNTUuNjg2OSBMMTU3OCw1NDMuMjggQTIuNSwyLjUgMCAwIDEgMTU3NS41LDU0NS43OCBMMTEzNi41LDU0NS43OCBBMi41LDIuNSAwIDAgMSAxMTM0LDU0My4yOCBMMTEzNCwzMzMuMzkgQTIuNSwyLjUgMCAwIDEgMTEzNi41LDMzMC44OSAiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjExMzQiIHgyPSIxMjIzIiB5MT0iMzUzLjE4NjkiIHkyPSIzNTMuMTg2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NiIgeD0iMTEzOCIgeT0iMzQ1Ljg4NTEiPmNvbW1vbnM8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGRiY3AyLS0+PGcgaWQ9ImNsdXN0ZXJfZGJjcDIiPjxwYXRoIGQ9Ik0xMTYwLjUsMzczLjg5IEwxMjEwLjUsMzczLjg5IEEzLjc1LDMuNzUgMCAwIDEgMTIxMywzNzYuMzkgTDEyMjAsMzk2LjE4NjkgTDE1NTEuNSwzOTYuMTg2OSBBMi41LDIuNSAwIDAgMSAxNTU0LDM5OC42ODY5IEwxNTU0LDUxOS4yOCBBMi41LDIuNSAwIDAgMSAxNTUxLjUsNTIxLjc4IEwxMTYwLjUsNTIxLjc4IEEyLjUsMi41IDAgMCAxIDExNTgsNTE5LjI4IEwxMTU4LDM3Ni4zOSBBMi41LDIuNSAwIDAgMSAxMTYwLjUsMzczLjg5ICIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iMTE1OCIgeDI9IjEyMjAiIHkxPSIzOTYuMTg2OSIgeTI9IjM5Ni4xODY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ5IiB4PSIxMTYyIiB5PSIzODguODg1MSI+ZGJjcDI8L3RleHQ+PC9nPjwhLS1jbGFzcyBDb25uZWN0aW9uLS0+PGcgaWQ9ImVsZW1fQ29ubmVjdGlvbiI+PHJlY3QgY29kZUxpbmU9IjMiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iOTYuODkwNiIgaWQ9IkNvbm5lY3Rpb24iIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjM2NSIgeD0iNjA5LjUiIHk9Ijg0Ii8+PGVsbGlwc2UgY3g9Ijc0Ny43NSIgY3k9IjEwMCIgZmlsbD0iI0I0QTdFNSIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik03NDMuNjcxOSw5NS43NjU2IEw3NDMuNjcxOSw5My42MDk0IEw3NTEuMDYyNSw5My42MDk0IEw3NTEuMDYyNSw5NS43NjU2IEw3NDguNTkzOCw5NS43NjU2IEw3NDguNTkzOCwxMDMuODQzOCBMNzUxLjA2MjUsMTAzLjg0MzggTDc1MS4wNjI1LDEwNiBMNzQzLjY3MTksMTA2IEw3NDMuNjcxOSwxMDMuODQzOCBMNzQ2LjE0MDYsMTAzLjg0MzggTDc0Ni4xNDA2LDk1Ljc2NTYgTDc0My42NzE5LDk1Ljc2NTYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC1zdHlsZT0iaXRhbGljIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgwIiB4PSI3NjguMjUiIHk9IjEwNC44NDY3Ij5Db25uZWN0aW9uPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjYxMC41IiB4Mj0iOTczLjUiIHkxPSIxMTYiIHkyPSIxMTYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI2MTAuNSIgeDI9Ijk3My41IiB5MT0iMTI0IiB5Mj0iMTI0Ii8+PGVsbGlwc2UgY3g9IjYyMC41IiBjeT0iMTM3LjY0ODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMDIiIHg9IjYyOS41IiB5PSIxNDAuOTk1MSI+U3RhdGVtZW50IGNyZWF0ZVN0YXRlbWVudCgpPC90ZXh0PjxlbGxpcHNlIGN4PSI2MjAuNSIgY3k9IjE1My45NDUzIiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXN0eWxlPSJpdGFsaWMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzM5IiB4PSI2MjkuNSIgeT0iMTU3LjI5MiI+UHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVudChTdHJpbmcgc3FsKTwvdGV4dD48ZWxsaXBzZSBjeD0iNjIwLjUiIGN5PSIxNzAuMjQyMiIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC1zdHlsZT0iaXRhbGljIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4MSIgeD0iNjI5LjUiIHk9IjE3My41ODg5Ij5DYWxsYWJsZVN0YXRlbWVudCBwcmVwYXJlQ2FsbChTdHJpbmcgc3FsKTwvdGV4dD48L2c+PCEtLWNsYXNzIEpkYmNDb25uZWN0aW9uLS0+PGcgaWQ9ImVsZW1fSmRiY0Nvbm5lY3Rpb24iPjxyZWN0IGNvZGVMaW5lPSI5IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjQ4IiBpZD0iSmRiY0Nvbm5lY3Rpb24iIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE0MSIgeD0iNzIxLjUiIHk9IjQzMy4zMyIvPjxlbGxpcHNlIGN4PSI3MzYuNSIgY3k9IjQ0OS4zMyIgZmlsbD0iI0I0QTdFNSIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik03MzIuNDIxOSw0NDUuMDk1NiBMNzMyLjQyMTksNDQyLjkzOTQgTDczOS44MTI1LDQ0Mi45Mzk0IEw3MzkuODEyNSw0NDUuMDk1NiBMNzM3LjM0MzgsNDQ1LjA5NTYgTDczNy4zNDM4LDQ1My4xNzM4IEw3MzkuODEyNSw0NTMuMTczOCBMNzM5LjgxMjUsNDU1LjMzIEw3MzIuNDIxOSw0NTUuMzMgTDczMi40MjE5LDQ1My4xNzM4IEw3MzQuODkwNiw0NTMuMTczOCBMNzM0Ljg5MDYsNDQ1LjA5NTYgTDczMi40MjE5LDQ0NS4wOTU2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDkiIHg9Ijc1MC41IiB5PSI0NTQuMTc2NyI+SmRiY0Nvbm5lY3Rpb248L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNzIyLjUiIHgyPSI4NjEuNSIgeTE9IjQ2NS4zMyIgeTI9IjQ2NS4zMyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjcyMi41IiB4Mj0iODYxLjUiIHkxPSI0NzMuMzMiIHkyPSI0NzMuMzMiLz48L2c+PCEtLWNsYXNzIENvbm5lY3Rpb25JbXBsLS0+PGcgaWQ9ImVsZW1fQ29ubmVjdGlvbkltcGwiPjxyZWN0IGNvZGVMaW5lPSIxMiIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI5Ni44OTA2IiBpZD0iQ29ubmVjdGlvbkltcGwiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjM2NSIgeD0iNjA5LjUiIHk9IjYwOS43OCIvPjxlbGxpcHNlIGN4PSI3MzMuNzUiIGN5PSI2MjUuNzgiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNNzM2LjcxODgsNjMxLjQyMDYgUTczNi4xNDA2LDYzMS43MTc1IDczNS41LDYzMS44NTgxIFE3MzQuODU5NCw2MzIuMDE0NCA3MzQuMTU2Myw2MzIuMDE0NCBRNzMxLjY1NjMsNjMyLjAxNDQgNzMwLjMyODEsNjMwLjM3MzggUTcyOS4wMTU2LDYyOC43MTc1IDcyOS4wMTU2LDYyNS41OTI1IFE3MjkuMDE1Niw2MjIuNDY3NSA3MzAuMzI4MSw2MjAuODExMyBRNzMxLjY1NjMsNjE5LjE1NSA3MzQuMTU2Myw2MTkuMTU1IFE3MzQuODU5NCw2MTkuMTU1IDczNS41LDYxOS4zMTEzIFE3MzYuMTU2Myw2MTkuNDY3NSA3MzYuNzE4OCw2MTkuNzY0NCBMNzM2LjcxODgsNjIyLjQ4MzEgUTczNi4wOTM4LDYyMS45MDUgNzM1LjUsNjIxLjYzOTQgUTczNC45MDYzLDYyMS4zNTgxIDczNC4yODEzLDYyMS4zNTgxIFE3MzIuOTM3NSw2MjEuMzU4MSA3MzIuMjUsNjIyLjQzNjMgUTczMS41NjI1LDYyMy40OTg4IDczMS41NjI1LDYyNS41OTI1IFE3MzEuNTYyNSw2MjcuNjg2MyA3MzIuMjUsNjI4Ljc2NDQgUTczMi45Mzc1LDYyOS44MjY5IDczNC4yODEzLDYyOS44MjY5IFE3MzQuOTA2Myw2MjkuODI2OSA3MzUuNSw2MjkuNTYxMyBRNzM2LjA5MzgsNjI5LjI4IDczNi43MTg4LDYyOC43MDE5IEw3MzYuNzE4OCw2MzEuNDIwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwOCIgeD0iNzU0LjI1IiB5PSI2MzAuNjI2NyI+Q29ubmVjdGlvbkltcGw8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNjEwLjUiIHgyPSI5NzMuNSIgeTE9IjY0MS43OCIgeTI9IjY0MS43OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjYxMC41IiB4Mj0iOTczLjUiIHkxPSI2NDkuNzgiIHkyPSI2NDkuNzgiLz48ZWxsaXBzZSBjeD0iNjIwLjUiIGN5PSI2NjMuNDI4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMDIiIHg9IjYyOS41IiB5PSI2NjYuNzc1MSI+U3RhdGVtZW50IGNyZWF0ZVN0YXRlbWVudCgpPC90ZXh0PjxlbGxpcHNlIGN4PSI2MjAuNSIgY3k9IjY3OS43MjUzIiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMzOSIgeD0iNjI5LjUiIHk9IjY4My4wNzIiPlByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVTdGF0ZW1lbnQoU3RyaW5nIHNxbCk8L3RleHQ+PGVsbGlwc2UgY3g9IjYyMC41IiBjeT0iNjk2LjAyMjIiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjgxIiB4PSI2MjkuNSIgeT0iNjk5LjM2ODkiPkNhbGxhYmxlU3RhdGVtZW50IHByZXBhcmVDYWxsKFN0cmluZyBzcWwpPC90ZXh0PjwvZz48IS0tY2xhc3MgRHJ1aWRQb29sZWRDb25uZWN0aW9uLS0+PGcgaWQ9ImVsZW1fRHJ1aWRQb29sZWRDb25uZWN0aW9uIj48cmVjdCBjb2RlTGluZT0iMTgiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iOTYuODkwNiIgaWQ9IkRydWlkUG9vbGVkQ29ubmVjdGlvbiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMzY1IiB4PSI5My41IiB5PSI0MDguODkiLz48ZWxsaXBzZSBjeD0iMTg5LjI1IiBjeT0iNDI0Ljg5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTE5Mi4yMTg4LDQzMC41MzA2IFExOTEuNjQwNiw0MzAuODI3NSAxOTEsNDMwLjk2ODEgUTE5MC4zNTk0LDQzMS4xMjQ0IDE4OS42NTYzLDQzMS4xMjQ0IFExODcuMTU2Myw0MzEuMTI0NCAxODUuODI4MSw0MjkuNDgzOCBRMTg0LjUxNTYsNDI3LjgyNzUgMTg0LjUxNTYsNDI0LjcwMjUgUTE4NC41MTU2LDQyMS41Nzc1IDE4NS44MjgxLDQxOS45MjEzIFExODcuMTU2Myw0MTguMjY1IDE4OS42NTYzLDQxOC4yNjUgUTE5MC4zNTk0LDQxOC4yNjUgMTkxLDQxOC40MjEzIFExOTEuNjU2Myw0MTguNTc3NSAxOTIuMjE4OCw0MTguODc0NCBMMTkyLjIxODgsNDIxLjU5MzEgUTE5MS41OTM4LDQyMS4wMTUgMTkxLDQyMC43NDk0IFExOTAuNDA2Myw0MjAuNDY4MSAxODkuNzgxMyw0MjAuNDY4MSBRMTg4LjQzNzUsNDIwLjQ2ODEgMTg3Ljc1LDQyMS41NDYzIFExODcuMDYyNSw0MjIuNjA4OCAxODcuMDYyNSw0MjQuNzAyNSBRMTg3LjA2MjUsNDI2Ljc5NjMgMTg3Ljc1LDQyNy44NzQ0IFExODguNDM3NSw0MjguOTM2OSAxODkuNzgxMyw0MjguOTM2OSBRMTkwLjQwNjMsNDI4LjkzNjkgMTkxLDQyOC42NzEzIFExOTEuNTkzOCw0MjguMzkgMTkyLjIxODgsNDI3LjgxMTkgTDE5Mi4yMTg4LDQzMC41MzA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTY1IiB4PSIyMDkuNzUiIHk9IjQyOS43MzY3Ij5EcnVpZFBvb2xlZENvbm5lY3Rpb248L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOTQuNSIgeDI9IjQ1Ny41IiB5MT0iNDQwLjg5IiB5Mj0iNDQwLjg5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOTQuNSIgeDI9IjQ1Ny41IiB5MT0iNDQ4Ljg5IiB5Mj0iNDQ4Ljg5Ii8+PGVsbGlwc2UgY3g9IjEwNC41IiBjeT0iNDYyLjUzODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjAyIiB4PSIxMTMuNSIgeT0iNDY1Ljg4NTEiPlN0YXRlbWVudCBjcmVhdGVTdGF0ZW1lbnQoKTwvdGV4dD48ZWxsaXBzZSBjeD0iMTA0LjUiIGN5PSI0NzguODM1MyIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMzkiIHg9IjExMy41IiB5PSI0ODIuMTgyIj5QcmVwYXJlZFN0YXRlbWVudCBwcmVwYXJlU3RhdGVtZW50KFN0cmluZyBzcWwpPC90ZXh0PjxlbGxpcHNlIGN4PSIxMDQuNSIgY3k9IjQ5NS4xMzIyIiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI4MSIgeD0iMTEzLjUiIHk9IjQ5OC40Nzg5Ij5DYWxsYWJsZVN0YXRlbWVudCBwcmVwYXJlQ2FsbChTdHJpbmcgc3FsKTwvdGV4dD48L2c+PCEtLWNsYXNzIERlbGVnYXRpbmdDb25uZWN0aW9uLS0+PGcgaWQ9ImVsZW1fRGVsZWdhdGluZ0Nvbm5lY3Rpb24iPjxyZWN0IGNvZGVMaW5lPSIyNCIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI5Ni44OTA2IiBpZD0iRGVsZWdhdGluZ0Nvbm5lY3Rpb24iIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjM2NSIgeD0iMTE3My41IiB5PSI0MDguODkiLz48ZWxsaXBzZSBjeD0iMTI3NC4yNSIgY3k9IjQyNC44OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0xMjc3LjIxODgsNDMwLjUzMDYgUTEyNzYuNjQwNiw0MzAuODI3NSAxMjc2LDQzMC45NjgxIFExMjc1LjM1OTQsNDMxLjEyNDQgMTI3NC42NTYzLDQzMS4xMjQ0IFExMjcyLjE1NjMsNDMxLjEyNDQgMTI3MC44MjgxLDQyOS40ODM4IFExMjY5LjUxNTYsNDI3LjgyNzUgMTI2OS41MTU2LDQyNC43MDI1IFExMjY5LjUxNTYsNDIxLjU3NzUgMTI3MC44MjgxLDQxOS45MjEzIFExMjcyLjE1NjMsNDE4LjI2NSAxMjc0LjY1NjMsNDE4LjI2NSBRMTI3NS4zNTk0LDQxOC4yNjUgMTI3Niw0MTguNDIxMyBRMTI3Ni42NTYzLDQxOC41Nzc1IDEyNzcuMjE4OCw0MTguODc0NCBMMTI3Ny4yMTg4LDQyMS41OTMxIFExMjc2LjU5MzgsNDIxLjAxNSAxMjc2LDQyMC43NDk0IFExMjc1LjQwNjMsNDIwLjQ2ODEgMTI3NC43ODEzLDQyMC40NjgxIFExMjczLjQzNzUsNDIwLjQ2ODEgMTI3Mi43NSw0MjEuNTQ2MyBRMTI3Mi4wNjI1LDQyMi42MDg4IDEyNzIuMDYyNSw0MjQuNzAyNSBRMTI3Mi4wNjI1LDQyNi43OTYzIDEyNzIuNzUsNDI3Ljg3NDQgUTEyNzMuNDM3NSw0MjguOTM2OSAxMjc0Ljc4MTMsNDI4LjkzNjkgUTEyNzUuNDA2Myw0MjguOTM2OSAxMjc2LDQyOC42NzEzIFExMjc2LjU5MzgsNDI4LjM5IDEyNzcuMjE4OCw0MjcuODExOSBMMTI3Ny4yMTg4LDQzMC41MzA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU1IiB4PSIxMjk0Ljc1IiB5PSI0MjkuNzM2NyI+RGVsZWdhdGluZ0Nvbm5lY3Rpb248L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTE3NC41IiB4Mj0iMTUzNy41IiB5MT0iNDQwLjg5IiB5Mj0iNDQwLjg5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTE3NC41IiB4Mj0iMTUzNy41IiB5MT0iNDQ4Ljg5IiB5Mj0iNDQ4Ljg5Ii8+PGVsbGlwc2UgY3g9IjExODQuNSIgY3k9IjQ2Mi41Mzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIwMiIgeD0iMTE5My41IiB5PSI0NjUuODg1MSI+U3RhdGVtZW50IGNyZWF0ZVN0YXRlbWVudCgpPC90ZXh0PjxlbGxpcHNlIGN4PSIxMTg0LjUiIGN5PSI0NzguODM1MyIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzMzkiIHg9IjExOTMuNSIgeT0iNDgyLjE4MiI+UHJlcGFyZWRTdGF0ZW1lbnQgcHJlcGFyZVN0YXRlbWVudChTdHJpbmcgc3FsKTwvdGV4dD48ZWxsaXBzZSBjeD0iMTE4NC41IiBjeT0iNDk1LjEzMjIiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjgxIiB4PSIxMTkzLjUiIHk9IjQ5OC40Nzg5Ij5DYWxsYWJsZVN0YXRlbWVudCBwcmVwYXJlQ2FsbChTdHJpbmcgc3FsKTwvdGV4dD48L2c+PCEtLXJldmVyc2UgbGluayBDb25uZWN0aW9uIHRvIEpkYmNDb25uZWN0aW9uLS0+PGcgaWQ9ImxpbmtfQ29ubmVjdGlvbl9KZGJjQ29ubmVjdGlvbiI+PHBhdGggZD0iTTc5MiwxOTkuMDkgQzc5MiwyNjkuNDMgNzkyLDM4MC40MyA3OTIsNDMzLjA1ICIgZmlsbD0ibm9uZSIgaWQ9IkNvbm5lY3Rpb24tYmFja3RvLUpkYmNDb25uZWN0aW9uIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9Ijc5MiwxODEuMDksNzg2LDE5OS4wOSw3OTgsMTk5LjA5LDc5MiwxODEuMDkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIEpkYmNDb25uZWN0aW9uIHRvIENvbm5lY3Rpb25JbXBsLS0+PGcgaWQ9ImxpbmtfSmRiY0Nvbm5lY3Rpb25fQ29ubmVjdGlvbkltcGwiPjxwYXRoIGQ9Ik03OTIsNDk5LjU0IEM3OTIsNTMwLjc5IDc5Miw1NjkuMTUgNzkyLDYwOS42MiAiIGZpbGw9Im5vbmUiIGlkPSJKZGJjQ29ubmVjdGlvbi1iYWNrdG8tQ29ubmVjdGlvbkltcGwiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9Ijc5Miw0ODEuNTQsNzg2LDQ5OS41NCw3OTgsNDk5LjU0LDc5Miw0ODEuNTQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIENvbm5lY3Rpb24gdG8gRHJ1aWRQb29sZWRDb25uZWN0aW9uLS0+PGcgaWQ9ImxpbmtfQ29ubmVjdGlvbl9EcnVpZFBvb2xlZENvbm5lY3Rpb24iPjxwYXRoIGQ9Ik02NzguNTE0MiwxODkuNjE0MyBDNjQ2LjA3NDIsMjA2LjM1NDMgNjI2LjA1LDIxNy41NiA1OTQsMjM2Ljg5IEM1MDMuMjUsMjkxLjYzIDQwMy4zOCwzNjIuMzkgMzQwLjIzLDQwOC41NCAiIGZpbGw9Im5vbmUiIGlkPSJDb25uZWN0aW9uLWJhY2t0by1EcnVpZFBvb2xlZENvbm5lY3Rpb24iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjY5NC41MSwxODEuMzYsNjc1Ljc2MjcsMTg0LjI4MjQsNjgxLjI2NTYsMTk0Ljk0NjMsNjk0LjUxLDE4MS4zNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1yZXZlcnNlIGxpbmsgQ29ubmVjdGlvbiB0byBEZWxlZ2F0aW5nQ29ubmVjdGlvbi0tPjxnIGlkPSJsaW5rX0Nvbm5lY3Rpb25fRGVsZWdhdGluZ0Nvbm5lY3Rpb24iPjxwYXRoIGQ9Ik05MDIuMjQ2OSwxODkuNTUwOCBDOTM1LjI3NjksMjA2LjY5MDggOTU2LjUsMjE4LjEyIDk5MCwyMzYuODkgQzEwOTEuMzEsMjkzLjY2IDEyMDUuNzcsMzYzLjE4IDEyNzkuMyw0MDguNTYgIiBmaWxsPSJub25lIiBpZD0iQ29ubmVjdGlvbi1iYWNrdG8tRGVsZWdhdGluZ0Nvbm5lY3Rpb24iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9Ijg4Ni4yNywxODEuMjYsODk5LjQ4MzMsMTk0Ljg3NjQsOTA1LjAxMDUsMTg0LjIyNTEsODg2LjI3LDE4MS4yNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1TUkM9W3JQRkJKaUNtNDROdC1HaGwwMjRjNGFrc3hHUE1iVmU1NHRqODdPcVZzNUM0Z2xobEUwN1gyQzkzTk80TnJsV25UdG9reFJFVElDbXRSSGlQbFVtVFdtd2tyT212Tm5jQlZLQk5ERE9CZk5sS2YwUHlIQ1dGM0FsV0ZNY25tUWszS2VxZ3hMOFRpQ2tJS0NqSFJHTTU3N2JIRWI0OXR5VmQ1cWxSRHVhWTlaOHJCUnhFckJvajlFanhMT2VsQWdvRzZKa2NKbWhabWVWYXVvR21tb2hDdTl2N0JadDBPM2VEVHdNUkNUQUphM1Z2SV91dG5TY3QxUk13LXpQNUxoUHFxbmRwcHZNaGt4LW56NEdWSnAybGVZQlIzWmk0YV9STUcwbzFPSnM2Y25BSGNRN0NpQnpfSHQtSERBR1VDQUJVcVZYM05GMFBvYU41UXJXSkt1ekl5bHVwUWxDMl0tLT48L2c+PC9zdmc+'><h1 id="4-summary"><a class="markdownIt-Anchor" href="#4-summary"></a> 4. Summary</h1><p><strong>Applicable Scenarios</strong>:<br />The Abstract Factory pattern was initially applied to create window components for different operating systems, such as the Button and Text components in Java’s AWT, where the native implementations differ between Windows and UNIX. In this case, different systems represent product families, and different components represent product levels.</p><ol><li>A system should not depend on the details of how instances of product classes are created, composed, and represented. This is important for all types of factory patterns.</li><li>When the products to be created are a series of related or interdependent product families, such as the television, washing machine, air conditioner, etc., in an appliance factory.</li><li>When there are multiple product families in the system, but only one family of products is used at a time, meaning only products from a single family are consumed. For example, someone may prefer using products from a particular ecosystem, such as the Xiaomi ecosystem or the Apple ecosystem.</li><li>When the system provides a library of product classes, with all products appearing through the same interface, ensuring that the client is independent of the implementation.</li></ol><p><strong>Advantages</strong>:</p><ol><li><strong>Separation of Interface and Implementation</strong>: The client uses the abstract factory to create the required objects, without knowing the specific implementation. The client programs against the product interfaces, meaning the client is decoupled from the specific product implementations.</li><li><strong>Easy to Switch Product Families</strong>: Because a concrete factory implementation represents a product family, for example, switching from the Huawei family to the Apple family only requires replacing the concrete factory.</li></ol><p><strong>Disadvantages</strong>:<br />When adding a new factory, such as Xiaomi, you only need to add a new Xiaomi concrete factory class and implement the corresponding product methods, which offers good extensibility. However, when adding a new product, you need to modify the abstract factory, which leads to changes in all factory implementation classes.</p><h1 id="references"><a class="markdownIt-Anchor" href="#references"></a> References</h1><ul><li><a href="https://www.cnblogs.com/java-my-life/archive/2012/03/28/2418836.html">《JAVA与模式》之抽象工厂模式 - java_my_life - 博客园 (cnblogs.com)</a></li><li><a href="http://c.biancheng.net/view/1351.html">抽象工厂模式（详解版） (biancheng.net)</a></li><li><a href="https://refactoringguru.cn/design-patterns/abstract-factory">抽象工厂模式</a></li><li><a href="http://c.biancheng.net/view/8392.html">抽象工厂在Java源码中的应用</a></li><li><a href="https://java-design-patterns.com/patterns/abstract-factory/">Abstract Factory in java-design-patterns</a></li></ul>]]></content>
        
        
        <categories>
            
            <category> 23 Design Patterns </category>
            
            <category> 1. Creational Pattern </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Design_Pattern </tag>
            
            <tag> Creational_Pattern </tag>
            
        </tags>
        
    </entry>
    
    
    
    <entry>
        <title>Factory Method Pattern</title>
        <link href="/en/design-pattern/factory-method-pattern/"/>
        <url>/en/design-pattern/factory-method-pattern/</url>
        
        <content type="html"><![CDATA[<h1 id="0-overview"><a class="markdownIt-Anchor" href="#0-overview"></a> 0. Overview</h1><p>Factory Pattern is primarily divided into three categories: Simple Factory Pattern, Factory Method Pattern, and Abstract Factory Pattern. All of them are classified as Creational Design Pattern, although the Simple Factory Pattern is not included in the GoF’s 23 design patterns.</p><p>Definition of Factory Pattern: It defines a factory interface for creating product objects, delegating the actual creation of these product objects to specific subclasses of the factory. This satisfies the characteristic of “separating creation from usage”, as required by Creational Design Pattern.</p><h1 id="1-simple-factory-pattern"><a class="markdownIt-Anchor" href="#1-simple-factory-pattern"></a> 1. Simple Factory Pattern</h1><p><strong>Simple Factory Pattern</strong>, also known as the <strong>Static Factory Method Pattern</strong>, uses a single factory object to determine which type of product instance to create. Essentially, the Simple Factory Pattern relies on a factory class that dynamically decides which product class to instantiate based on the parameters provided (such as product type).</p><p><strong>Pros:</strong></p><ol><li>A single factory class provides access to all different product types, making the structure straightforward, easy to implement, and easy to understand.</li><li>The client does not need to know the specific class name of the product being created. Instead, by simply passing the correct parameter (such as the product type), the client can obtain the desired object without needing to know the details of its creation.</li></ol><p><strong>Cons:</strong></p><ol><li>The factory class is centralized, with heavy responsibilities; adding new products requires modifying the factory’s logic (making it hard to extend), which violates the Open-Closed Principle.</li><li>The factory uses a static method to create products, preventing the formation of an inheritance-based hierarchy for the factory role.</li></ol><p><strong>Scenarios:</strong></p><ol><li>When the factory class is responsible for creating a limited number of product types.</li><li>When the client only needs to pass parameters to the factory class and does not need to know the logic or details of object creation.</li></ol><h2 id="11-structure-and-implementation"><a class="markdownIt-Anchor" href="#11-structure-and-implementation"></a> 1.1. Structure and Implementation</h2><p>The main roles in the Simple Factory Pattern are as follows:</p><ul><li><strong>Simple Factory (SimpleFactory)</strong>: This is the core of the Simple Factory Pattern, responsible for the internal logic to create all products. The factory class provides a public static method for creating products, which can be called directly from outside. This method uses a product type parameter to create the desired product object.</li><li><strong>Abstract Product (IProduct)</strong>: This is the parent interface for all product objects created by the simple factory, defining the common interface for all product instances.</li><li><strong>Concrete Products (Phone, Laptop, Earphone)</strong>: These are the specific products targeted by the Simple Factory, each implementing the common product interface.</li></ul><p>The class diagram is as follows:</p><img class="kroki" src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXMtYXNjaWkiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSI1NDZweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjYzN3B4O2hlaWdodDo1NDZweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA2MzcgNTQ2IiB3aWR0aD0iNjM3cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48IS0tY2x1c3RlciBQcm9kdWN0LS0+PGcgaWQ9ImNsdXN0ZXJfUHJvZHVjdCI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyNTYuNTkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjQzMiIgeD0iMTk5IiB5PSIyODMuNiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2MiIgeD0iMzg0IiB5PSIyOTguNTk1MSI+UHJvZHVjdDwvdGV4dD48L2c+PCEtLWNsYXNzIElQcm9kdWN0LS0+PGcgaWQ9ImVsZW1fSVByb2R1Y3QiPjxyZWN0IGNvZGVMaW5lPSI0IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJJUHJvZHVjdCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTAyIiB4PSIzNjgiIHk9IjMyNi42Ii8+PGVsbGlwc2UgY3g9IjM4OC44NSIgY3k9IjM0Mi42IiBmaWxsPSIjQjRBN0U1IiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTM4NC43NzE5LDMzOC4zNjU2IEwzODQuNzcxOSwzMzYuMjA5NCBMMzkyLjE2MjUsMzM2LjIwOTQgTDM5Mi4xNjI1LDMzOC4zNjU2IEwzODkuNjkzOCwzMzguMzY1NiBMMzg5LjY5MzgsMzQ2LjQ0MzggTDM5Mi4xNjI1LDM0Ni40NDM4IEwzOTIuMTYyNSwzNDguNiBMMzg0Ljc3MTksMzQ4LjYgTDM4NC43NzE5LDM0Ni40NDM4IEwzODcuMjQwNiwzNDYuNDQzOCBMMzg3LjI0MDYsMzM4LjM2NTYgTDM4NC43NzE5LDMzOC4zNjU2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtc3R5bGU9Iml0YWxpYyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NyIgeD0iNDA0LjE1IiB5PSIzNDcuNDQ2NyI+SVByb2R1Y3Q8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMzY5IiB4Mj0iNDY5IiB5MT0iMzU4LjYiIHkyPSIzNTguNiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjM2OSIgeDI9IjQ2OSIgeTE9IjM2Ni42IiB5Mj0iMzY2LjYiLz48ZWxsaXBzZSBjeD0iMzc5IiBjeT0iMzgwLjI0ODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzYiIHg9IjM4OCIgeT0iMzgzLjU5NTEiPnZvaWQgZGVzYygpPC90ZXh0PjwvZz48IS0tY2xhc3MgUGhvbmUtLT48ZyBpZD0iZWxlbV9QaG9uZSI+PHJlY3QgY29kZUxpbmU9IjciIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNjQuMjk2OSIgaWQ9IlBob25lIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMDIiIHg9IjIzMSIgeT0iNDUxLjg5Ii8+PGVsbGlwc2UgY3g9IjI1Ny4yNSIgY3k9IjQ2Ny44OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0yNjAuMjE4OCw0NzMuNTMwNiBRMjU5LjY0MDYsNDczLjgyNzUgMjU5LDQ3My45NjgxIFEyNTguMzU5NCw0NzQuMTI0NCAyNTcuNjU2Myw0NzQuMTI0NCBRMjU1LjE1NjMsNDc0LjEyNDQgMjUzLjgyODEsNDcyLjQ4MzggUTI1Mi41MTU2LDQ3MC44Mjc1IDI1Mi41MTU2LDQ2Ny43MDI1IFEyNTIuNTE1Niw0NjQuNTc3NSAyNTMuODI4MSw0NjIuOTIxMyBRMjU1LjE1NjMsNDYxLjI2NSAyNTcuNjU2Myw0NjEuMjY1IFEyNTguMzU5NCw0NjEuMjY1IDI1OSw0NjEuNDIxMyBRMjU5LjY1NjMsNDYxLjU3NzUgMjYwLjIxODgsNDYxLjg3NDQgTDI2MC4yMTg4LDQ2NC41OTMxIFEyNTkuNTkzOCw0NjQuMDE1IDI1OSw0NjMuNzQ5NCBRMjU4LjQwNjMsNDYzLjQ2ODEgMjU3Ljc4MTMsNDYzLjQ2ODEgUTI1Ni40Mzc1LDQ2My40NjgxIDI1NS43NSw0NjQuNTQ2MyBRMjU1LjA2MjUsNDY1LjYwODggMjU1LjA2MjUsNDY3LjcwMjUgUTI1NS4wNjI1LDQ2OS43OTYzIDI1NS43NSw0NzAuODc0NCBRMjU2LjQzNzUsNDcxLjkzNjkgMjU3Ljc4MTMsNDcxLjkzNjkgUTI1OC40MDYzLDQ3MS45MzY5IDI1OSw0NzEuNjcxMyBRMjU5LjU5MzgsNDcxLjM5IDI2MC4yMTg4LDQ3MC44MTE5IEwyNjAuMjE4OCw0NzMuNTMwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ1IiB4PSIyNzMuNzUiIHk9IjQ3Mi43MzY3Ij5QaG9uZTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyMzIiIHgyPSIzMzIiIHkxPSI0ODMuODkiIHkyPSI0ODMuODkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyMzIiIHgyPSIzMzIiIHkxPSI0OTEuODkiIHkyPSI0OTEuODkiLz48ZWxsaXBzZSBjeD0iMjQyIiBjeT0iNTA1LjUzODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzYiIHg9IjI1MSIgeT0iNTA4Ljg4NTEiPnZvaWQgZGVzYygpPC90ZXh0PjwvZz48IS0tY2xhc3MgTGFwdG9wLS0+PGcgaWQ9ImVsZW1fTGFwdG9wIj48cmVjdCBjb2RlTGluZT0iMTAiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNjQuMjk2OSIgaWQ9IkxhcHRvcCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTAyIiB4PSIzNjgiIHk9IjQ1MS44OSIvPjxlbGxpcHNlIGN4PSIzOTMuMzUiIGN5PSI0NjcuODkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMzk2LjMxODgsNDczLjUzMDYgUTM5NS43NDA2LDQ3My44Mjc1IDM5NS4xLDQ3My45NjgxIFEzOTQuNDU5NCw0NzQuMTI0NCAzOTMuNzU2Myw0NzQuMTI0NCBRMzkxLjI1NjMsNDc0LjEyNDQgMzg5LjkyODEsNDcyLjQ4MzggUTM4OC42MTU2LDQ3MC44Mjc1IDM4OC42MTU2LDQ2Ny43MDI1IFEzODguNjE1Niw0NjQuNTc3NSAzODkuOTI4MSw0NjIuOTIxMyBRMzkxLjI1NjMsNDYxLjI2NSAzOTMuNzU2Myw0NjEuMjY1IFEzOTQuNDU5NCw0NjEuMjY1IDM5NS4xLDQ2MS40MjEzIFEzOTUuNzU2Myw0NjEuNTc3NSAzOTYuMzE4OCw0NjEuODc0NCBMMzk2LjMxODgsNDY0LjU5MzEgUTM5NS42OTM4LDQ2NC4wMTUgMzk1LjEsNDYzLjc0OTQgUTM5NC41MDYzLDQ2My40NjgxIDM5My44ODEzLDQ2My40NjgxIFEzOTIuNTM3NSw0NjMuNDY4MSAzOTEuODUsNDY0LjU0NjMgUTM5MS4xNjI1LDQ2NS42MDg4IDM5MS4xNjI1LDQ2Ny43MDI1IFEzOTEuMTYyNSw0NjkuNzk2MyAzOTEuODUsNDcwLjg3NDQgUTM5Mi41Mzc1LDQ3MS45MzY5IDM5My44ODEzLDQ3MS45MzY5IFEzOTQuNTA2Myw0NzEuOTM2OSAzOTUuMSw0NzEuNjcxMyBRMzk1LjY5MzgsNDcxLjM5IDM5Ni4zMTg4LDQ3MC44MTE5IEwzOTYuMzE4OCw0NzMuNTMwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ3IiB4PSI0MDkuNjUiIHk9IjQ3Mi43MzY3Ij5MYXB0b3A8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMzY5IiB4Mj0iNDY5IiB5MT0iNDgzLjg5IiB5Mj0iNDgzLjg5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMzY5IiB4Mj0iNDY5IiB5MT0iNDkxLjg5IiB5Mj0iNDkxLjg5Ii8+PGVsbGlwc2UgY3g9IjM3OSIgY3k9IjUwNS41Mzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc2IiB4PSIzODgiIHk9IjUwOC44ODUxIj52b2lkIGRlc2MoKTwvdGV4dD48L2c+PCEtLWNsYXNzIEVhcnBob25lLS0+PGcgaWQ9ImVsZW1fRWFycGhvbmUiPjxyZWN0IGNvZGVMaW5lPSIxMyIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iRWFycGhvbmUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMiIgeD0iNTA1IiB5PSI0NTEuODkiLz48ZWxsaXBzZSBjeD0iNTIxLjM1IiBjeT0iNDY3Ljg5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTUyNC4zMTg4LDQ3My41MzA2IFE1MjMuNzQwNiw0NzMuODI3NSA1MjMuMSw0NzMuOTY4MSBRNTIyLjQ1OTQsNDc0LjEyNDQgNTIxLjc1NjMsNDc0LjEyNDQgUTUxOS4yNTYzLDQ3NC4xMjQ0IDUxNy45MjgxLDQ3Mi40ODM4IFE1MTYuNjE1Niw0NzAuODI3NSA1MTYuNjE1Niw0NjcuNzAyNSBRNTE2LjYxNTYsNDY0LjU3NzUgNTE3LjkyODEsNDYyLjkyMTMgUTUxOS4yNTYzLDQ2MS4yNjUgNTIxLjc1NjMsNDYxLjI2NSBRNTIyLjQ1OTQsNDYxLjI2NSA1MjMuMSw0NjEuNDIxMyBRNTIzLjc1NjMsNDYxLjU3NzUgNTI0LjMxODgsNDYxLjg3NDQgTDUyNC4zMTg4LDQ2NC41OTMxIFE1MjMuNjkzOCw0NjQuMDE1IDUyMy4xLDQ2My43NDk0IFE1MjIuNTA2Myw0NjMuNDY4MSA1MjEuODgxMyw0NjMuNDY4MSBRNTIwLjUzNzUsNDYzLjQ2ODEgNTE5Ljg1LDQ2NC41NDYzIFE1MTkuMTYyNSw0NjUuNjA4OCA1MTkuMTYyNSw0NjcuNzAyNSBRNTE5LjE2MjUsNDY5Ljc5NjMgNTE5Ljg1LDQ3MC44NzQ0IFE1MjAuNTM3NSw0NzEuOTM2OSA1MjEuODgxMyw0NzEuOTM2OSBRNTIyLjUwNjMsNDcxLjkzNjkgNTIzLjEsNDcxLjY3MTMgUTUyMy42OTM4LDQ3MS4zOSA1MjQuMzE4OCw0NzAuODExOSBMNTI0LjMxODgsNDczLjUzMDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2NyIgeD0iNTM1LjY1IiB5PSI0NzIuNzM2NyI+RWFycGhvbmU8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTA2IiB4Mj0iNjA2IiB5MT0iNDgzLjg5IiB5Mj0iNDgzLjg5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTA2IiB4Mj0iNjA2IiB5MT0iNDkxLjg5IiB5Mj0iNDkxLjg5Ii8+PGVsbGlwc2UgY3g9IjUxNiIgY3k9IjUwNS41Mzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc2IiB4PSI1MjUiIHk9IjUwOC44ODUxIj52b2lkIGRlc2MoKTwvdGV4dD48L2c+PCEtLWNsYXNzIFNpbXBsZUZhY3RvcnktLT48ZyBpZD0iZWxlbV9TaW1wbGVGYWN0b3J5Ij48cmVjdCBjb2RlTGluZT0iMTgiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iODAuNTkzOCIgaWQ9IlNpbXBsZUZhY3RvcnkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQwMCIgeD0iNyIgeT0iMTMyIi8+PGVsbGlwc2UgY3g9IjE1NC43NSIgY3k9IjE0OCIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0xNTcuNzE4OCwxNTMuNjQwNiBRMTU3LjE0MDYsMTUzLjkzNzUgMTU2LjUsMTU0LjA3ODEgUTE1NS44NTk0LDE1NC4yMzQ0IDE1NS4xNTYzLDE1NC4yMzQ0IFExNTIuNjU2MywxNTQuMjM0NCAxNTEuMzI4MSwxNTIuNTkzOCBRMTUwLjAxNTYsMTUwLjkzNzUgMTUwLjAxNTYsMTQ3LjgxMjUgUTE1MC4wMTU2LDE0NC42ODc1IDE1MS4zMjgxLDE0My4wMzEzIFExNTIuNjU2MywxNDEuMzc1IDE1NS4xNTYzLDE0MS4zNzUgUTE1NS44NTk0LDE0MS4zNzUgMTU2LjUsMTQxLjUzMTMgUTE1Ny4xNTYzLDE0MS42ODc1IDE1Ny43MTg4LDE0MS45ODQ0IEwxNTcuNzE4OCwxNDQuNzAzMSBRMTU3LjA5MzgsMTQ0LjEyNSAxNTYuNSwxNDMuODU5NCBRMTU1LjkwNjMsMTQzLjU3ODEgMTU1LjI4MTMsMTQzLjU3ODEgUTE1My45Mzc1LDE0My41NzgxIDE1My4yNSwxNDQuNjU2MyBRMTUyLjU2MjUsMTQ1LjcxODggMTUyLjU2MjUsMTQ3LjgxMjUgUTE1Mi41NjI1LDE0OS45MDYzIDE1My4yNSwxNTAuOTg0NCBRMTUzLjkzNzUsMTUyLjA0NjkgMTU1LjI4MTMsMTUyLjA0NjkgUTE1NS45MDYzLDE1Mi4wNDY5IDE1Ni41LDE1MS43ODEzIFExNTcuMDkzOCwxNTEuNSAxNTcuNzE4OCwxNTAuOTIxOSBMMTU3LjcxODgsMTUzLjY0MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NiIgeD0iMTc1LjI1IiB5PSIxNTIuODQ2NyI+U2ltcGxlRmFjdG9yeTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI4IiB4Mj0iNDA2IiB5MT0iMTY0IiB5Mj0iMTY0Ii8+PGVsbGlwc2UgY3g9IjE4IiBjeT0iMTc3LjY0ODQiIGZpbGw9Im5vbmUiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU3IiB4PSIyNyIgeT0iMTgwLjk5NTEiPmVudW0gUFJPRFVDVF9UWVBFPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjgiIHgyPSI0MDYiIHkxPSIxODguMjk2OSIgeTI9IjE4OC4yOTY5Ii8+PGVsbGlwc2UgY3g9IjE4IiBjeT0iMjAxLjk0NTMiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjM3NCIgeD0iMjciIHk9IjIwNS4yOTIiPklQcm9kdWN0IGNyZWF0ZVByb2R1Y3QoUFJPRFVDVF9UWVBFIHByb2R1Y3RUeXBlKTwvdGV4dD48L2c+PCEtLWNsYXNzIFNpbXBsZUZhY3RvcnlNYWluLS0+PGcgaWQ9ImVsZW1fU2ltcGxlRmFjdG9yeU1haW4iPjxyZWN0IGNvZGVMaW5lPSIyMyIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0OCIgaWQ9IlNpbXBsZUZhY3RvcnlNYWluIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNjAiIHg9IjEyNyIgeT0iNyIvPjxlbGxpcHNlIGN4PSIxNDIiIGN5PSIyMyIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0xNDQuOTY4OCwyOC42NDA2IFExNDQuMzkwNiwyOC45Mzc1IDE0My43NSwyOS4wNzgxIFExNDMuMTA5NCwyOS4yMzQ0IDE0Mi40MDYzLDI5LjIzNDQgUTEzOS45MDYzLDI5LjIzNDQgMTM4LjU3ODEsMjcuNTkzOCBRMTM3LjI2NTYsMjUuOTM3NSAxMzcuMjY1NiwyMi44MTI1IFExMzcuMjY1NiwxOS42ODc1IDEzOC41NzgxLDE4LjAzMTMgUTEzOS45MDYzLDE2LjM3NSAxNDIuNDA2MywxNi4zNzUgUTE0My4xMDk0LDE2LjM3NSAxNDMuNzUsMTYuNTMxMyBRMTQ0LjQwNjMsMTYuNjg3NSAxNDQuOTY4OCwxNi45ODQ0IEwxNDQuOTY4OCwxOS43MDMxIFExNDQuMzQzOCwxOS4xMjUgMTQzLjc1LDE4Ljg1OTQgUTE0My4xNTYzLDE4LjU3ODEgMTQyLjUzMTMsMTguNTc4MSBRMTQxLjE4NzUsMTguNTc4MSAxNDAuNSwxOS42NTYzIFExMzkuODEyNSwyMC43MTg4IDEzOS44MTI1LDIyLjgxMjUgUTEzOS44MTI1LDI0LjkwNjMgMTQwLjUsMjUuOTg0NCBRMTQxLjE4NzUsMjcuMDQ2OSAxNDIuNTMxMywyNy4wNDY5IFExNDMuMTU2MywyNy4wNDY5IDE0My43NSwyNi43ODEzIFExNDQuMzQzOCwyNi41IDE0NC45Njg4LDI1LjkyMTkgTDE0NC45Njg4LDI4LjY0MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjgiIHg9IjE1NiIgeT0iMjcuODQ2NyI+U2ltcGxlRmFjdG9yeU1haW48L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTI4IiB4Mj0iMjg2IiB5MT0iMzkiIHkyPSIzOSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjEyOCIgeDI9IjI4NiIgeTE9IjQ3IiB5Mj0iNDciLz48L2c+PCEtLXJldmVyc2UgbGluayBJUHJvZHVjdCB0byBQaG9uZS0tPjxnIGlkPSJsaW5rX0lQcm9kdWN0X1Bob25lIj48cGF0aCBkPSJNMzcwLjY5MSw0MDMuMjIxNyBDMzUwLjA4MSw0MjEuNzcxNyAzMzcuNDYsNDMzLjEzIDMxNi44Niw0NTEuNjcgIiBmaWxsPSJub25lIiBpZD0iSVByb2R1Y3QtYmFja3RvLVBob25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSIzODQuMDcsMzkxLjE4LDM2Ni42NzcxLDM5OC43NjIxLDM3NC43MDQ5LDQwNy42ODE0LDM4NC4wNywzOTEuMTgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIElQcm9kdWN0IHRvIExhcHRvcC0tPjxnIGlkPSJsaW5rX0lQcm9kdWN0X0xhcHRvcCI+PHBhdGggZD0iTTQxOSw0MDkuMTggQzQxOSw0MjcuNzMgNDE5LDQzMy4xMyA0MTksNDUxLjY3ICIgZmlsbD0ibm9uZSIgaWQ9IklQcm9kdWN0LWJhY2t0by1MYXB0b3AiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjQxOSwzOTEuMTgsNDEzLDQwOS4xOCw0MjUsNDA5LjE4LDQxOSwzOTEuMTgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIElQcm9kdWN0IHRvIEVhcnBob25lLS0+PGcgaWQ9ImxpbmtfSVByb2R1Y3RfRWFycGhvbmUiPjxwYXRoIGQ9Ik00NjcuMzA5LDQwMy4yMjE3IEM0ODcuOTE5LDQyMS43NzE3IDUwMC41NCw0MzMuMTMgNTIxLjE0LDQ1MS42NyAiIGZpbGw9Im5vbmUiIGlkPSJJUHJvZHVjdC1iYWNrdG8tRWFycGhvbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjQ1My45MywzOTEuMTgsNDYzLjI5NTEsNDA3LjY4MTQsNDcxLjMyMjksMzk4Ljc2MjEsNDUzLjkzLDM5MS4xOCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1saW5rIFNpbXBsZUZhY3RvcnkgdG8gUHJvZHVjdC0tPjxnIGlkPSJsaW5rX1NpbXBsZUZhY3RvcnlfUHJvZHVjdCI+PHBhdGggY29kZUxpbmU9IjI2IiBkPSJNMjA3LDIxMi44NyBDMjA3LDIyNi4yMDc1IDIwNywyNDEuNzU0NCAyMDcsMjU3LjYxNTUgQzIwNywyNjUuNTQ2IDIwNywyNzMuNTU1MSAyMDcsMjgxLjQwNTkgQzIwNywyODEuODk2NiAyMDcsMjc2LjM4NjYgMjA3LDI3Ni44NzYgIiBmaWxsPSJub25lIiBpZD0iU2ltcGxlRmFjdG9yeS10by1Qcm9kdWN0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyMDcsMjgyLjg3NiwyMTEsMjczLjg3NiwyMDcsMjc3Ljg3NiwyMDMsMjczLjg3NiwyMDcsMjgyLjg3NiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTYzIiB4PSIyMDgiIHk9IjI1NS42NjY5Ij5jcmVhdGUgYnkgUFJPRFVDVF9UWVBFPC90ZXh0PjwvZz48IS0tbGluayBTaW1wbGVGYWN0b3J5TWFpbiB0byBTaW1wbGVGYWN0b3J5LS0+PGcgaWQ9ImxpbmtfU2ltcGxlRmFjdG9yeU1haW5fU2ltcGxlRmFjdG9yeSI+PHBhdGggY29kZUxpbmU9IjI3IiBkPSJNMjA3LDU1LjMyIEMyMDcsNzYuMDcgMjA3LDEwMC44OCAyMDcsMTI1LjUzICIgZmlsbD0ibm9uZSIgaWQ9IlNpbXBsZUZhY3RvcnlNYWluLXRvLVNpbXBsZUZhY3RvcnkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjIwNywxMzEuNTMsMjExLDEyMi41MywyMDcsMTI2LjUzLDIwMywxMjIuNTMsMjA3LDEzMS41MyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjMiIHg9IjIwOCIgeT0iOTguMDY2OSI+dXNlPC90ZXh0PjwvZz48IS0tU1JDPVtmUDdESXlEMDRDTmwtclZDcFBQWVNXeWI1d3FXajFYZ0Y3WUlTSkVjWV9sNXhhRzg5Vi14UUg4X1dkWW1wYzVYdC1weGxHVHhTTTNzQ0tqSmh6NW9PdEdZZEtjYm5YV2xBdUxyRzJFNEhfY0FESzRITkRMOFhsTHdKdkJIcmZobzc4dTItYjZNQVJvVzlCWnpVM09rSmhFMkR3U2dnMlpBbk45R2stNFNTZzB1RTRrV1pEVGFvN0J5RXM2QmRmdF81c0EzbVBfUGVuRFlQRG1GdFhrS3g0OHhjTFAwalo1R3hFLWs3d3hBZl9BbnM0cHdDSkFvYWpyTlowbzRKRERqeVRxMlZYSkJyakZvYnkwVEFqazd6aWp2Wm9KOUZ0eWtjcEJXa1ByTi1hYXdzVVFXMzlmOHVYcTBdLS0+PC9nPjwvc3ZnPg=='><h2 id="12-code-example"><a class="markdownIt-Anchor" href="#12-code-example"></a> 1.2. Code Example</h2><p>Product Interface and Concrete Product Classes:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="comment">// product description</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Phone</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am a phone.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Laptop</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am a laptop.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Earphone</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am a earphone.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The factory class in the Simple Factory Pattern is responsible for creating various products and providing a unified public product interface for returning them.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">PRODUCT_TYPE</span> &#123;</span><br><span class="line">        PHONE,</span><br><span class="line">        LAPTOP,</span><br><span class="line">        EARPHONE</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new product object according to the product type</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> productType</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> IProduct <span class="title function_">createProduct</span><span class="params">(PRODUCT_TYPE productType)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != productType) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (productType) &#123;</span><br><span class="line">                <span class="keyword">case</span> PHONE:</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Phone</span>();</span><br><span class="line">                <span class="keyword">case</span> LAPTOP:</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Laptop</span>();</span><br><span class="line">                <span class="keyword">case</span> EARPHONE:</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Earphone</span>();</span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Usage of the Simple Factory:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleFactoryMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">phone</span> <span class="operator">=</span> SimpleFactory.createProduct(SimpleFactory.PRODUCT_TYPE.PHONE);</span><br><span class="line">        phone.desc();</span><br><span class="line"></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">laptop</span> <span class="operator">=</span> SimpleFactory.createProduct(SimpleFactory.PRODUCT_TYPE.LAPTOP);</span><br><span class="line">        laptop.desc();</span><br><span class="line"></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">earphone</span> <span class="operator">=</span> SimpleFactory.createProduct(SimpleFactory.PRODUCT_TYPE.EARPHONE);</span><br><span class="line">        earphone.desc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Execution Result:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I am a phone.</span><br><span class="line">I am a laptop.</span><br><span class="line">I am a earphone.</span><br></pre></td></tr></table></figure><h1 id="2-factory-method-pattern"><a class="markdownIt-Anchor" href="#2-factory-method-pattern"></a> 2. Factory Method Pattern</h1><p><strong>Factory Method Pattern</strong>, also known as the <strong>Polymorphic Factory Pattern</strong>, is a creational pattern classified among the three major categories of design patterns. It defines an interface for creating objects, but the subclasses determine which class to instantiate, meaning the Factory Method Pattern defers instantiation to the subclasses.</p><p>Compared to <a href="#1-simple-factory-pattern">1. Simple Factory Pattern</a>, the core factory class no longer handles the creation of all products; instead, it delegates the actual work (such as creating products) to specific subclasses. The core factory class becomes an abstract factory role, which only defines the public interface that concrete factory subclasses must implement, without handling the specific details of any particular product.</p><p><strong>Pros:</strong></p><ol><li>Users only need to concern themselves with the factory corresponding to the desired product to obtain the necessary product, without worrying about the specific creation logic of the product.</li><li>When new products are added, only the corresponding factory class needs to be added, providing good extensibility and adhering to the Open-Closed Principle.</li></ol><p><strong>Cons:</strong></p><ol><li>As the number of products increases, it can lead to a proliferation of classes, increasing complexity and making the system harder to understand.</li><li>The abstract product can only produce one type of product; this issue can be resolved using the Abstract Factory Pattern.</li></ol><p><strong>Scenarios:</strong></p><ol><li>The client only knows the factory name corresponding to the product and not the specific product names, such as Phone Factory, Laptop Factory, etc.</li><li>The task of creating objects is completed by one of several concrete subclasses, while the abstract factory only provides the interface for creating products.</li><li>The client is not concerned with the details of product creation but only cares about the production factory.</li><li>When you need a laptop, you can directly obtain it from the factory that produces laptops, without needing to know how the laptop is manufactured or the specific implementation of that laptop.</li></ol><h2 id="21-structure-and-implementation"><a class="markdownIt-Anchor" href="#21-structure-and-implementation"></a> 2.1 Structure and Implementation</h2><p>The main roles in the Factory Method Pattern are as follows:</p><ul><li><strong>Abstract Factory (IFactory)</strong>: Provides the interface for creating products, allowing the caller to access the specific factory’s factory method <code>createProduct()</code> to create products.</li><li><strong>Concrete Factories (PhoneFactory, LaptopFactory, EarphoneFactory)</strong>: Implement the methods defined in the abstract factory, completing the creation of specific products.</li><li><strong>Abstract Product (IProduct)</strong>: Defines the specifications for the product, describing the main characteristics and functionalities of the product.</li><li><strong>Concrete Products (Phone, Laptop, Earphone)</strong>: Implement the interfaces defined by the abstract product role and are created by specific factories, corresponding one-to-one with the concrete factories.</li></ul><p>The class diagram is as follows:</p><img class="kroki" src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXMtYXNjaWkiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSI1NjBweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjEyMzhweDtoZWlnaHQ6NTYwcHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMTIzOCA1NjAiIHdpZHRoPSIxMjM4cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48IS0tY2x1c3RlciBQcm9kdWN0LS0+PGcgaWQ9ImNsdXN0ZXJfUHJvZHVjdCI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyNzQuNTkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjQwOCIgeD0iODI0LjUiIHk9IjI4MC4zIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjYyIiB4PSI5OTcuNSIgeT0iMjk1LjI5NTEiPlByb2R1Y3Q8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIEZhY3RvcnktLT48ZyBpZD0iY2x1c3Rlcl9GYWN0b3J5Ij48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjI3Ny41OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7IiB3aWR0aD0iNzEwIiB4PSI4Mi41IiB5PSIxMjYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTkiIHg9IjQwOCIgeT0iMTQwLjk5NTEiPkZhY3Rvcnk8L3RleHQ+PC9nPjwhLS1jbGFzcyBJUHJvZHVjdC0tPjxnIGlkPSJlbGVtX0lQcm9kdWN0Ij48cmVjdCBjb2RlTGluZT0iNCIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iSVByb2R1Y3QiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMiIgeD0iOTc3LjUiIHk9IjMxNS4zIi8+PGVsbGlwc2UgY3g9Ijk5OC4zNSIgY3k9IjMzMS4zIiBmaWxsPSIjQjRBN0U1IiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTk5NC4yNzE5LDMyNy4wNjU2IEw5OTQuMjcxOSwzMjQuOTA5NCBMMTAwMS42NjI1LDMyNC45MDk0IEwxMDAxLjY2MjUsMzI3LjA2NTYgTDk5OS4xOTM4LDMyNy4wNjU2IEw5OTkuMTkzOCwzMzUuMTQzNyBMMTAwMS42NjI1LDMzNS4xNDM3IEwxMDAxLjY2MjUsMzM3LjMgTDk5NC4yNzE5LDMzNy4zIEw5OTQuMjcxOSwzMzUuMTQzNyBMOTk2Ljc0MDYsMzM1LjE0MzcgTDk5Ni43NDA2LDMyNy4wNjU2IEw5OTQuMjcxOSwzMjcuMDY1NiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXN0eWxlPSJpdGFsaWMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTciIHg9IjEwMTMuNjUiIHk9IjMzNi4xNDY3Ij5JUHJvZHVjdDwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI5NzguNSIgeDI9IjEwNzguNSIgeTE9IjM0Ny4zIiB5Mj0iMzQ3LjMiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI5NzguNSIgeDI9IjEwNzguNSIgeTE9IjM1NS4zIiB5Mj0iMzU1LjMiLz48ZWxsaXBzZSBjeD0iOTg4LjUiIGN5PSIzNjguOTQ4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NiIgeD0iOTk3LjUiIHk9IjM3Mi4yOTUxIj52b2lkIGRlc2MoKTwvdGV4dD48L2c+PCEtLWNsYXNzIFBob25lLS0+PGcgaWQ9ImVsZW1fUGhvbmUiPjxyZWN0IGNvZGVMaW5lPSI3IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJQaG9uZSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTAyIiB4PSI4NDAuNSIgeT0iNDc0LjU5Ii8+PGVsbGlwc2UgY3g9Ijg2Ni43NSIgY3k9IjQ5MC41OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik04NjkuNzE4OCw0OTYuMjMwNiBRODY5LjE0MDYsNDk2LjUyNzUgODY4LjUsNDk2LjY2ODEgUTg2Ny44NTk0LDQ5Ni44MjQ0IDg2Ny4xNTYzLDQ5Ni44MjQ0IFE4NjQuNjU2Myw0OTYuODI0NCA4NjMuMzI4MSw0OTUuMTgzOCBRODYyLjAxNTYsNDkzLjUyNzUgODYyLjAxNTYsNDkwLjQwMjUgUTg2Mi4wMTU2LDQ4Ny4yNzc1IDg2My4zMjgxLDQ4NS42MjEzIFE4NjQuNjU2Myw0ODMuOTY1IDg2Ny4xNTYzLDQ4My45NjUgUTg2Ny44NTk0LDQ4My45NjUgODY4LjUsNDg0LjEyMTMgUTg2OS4xNTYzLDQ4NC4yNzc1IDg2OS43MTg4LDQ4NC41NzQ0IEw4NjkuNzE4OCw0ODcuMjkzMSBRODY5LjA5MzgsNDg2LjcxNSA4NjguNSw0ODYuNDQ5NCBRODY3LjkwNjMsNDg2LjE2ODEgODY3LjI4MTMsNDg2LjE2ODEgUTg2NS45Mzc1LDQ4Ni4xNjgxIDg2NS4yNSw0ODcuMjQ2MyBRODY0LjU2MjUsNDg4LjMwODggODY0LjU2MjUsNDkwLjQwMjUgUTg2NC41NjI1LDQ5Mi40OTYzIDg2NS4yNSw0OTMuNTc0NCBRODY1LjkzNzUsNDk0LjYzNjkgODY3LjI4MTMsNDk0LjYzNjkgUTg2Ny45MDYzLDQ5NC42MzY5IDg2OC41LDQ5NC4zNzEzIFE4NjkuMDkzOCw0OTQuMDkgODY5LjcxODgsNDkzLjUxMTkgTDg2OS43MTg4LDQ5Ni4yMzA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDUiIHg9Ijg4My4yNSIgeT0iNDk1LjQzNjciPlBob25lPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9Ijg0MS41IiB4Mj0iOTQxLjUiIHkxPSI1MDYuNTkiIHkyPSI1MDYuNTkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI4NDEuNSIgeDI9Ijk0MS41IiB5MT0iNTE0LjU5IiB5Mj0iNTE0LjU5Ii8+PGVsbGlwc2UgY3g9Ijg1MS41IiBjeT0iNTI4LjIzODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzYiIHg9Ijg2MC41IiB5PSI1MzEuNTg1MSI+dm9pZCBkZXNjKCk8L3RleHQ+PC9nPjwhLS1jbGFzcyBMYXB0b3AtLT48ZyBpZD0iZWxlbV9MYXB0b3AiPjxyZWN0IGNvZGVMaW5lPSIxMCIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iTGFwdG9wIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMDIiIHg9Ijk3Ny41IiB5PSI0NzQuNTkiLz48ZWxsaXBzZSBjeD0iMTAwMi44NSIgY3k9IjQ5MC41OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0xMDA1LjgxODgsNDk2LjIzMDYgUTEwMDUuMjQwNiw0OTYuNTI3NSAxMDA0LjYsNDk2LjY2ODEgUTEwMDMuOTU5NCw0OTYuODI0NCAxMDAzLjI1NjMsNDk2LjgyNDQgUTEwMDAuNzU2Myw0OTYuODI0NCA5OTkuNDI4MSw0OTUuMTgzOCBROTk4LjExNTYsNDkzLjUyNzUgOTk4LjExNTYsNDkwLjQwMjUgUTk5OC4xMTU2LDQ4Ny4yNzc1IDk5OS40MjgxLDQ4NS42MjEzIFExMDAwLjc1NjMsNDgzLjk2NSAxMDAzLjI1NjMsNDgzLjk2NSBRMTAwMy45NTk0LDQ4My45NjUgMTAwNC42LDQ4NC4xMjEzIFExMDA1LjI1NjMsNDg0LjI3NzUgMTAwNS44MTg4LDQ4NC41NzQ0IEwxMDA1LjgxODgsNDg3LjI5MzEgUTEwMDUuMTkzOCw0ODYuNzE1IDEwMDQuNiw0ODYuNDQ5NCBRMTAwNC4wMDYzLDQ4Ni4xNjgxIDEwMDMuMzgxMyw0ODYuMTY4MSBRMTAwMi4wMzc1LDQ4Ni4xNjgxIDEwMDEuMzUsNDg3LjI0NjMgUTEwMDAuNjYyNSw0ODguMzA4OCAxMDAwLjY2MjUsNDkwLjQwMjUgUTEwMDAuNjYyNSw0OTIuNDk2MyAxMDAxLjM1LDQ5My41NzQ0IFExMDAyLjAzNzUsNDk0LjYzNjkgMTAwMy4zODEzLDQ5NC42MzY5IFExMDA0LjAwNjMsNDk0LjYzNjkgMTAwNC42LDQ5NC4zNzEzIFExMDA1LjE5MzgsNDk0LjA5IDEwMDUuODE4OCw0OTMuNTExOSBMMTAwNS44MTg4LDQ5Ni4yMzA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDciIHg9IjEwMTkuMTUiIHk9IjQ5NS40MzY3Ij5MYXB0b3A8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOTc4LjUiIHgyPSIxMDc4LjUiIHkxPSI1MDYuNTkiIHkyPSI1MDYuNTkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI5NzguNSIgeDI9IjEwNzguNSIgeTE9IjUxNC41OSIgeTI9IjUxNC41OSIvPjxlbGxpcHNlIGN4PSI5ODguNSIgY3k9IjUyOC4yMzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc2IiB4PSI5OTcuNSIgeT0iNTMxLjU4NTEiPnZvaWQgZGVzYygpPC90ZXh0PjwvZz48IS0tY2xhc3MgRWFycGhvbmUtLT48ZyBpZD0iZWxlbV9FYXJwaG9uZSI+PHJlY3QgY29kZUxpbmU9IjEzIiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJFYXJwaG9uZSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTAyIiB4PSIxMTE0LjUiIHk9IjQ3NC41OSIvPjxlbGxpcHNlIGN4PSIxMTMwLjg1IiBjeT0iNDkwLjU5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTExMzMuODE4OCw0OTYuMjMwNiBRMTEzMy4yNDA2LDQ5Ni41Mjc1IDExMzIuNiw0OTYuNjY4MSBRMTEzMS45NTk0LDQ5Ni44MjQ0IDExMzEuMjU2Myw0OTYuODI0NCBRMTEyOC43NTYzLDQ5Ni44MjQ0IDExMjcuNDI4MSw0OTUuMTgzOCBRMTEyNi4xMTU2LDQ5My41Mjc1IDExMjYuMTE1Niw0OTAuNDAyNSBRMTEyNi4xMTU2LDQ4Ny4yNzc1IDExMjcuNDI4MSw0ODUuNjIxMyBRMTEyOC43NTYzLDQ4My45NjUgMTEzMS4yNTYzLDQ4My45NjUgUTExMzEuOTU5NCw0ODMuOTY1IDExMzIuNiw0ODQuMTIxMyBRMTEzMy4yNTYzLDQ4NC4yNzc1IDExMzMuODE4OCw0ODQuNTc0NCBMMTEzMy44MTg4LDQ4Ny4yOTMxIFExMTMzLjE5MzgsNDg2LjcxNSAxMTMyLjYsNDg2LjQ0OTQgUTExMzIuMDA2Myw0ODYuMTY4MSAxMTMxLjM4MTMsNDg2LjE2ODEgUTExMzAuMDM3NSw0ODYuMTY4MSAxMTI5LjM1LDQ4Ny4yNDYzIFExMTI4LjY2MjUsNDg4LjMwODggMTEyOC42NjI1LDQ5MC40MDI1IFExMTI4LjY2MjUsNDkyLjQ5NjMgMTEyOS4zNSw0OTMuNTc0NCBRMTEzMC4wMzc1LDQ5NC42MzY5IDExMzEuMzgxMyw0OTQuNjM2OSBRMTEzMi4wMDYzLDQ5NC42MzY5IDExMzIuNiw0OTQuMzcxMyBRMTEzMy4xOTM4LDQ5NC4wOSAxMTMzLjgxODgsNDkzLjUxMTkgTDExMzMuODE4OCw0OTYuMjMwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY3IiB4PSIxMTQ1LjE1IiB5PSI0OTUuNDM2NyI+RWFycGhvbmU8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTExNS41IiB4Mj0iMTIxNS41IiB5MT0iNTA2LjU5IiB5Mj0iNTA2LjU5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTExNS41IiB4Mj0iMTIxNS41IiB5MT0iNTE0LjU5IiB5Mj0iNTE0LjU5Ii8+PGVsbGlwc2UgY3g9IjExMjUuNSIgY3k9IjUyOC4yMzg0IiBmaWxsPSIjODRCRTg0IiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAzODA0ODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc2IiB4PSIxMTM0LjUiIHk9IjUzMS41ODUxIj52b2lkIGRlc2MoKTwvdGV4dD48L2c+PCEtLWNsYXNzIElGYWN0b3J5LS0+PGcgaWQ9ImVsZW1fSUZhY3RvcnkiPjxyZWN0IGNvZGVMaW5lPSIxOSIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iSUZhY3RvcnkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE5NSIgeD0iMzQ0IiB5PSIxNjkiLz48ZWxsaXBzZSBjeD0iNDEwLjc1IiBjeT0iMTg1IiBmaWxsPSIjQjRBN0U1IiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTQwNi42NzE5LDE4MC43NjU2IEw0MDYuNjcxOSwxNzguNjA5NCBMNDE0LjA2MjUsMTc4LjYwOTQgTDQxNC4wNjI1LDE4MC43NjU2IEw0MTEuNTkzOCwxODAuNzY1NiBMNDExLjU5MzgsMTg4Ljg0MzggTDQxNC4wNjI1LDE4OC44NDM4IEw0MTQuMDYyNSwxOTEgTDQwNi42NzE5LDE5MSBMNDA2LjY3MTksMTg4Ljg0MzggTDQwOS4xNDA2LDE4OC44NDM4IEw0MDkuMTQwNiwxODAuNzY1NiBMNDA2LjY3MTksMTgwLjc2NTYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC1zdHlsZT0iaXRhbGljIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUzIiB4PSI0MzEuMjUiIHk9IjE4OS44NDY3Ij5JRmFjdG9yeTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzNDUiIHgyPSI1MzgiIHkxPSIyMDEiIHkyPSIyMDEiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzNDUiIHgyPSI1MzgiIHkxPSIyMDkiIHkyPSIyMDkiLz48ZWxsaXBzZSBjeD0iMzU1IiBjeT0iMjIyLjY0ODQiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTY5IiB4PSIzNjQiIHk9IjIyNS45OTUxIj5JUHJvZHVjdCBjcmVhdGVQcm9kdWN0KCk8L3RleHQ+PC9nPjwhLS1jbGFzcyBQaG9uZUZhY3RvcnktLT48ZyBpZD0iZWxlbV9QaG9uZUZhY3RvcnkiPjxyZWN0IGNvZGVMaW5lPSIyMiIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI2NC4yOTY5IiBpZD0iUGhvbmVGYWN0b3J5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxOTUiIHg9IjExNCIgeT0iMzE1LjMiLz48ZWxsaXBzZSBjeD0iMTU5Ljc1IiBjeT0iMzMxLjMiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cGF0aCBkPSJNMTYyLjcxODgsMzM2Ljk0MDYgUTE2Mi4xNDA2LDMzNy4yMzc1IDE2MS41LDMzNy4zNzgxIFExNjAuODU5NCwzMzcuNTM0NCAxNjAuMTU2MywzMzcuNTM0NCBRMTU3LjY1NjMsMzM3LjUzNDQgMTU2LjMyODEsMzM1Ljg5MzcgUTE1NS4wMTU2LDMzNC4yMzc1IDE1NS4wMTU2LDMzMS4xMTI1IFExNTUuMDE1NiwzMjcuOTg3NSAxNTYuMzI4MSwzMjYuMzMxMiBRMTU3LjY1NjMsMzI0LjY3NSAxNjAuMTU2MywzMjQuNjc1IFExNjAuODU5NCwzMjQuNjc1IDE2MS41LDMyNC44MzEyIFExNjIuMTU2MywzMjQuOTg3NSAxNjIuNzE4OCwzMjUuMjg0NCBMMTYyLjcxODgsMzI4LjAwMzEgUTE2Mi4wOTM4LDMyNy40MjUgMTYxLjUsMzI3LjE1OTQgUTE2MC45MDYzLDMyNi44NzgxIDE2MC4yODEzLDMyNi44NzgxIFExNTguOTM3NSwzMjYuODc4MSAxNTguMjUsMzI3Ljk1NjIgUTE1Ny41NjI1LDMyOS4wMTg3IDE1Ny41NjI1LDMzMS4xMTI1IFExNTcuNTYyNSwzMzMuMjA2MiAxNTguMjUsMzM0LjI4NDQgUTE1OC45Mzc1LDMzNS4zNDY5IDE2MC4yODEzLDMzNS4zNDY5IFExNjAuOTA2MywzMzUuMzQ2OSAxNjEuNSwzMzUuMDgxMiBRMTYyLjA5MzgsMzM0LjggMTYyLjcxODgsMzM0LjIyMTkgTDE2Mi43MTg4LDMzNi45NDA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTUiIHg9IjE4MC4yNSIgeT0iMzM2LjE0NjciPlBob25lRmFjdG9yeTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxMTUiIHgyPSIzMDgiIHkxPSIzNDcuMyIgeTI9IjM0Ny4zIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTE1IiB4Mj0iMzA4IiB5MT0iMzU1LjMiIHkyPSIzNTUuMyIvPjxlbGxpcHNlIGN4PSIxMjUiIGN5PSIzNjguOTQ4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjkiIHg9IjEzNCIgeT0iMzcyLjI5NTEiPklQcm9kdWN0IGNyZWF0ZVByb2R1Y3QoKTwvdGV4dD48L2c+PCEtLWNsYXNzIExhcHRvcEZhY3RvcnktLT48ZyBpZD0iZWxlbV9MYXB0b3BGYWN0b3J5Ij48cmVjdCBjb2RlTGluZT0iMjUiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNjQuMjk2OSIgaWQ9IkxhcHRvcEZhY3RvcnkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE5NSIgeD0iMzQ0IiB5PSIzMTUuMyIvPjxlbGxpcHNlIGN4PSIzODguNzUiIGN5PSIzMzEuMyIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0zOTEuNzE4OCwzMzYuOTQwNiBRMzkxLjE0MDYsMzM3LjIzNzUgMzkwLjUsMzM3LjM3ODEgUTM4OS44NTk0LDMzNy41MzQ0IDM4OS4xNTYzLDMzNy41MzQ0IFEzODYuNjU2MywzMzcuNTM0NCAzODUuMzI4MSwzMzUuODkzNyBRMzg0LjAxNTYsMzM0LjIzNzUgMzg0LjAxNTYsMzMxLjExMjUgUTM4NC4wMTU2LDMyNy45ODc1IDM4NS4zMjgxLDMyNi4zMzEyIFEzODYuNjU2MywzMjQuNjc1IDM4OS4xNTYzLDMyNC42NzUgUTM4OS44NTk0LDMyNC42NzUgMzkwLjUsMzI0LjgzMTIgUTM5MS4xNTYzLDMyNC45ODc1IDM5MS43MTg4LDMyNS4yODQ0IEwzOTEuNzE4OCwzMjguMDAzMSBRMzkxLjA5MzgsMzI3LjQyNSAzOTAuNSwzMjcuMTU5NCBRMzg5LjkwNjMsMzI2Ljg3ODEgMzg5LjI4MTMsMzI2Ljg3ODEgUTM4Ny45Mzc1LDMyNi44NzgxIDM4Ny4yNSwzMjcuOTU2MiBRMzg2LjU2MjUsMzI5LjAxODcgMzg2LjU2MjUsMzMxLjExMjUgUTM4Ni41NjI1LDMzMy4yMDYyIDM4Ny4yNSwzMzQuMjg0NCBRMzg3LjkzNzUsMzM1LjM0NjkgMzg5LjI4MTMsMzM1LjM0NjkgUTM4OS45MDYzLDMzNS4zNDY5IDM5MC41LDMzNS4wODEyIFEzOTEuMDkzOCwzMzQuOCAzOTEuNzE4OCwzMzQuMjIxOSBMMzkxLjcxODgsMzM2Ljk0MDYgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NyIgeD0iNDA5LjI1IiB5PSIzMzYuMTQ2NyI+TGFwdG9wRmFjdG9yeTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzNDUiIHgyPSI1MzgiIHkxPSIzNDcuMyIgeTI9IjM0Ny4zIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMzQ1IiB4Mj0iNTM4IiB5MT0iMzU1LjMiIHkyPSIzNTUuMyIvPjxlbGxpcHNlIGN4PSIzNTUiIGN5PSIzNjguOTQ4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjkiIHg9IjM2NCIgeT0iMzcyLjI5NTEiPklQcm9kdWN0IGNyZWF0ZVByb2R1Y3QoKTwvdGV4dD48L2c+PCEtLWNsYXNzIEVhcnBob25lRmFjdG9yeS0tPjxnIGlkPSJlbGVtX0VhcnBob25lRmFjdG9yeSI+PHJlY3QgY29kZUxpbmU9IjI4IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjY0LjI5NjkiIGlkPSJFYXJwaG9uZUZhY3RvcnkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE5NSIgeD0iNTc0IiB5PSIzMTUuMyIvPjxlbGxpcHNlIGN4PSI2MDkuNyIgY3k9IjMzMS4zIiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTYxMi42Njg4LDMzNi45NDA2IFE2MTIuMDkwNiwzMzcuMjM3NSA2MTEuNDUsMzM3LjM3ODEgUTYxMC44MDk0LDMzNy41MzQ0IDYxMC4xMDYzLDMzNy41MzQ0IFE2MDcuNjA2MywzMzcuNTM0NCA2MDYuMjc4MSwzMzUuODkzNyBRNjA0Ljk2NTYsMzM0LjIzNzUgNjA0Ljk2NTYsMzMxLjExMjUgUTYwNC45NjU2LDMyNy45ODc1IDYwNi4yNzgxLDMyNi4zMzEyIFE2MDcuNjA2MywzMjQuNjc1IDYxMC4xMDYzLDMyNC42NzUgUTYxMC44MDk0LDMyNC42NzUgNjExLjQ1LDMyNC44MzEyIFE2MTIuMTA2MywzMjQuOTg3NSA2MTIuNjY4OCwzMjUuMjg0NCBMNjEyLjY2ODgsMzI4LjAwMzEgUTYxMi4wNDM4LDMyNy40MjUgNjExLjQ1LDMyNy4xNTk0IFE2MTAuODU2MywzMjYuODc4MSA2MTAuMjMxMywzMjYuODc4MSBRNjA4Ljg4NzUsMzI2Ljg3ODEgNjA4LjIsMzI3Ljk1NjIgUTYwNy41MTI1LDMyOS4wMTg3IDYwNy41MTI1LDMzMS4xMTI1IFE2MDcuNTEyNSwzMzMuMjA2MiA2MDguMiwzMzQuMjg0NCBRNjA4Ljg4NzUsMzM1LjM0NjkgNjEwLjIzMTMsMzM1LjM0NjkgUTYxMC44NTYzLDMzNS4zNDY5IDYxMS40NSwzMzUuMDgxMiBRNjEyLjA0MzgsMzM0LjggNjEyLjY2ODgsMzM0LjIyMTkgTDYxMi42Njg4LDMzNi45NDA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE3IiB4PSI2MjguMyIgeT0iMzM2LjE0NjciPkVhcnBob25lRmFjdG9yeTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI1NzUiIHgyPSI3NjgiIHkxPSIzNDcuMyIgeTI9IjM0Ny4zIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNTc1IiB4Mj0iNzY4IiB5MT0iMzU1LjMiIHkyPSIzNTUuMyIvPjxlbGxpcHNlIGN4PSI1ODUiIGN5PSIzNjguOTQ4NCIgZmlsbD0iIzg0QkU4NCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMzgwNDg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjkiIHg9IjU5NCIgeT0iMzcyLjI5NTEiPklQcm9kdWN0IGNyZWF0ZVByb2R1Y3QoKTwvdGV4dD48L2c+PCEtLWNsYXNzIEZhY3RvcnlNZXRob2RNYWluLS0+PGcgaWQ9ImVsZW1fRmFjdG9yeU1ldGhvZE1haW4iPjxyZWN0IGNvZGVMaW5lPSIzMyIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0OCIgaWQ9IkZhY3RvcnlNZXRob2RNYWluIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNjciIHg9IjciIHk9IjciLz48ZWxsaXBzZSBjeD0iMjIiIGN5PSIyMyIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0yNC45Njg4LDI4LjY0MDYgUTI0LjM5MDYsMjguOTM3NSAyMy43NSwyOS4wNzgxIFEyMy4xMDk0LDI5LjIzNDQgMjIuNDA2MywyOS4yMzQ0IFExOS45MDYzLDI5LjIzNDQgMTguNTc4MSwyNy41OTM4IFExNy4yNjU2LDI1LjkzNzUgMTcuMjY1NiwyMi44MTI1IFExNy4yNjU2LDE5LjY4NzUgMTguNTc4MSwxOC4wMzEzIFExOS45MDYzLDE2LjM3NSAyMi40MDYzLDE2LjM3NSBRMjMuMTA5NCwxNi4zNzUgMjMuNzUsMTYuNTMxMyBRMjQuNDA2MywxNi42ODc1IDI0Ljk2ODgsMTYuOTg0NCBMMjQuOTY4OCwxOS43MDMxIFEyNC4zNDM4LDE5LjEyNSAyMy43NSwxOC44NTk0IFEyMy4xNTYzLDE4LjU3ODEgMjIuNTMxMywxOC41NzgxIFEyMS4xODc1LDE4LjU3ODEgMjAuNSwxOS42NTYzIFExOS44MTI1LDIwLjcxODggMTkuODEyNSwyMi44MTI1IFExOS44MTI1LDI0LjkwNjMgMjAuNSwyNS45ODQ0IFEyMS4xODc1LDI3LjA0NjkgMjIuNTMxMywyNy4wNDY5IFEyMy4xNTYzLDI3LjA0NjkgMjMuNzUsMjYuNzgxMyBRMjQuMzQzOCwyNi41IDI0Ljk2ODgsMjUuOTIxOSBMMjQuOTY4OCwyOC42NDA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM1IiB4PSIzNiIgeT0iMjcuODQ2NyI+RmFjdG9yeU1ldGhvZE1haW48L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjE3MyIgeTE9IjM5IiB5Mj0iMzkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI4IiB4Mj0iMTczIiB5MT0iNDciIHkyPSI0NyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIElQcm9kdWN0IHRvIFBob25lLS0+PGcgaWQ9ImxpbmtfSVByb2R1Y3RfUGhvbmUiPjxwYXRoIGQ9Ik05ODkuMjg1MywzOTMuNDcxMiBDOTY1LjM4NTMsNDIwLjkwMTIgOTQyLjczLDQ0Ni45MiA5MTguODUsNDc0LjM0ICIgZmlsbD0ibm9uZSIgaWQ9IklQcm9kdWN0LWJhY2t0by1QaG9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo3LjAsNy4wOyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iMTAwMS4xMSwzNzkuOSw5ODQuNzYxNiwzODkuNTI5Niw5OTMuODA5LDM5Ny40MTI3LDEwMDEuMTEsMzc5LjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIElQcm9kdWN0IHRvIExhcHRvcC0tPjxnIGlkPSJsaW5rX0lQcm9kdWN0X0xhcHRvcCI+PHBhdGggZD0iTTEwMjguNSwzOTcuOSBDMTAyOC41LDQyNS4zMyAxMDI4LjUsNDQ2LjkyIDEwMjguNSw0NzQuMzQgIiBmaWxsPSJub25lIiBpZD0iSVByb2R1Y3QtYmFja3RvLUxhcHRvcCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7c3Ryb2tlLWRhc2hhcnJheTo3LjAsNy4wOyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iMTAyOC41LDM3OS45LDEwMjIuNSwzOTcuOSwxMDM0LjUsMzk3LjksMTAyOC41LDM3OS45IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48L2c+PCEtLXJldmVyc2UgbGluayBJUHJvZHVjdCB0byBFYXJwaG9uZS0tPjxnIGlkPSJsaW5rX0lQcm9kdWN0X0VhcnBob25lIj48cGF0aCBkPSJNMTA2Ny43MTQ3LDM5My40NzEyIEMxMDkxLjYxNDcsNDIwLjkwMTIgMTExNC4yNyw0NDYuOTIgMTEzOC4xNSw0NzQuMzQgIiBmaWxsPSJub25lIiBpZD0iSVByb2R1Y3QtYmFja3RvLUVhcnBob25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSIxMDU1Ljg5LDM3OS45LDEwNjMuMTkxLDM5Ny40MTI3LDEwNzIuMjM4NCwzODkuNTI5NiwxMDU1Ljg5LDM3OS45IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48L2c+PCEtLXJldmVyc2UgbGluayBJRmFjdG9yeSB0byBQaG9uZUZhY3RvcnktLT48ZyBpZD0ibGlua19JRmFjdG9yeV9QaG9uZUZhY3RvcnkiPjxwYXRoIGQ9Ik0zNzMuODU3NywyNDIuOTk3OSBDMzU0LjEyNzcsMjU0Ljk4NzkgMzQ2LjkxLDI1OS41IDMyNi41LDI3Mi4zIEMzMDQuNDYsMjg2LjEyIDI4MC4yNCwzMDEuNjggMjU5LjczLDMxNC45NyAiIGZpbGw9Im5vbmUiIGlkPSJJRmFjdG9yeS1iYWNrdG8tUGhvbmVGYWN0b3J5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSIzODkuMjQsMjMzLjY1LDM3MC43NDE3LDIzNy44NzA1LDM3Ni45NzM2LDI0OC4xMjU0LDM4OS4yNCwyMzMuNjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIElGYWN0b3J5IHRvIExhcHRvcEZhY3RvcnktLT48ZyBpZD0ibGlua19JRmFjdG9yeV9MYXB0b3BGYWN0b3J5Ij48cGF0aCBkPSJNNDQxLjUsMjUxLjQ2IEM0NDEuNSwyNzUuNjYgNDQxLjUsMjkxLjAxIDQ0MS41LDMxNS4yICIgZmlsbD0ibm9uZSIgaWQ9IklGYWN0b3J5LWJhY2t0by1MYXB0b3BGYWN0b3J5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0ibm9uZSIgcG9pbnRzPSI0NDEuNSwyMzMuNDYsNDM1LjUsMjUxLjQ2LDQ0Ny41LDI1MS40Niw0NDEuNSwyMzMuNDYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIElGYWN0b3J5IHRvIEVhcnBob25lRmFjdG9yeS0tPjxnIGlkPSJsaW5rX0lGYWN0b3J5X0VhcnBob25lRmFjdG9yeSI+PHBhdGggZD0iTTUwOS4xNDIzLDI0Mi45OTc5IEM1MjguODcyMywyNTQuOTg3OSA1MzYuMDksMjU5LjUgNTU2LjUsMjcyLjMgQzU3OC41NCwyODYuMTIgNjAyLjc2LDMwMS42OCA2MjMuMjcsMzE0Ljk3ICIgZmlsbD0ibm9uZSIgaWQ9IklGYWN0b3J5LWJhY2t0by1FYXJwaG9uZUZhY3RvcnkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjQ5My43NiwyMzMuNjUsNTA2LjAyNjQsMjQ4LjEyNTQsNTEyLjI1ODMsMjM3Ljg3MDUsNDkzLjc2LDIzMy42NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1saW5rIFBob25lRmFjdG9yeSB0byBQaG9uZS0tPjxnIGlkPSJsaW5rX1Bob25lRmFjdG9yeV9QaG9uZSI+PHBhdGggY29kZUxpbmU9IjM2IiBkPSJNMjUzLjMzLDM4MC4wMiBDMjc0LjI2LDM5NC4yOSAzMDAuNjEsNDEwLjA2IDMyNi41LDQxOS41OSBDNTA3LjM4LDQ4Ni4xNyA3MzMuMDczNCw1MDEuMTA2OCA4MzQuMzEzNCw1MDQuNTM2OCAiIGZpbGw9Im5vbmUiIGlkPSJQaG9uZUZhY3RvcnktdG8tUGhvbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijg0MC4zMSw1MDQuNzQsODMxLjQ1MDYsNTAwLjQzNzUsODM1LjMxMjksNTA0LjU3MDcsODMxLjE3OTcsNTA4LjQzMyw4NDAuMzEsNTA0Ljc0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MSIgeD0iNDAwLjUiIHk9IjQ0MC42NTY5Ij5jcmVhdGU8L3RleHQ+PC9nPjwhLS1saW5rIExhcHRvcEZhY3RvcnkgdG8gTGFwdG9wLS0+PGcgaWQ9ImxpbmtfTGFwdG9wRmFjdG9yeV9MYXB0b3AiPjxwYXRoIGNvZGVMaW5lPSIzNyIgZD0iTTQ4Mi45OSwzODAuMDIgQzUwMy45NiwzOTQuMzggNTMwLjQzLDQxMC4yMyA1NTYuNSw0MTkuNTkgQzcyNy4wNSw0ODAuODIgNzg2LjQ3LDQyNC4wOSA5NjAuNSw0NzQuNTkgQzk2NS45OSw0NzYuMTkgOTY2LjAxMjUsNDc1Ljk2MzYgOTcxLjUzMjUsNDc4LjEyMzYgIiBmaWxsPSJub25lIiBpZD0iTGFwdG9wRmFjdG9yeS10by1MYXB0b3AiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijk3Ny4xMiw0ODAuMzEsOTcwLjE5NjQsNDczLjMwNTQsOTcyLjQ2MzgsNDc4LjQ4OCw5NjcuMjgxMiw0ODAuNzU1NCw5NzcuMTIsNDgwLjMxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MSIgeD0iNjQ3LjUiIHk9IjQ0MC42NTY5Ij5jcmVhdGU8L3RleHQ+PC9nPjwhLS1saW5rIEVhcnBob25lRmFjdG9yeSB0byBFYXJwaG9uZS0tPjxnIGlkPSJsaW5rX0VhcnBob25lRmFjdG9yeV9FYXJwaG9uZSI+PHBhdGggY29kZUxpbmU9IjM4IiBkPSJNNzMwLjg1LDM4MC4wNCBDNzU4LjY2LDM5My44IDc5Mi42Myw0MDkuMTQgODI0LjUsNDE5LjU5IEM5NDIuMSw0NTguMTggOTc5Ljc5LDQzNi4zNCAxMDk3LjUsNDc0LjU5IEMxMTAyLjkzLDQ3Ni4zNiAxMTAyLjk0ODIsNDc2LjE4OSAxMTA4LjQ1ODIsNDc4LjQxOSAiIGZpbGw9Im5vbmUiIGlkPSJFYXJwaG9uZUZhY3RvcnktdG8tRWFycGhvbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wO3N0cm9rZS1kYXNoYXJyYXk6Ny4wLDcuMDsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjExMTQuMDIsNDgwLjY3LDExMDcuMTc4LDQ3My41ODU3LDExMDkuMzg1Miw0NzguNzk0MiwxMTA0LjE3NjcsNDgxLjAwMTQsMTExNC4wMiw0ODAuNjciIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxIiB4PSI5MzMuNSIgeT0iNDQwLjY1NjkiPmNyZWF0ZTwvdGV4dD48L2c+PCEtLWxpbmsgRmFjdG9yeU1ldGhvZE1haW4gdG8gRmFjdG9yeS0tPjxnIGlkPSJsaW5rX0ZhY3RvcnlNZXRob2RNYWluX0ZhY3RvcnkiPjxwYXRoIGNvZGVMaW5lPSI0MCIgZD0iTTkwLjUsNTUuMzggQzkwLjUsNjYuNzUgOTAuNSw4MS4yOTEzIDkwLjUsOTYuNzU0NCBDOTAuNSwxMDQuNDg1OSA5MC41LDExMi40NDggOTAuNSwxMjAuMzU5MyBDOTAuNSwxMjEuMzQ4MiA5MC41LDEyMi4zMzYzIDkwLjUsMTIzLjMyMzEgQzkwLjUsMTIzLjgxNjUgOTAuNSwxMjQuMzA5NiA5MC41LDEyNC44MDIyIEM5MC41LDEyNS4wNDg1IDkwLjUsMTE5LjI5NDggOTAuNSwxMTkuNTQwOSAiIGZpbGw9Im5vbmUiIGlkPSJGYWN0b3J5TWV0aG9kTWFpbi10by1GYWN0b3J5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI5MC41LDEyNS41NDA5LDk0LjUsMTE2LjU0MDksOTAuNSwxMjAuNTQwOSw4Ni41LDExNi41NDA5LDkwLjUsMTI1LjU0MDkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIzIiB4PSI5MS41IiB5PSI5OC4wNjY5Ij51c2U8L3RleHQ+PC9nPjwhLS1TUkM9W2hQQlJJV0duMzhSbC1uSXZLbjVkeGVUYnhYSTROTFh5V3ozNmNNOUZqMWIxUERfVEVSSlpoWUFZa3hhZWpGZHA5VnQ5TFN5U0tiRk5tUTNabVBmQVViakJXb2RUQU9yVEgyajRHRmMyN1M0LVVaTDhYaXRjWUlJWndtb3JCUm1CNjRDeGZsWUNhazJubzlSNDVCVm13aEsySEtiVXR5b2xYX2NTLXkyLXp1djBzczM4YWtGcVR5OE0wX2ptNWs4VU9fWmQ3OFRGWG52R2llemxscGJLUENWU2pQY0NYNHB2emZEVFhOMHl4TGRLblNBQk91a2o1bUFGTFlfU05CaVp4aHRRZU5PWlBLb1VVNURMUlR3ajlrRjR3SXlkR0x3VExWNXJ1NGNweGlRZzRqX3hKeTlJckMyR0k3bTBdLS0+PC9nPjwvc3ZnPg=='><h2 id="22-code-example"><a class="markdownIt-Anchor" href="#22-code-example"></a> 2.2 Code Example</h2><p>Product Interface and Concrete Product Classes:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="comment">// product description</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Phone</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am a phone.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Laptop</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am a laptop.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Earphone</span> <span class="keyword">implements</span> <span class="title class_">IProduct</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">desc</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I am a earphone.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Abstract Factory Interface and Its Concrete Factories:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract factory interface</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IFactory</span> &#123;</span><br><span class="line">    IProduct <span class="title function_">createProduct</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PhoneFactory</span> <span class="keyword">implements</span> <span class="title class_">IFactory</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">createProduct</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Phone</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LaptopFactory</span> <span class="keyword">implements</span> <span class="title class_">IFactory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">createProduct</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Laptop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EarphoneFactory</span> <span class="keyword">implements</span> <span class="title class_">IFactory</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IProduct <span class="title function_">createProduct</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Earphone</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Usage of the Factory Method Pattern:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FactoryMethodMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">phone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PhoneFactory</span>().createProduct();</span><br><span class="line">        phone.desc();</span><br><span class="line"></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">laptop</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LaptopFactory</span>().createProduct();</span><br><span class="line">        laptop.desc();</span><br><span class="line"></span><br><span class="line">        <span class="type">IProduct</span> <span class="variable">earphone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EarphoneFactory</span>().createProduct();</span><br><span class="line">        earphone.desc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Execution Result:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">I am a phone.</span><br><span class="line">I am a laptop.</span><br><span class="line">I am a earphone.</span><br></pre></td></tr></table></figure><h1 id="3-application-in-source-code"><a class="markdownIt-Anchor" href="#3-application-in-source-code"></a> 3. Application in Source Code</h1><h2 id="31-jdk-javautilcalendar-simple-factory-pattern"><a class="markdownIt-Anchor" href="#31-jdk-javautilcalendar-simple-factory-pattern"></a> 3.1. JDK-java.util.Calendar (Simple Factory Pattern)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// java.util.Calendar</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Calendar</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span>, Cloneable, Comparable&lt;Calendar&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Calendar <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createCalendar(TimeZone.getDefault(), Locale.getDefault(Locale.Category.FORMAT));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Calendar <span class="title function_">createCalendar</span><span class="params">(TimeZone zone, Locale aLocale)</span> &#123;</span><br><span class="line">        <span class="type">CalendarProvider</span> <span class="variable">provider</span> <span class="operator">=</span> LocaleProviderAdapter.getAdapter(CalendarProvider.class, aLocale).getCalendarProvider();</span><br><span class="line">        <span class="keyword">if</span> (provider != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> provider.getInstance(zone, aLocale);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalArgumentException iae) &#123;</span><br><span class="line">                <span class="comment">// fall back to the default instantiation</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">Calendar</span> <span class="variable">cal</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (aLocale.hasExtensions()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">caltype</span> <span class="operator">=</span> aLocale.getUnicodeLocaleType(<span class="string">&quot;ca&quot;</span>);</span><br><span class="line">            <span class="comment">// Generate different subclass instances of `Calendar` based on different `calType` values.</span></span><br><span class="line">            <span class="keyword">if</span> (caltype != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">switch</span> (caltype) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;buddhist&quot;</span>:</span><br><span class="line">                        cal = <span class="keyword">new</span> <span class="title class_">BuddhistCalendar</span>(zone, aLocale);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;japanese&quot;</span>:</span><br><span class="line">                        cal = <span class="keyword">new</span> <span class="title class_">JapaneseImperialCalendar</span>(zone, aLocale);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;gregory&quot;</span>:</span><br><span class="line">                        cal = <span class="keyword">new</span> <span class="title class_">GregorianCalendar</span>(zone, aLocale);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cal == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// Decide to generate different subclass instances of `Calendar` based on conditional checks.</span></span><br><span class="line">            <span class="keyword">if</span> (aLocale.getLanguage() == <span class="string">&quot;th&quot;</span> &amp;&amp; aLocale.getCountry() == <span class="string">&quot;TH&quot;</span>) &#123;</span><br><span class="line">                cal = <span class="keyword">new</span> <span class="title class_">BuddhistCalendar</span>(zone, aLocale);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (aLocale.getVariant() == <span class="string">&quot;JP&quot;</span> &amp;&amp; aLocale.getLanguage() == <span class="string">&quot;ja&quot;</span> &amp;&amp; aLocale.getCountry() == <span class="string">&quot;JP&quot;</span>) &#123;</span><br><span class="line">                cal = <span class="keyword">new</span> <span class="title class_">JapaneseImperialCalendar</span>(zone, aLocale);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cal = <span class="keyword">new</span> <span class="title class_">GregorianCalendar</span>(zone, aLocale);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cal;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In the <code>createCalendar()</code> static method, the <code>Calendar</code> class returns different subclass instances based on conditional checks, involving the following concrete subclasses:</p><img class="kroki" src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXMtYXNjaWkiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyNzhweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjQxOXB4O2hlaWdodDoyNzhweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA0MTkgMjc4IiB3aWR0aD0iNDE5cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48IS0tY2xhc3MgQ2FsZW5kYXItLT48ZyBpZD0iZWxlbV9DYWxlbmRhciI+PHJlY3QgY29kZUxpbmU9IjMiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDgiIGlkPSJDYWxlbmRhciIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iOTMiIHg9IjE3NSIgeT0iNyIvPjxlbGxpcHNlIGN4PSIxOTAiIGN5PSIyMyIgZmlsbD0iI0E5RENERiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0xOTAuMTA5NCwxOC4zNDM4IEwxODguOTUzMSwyMy40MjE5IEwxOTEuMjgxMywyMy40MjE5IEwxOTAuMTA5NCwxOC4zNDM4IFogTTE4OC42MjUsMTYuMTA5NCBMMTkxLjYwOTQsMTYuMTA5NCBMMTk0Ljk2ODgsMjguNSBMMTkyLjUxNTYsMjguNSBMMTkxLjc1LDI1LjQzNzUgTDE4OC40Njg4LDI1LjQzNzUgTDE4Ny43MTg4LDI4LjUgTDE4NS4yODEzLDI4LjUgTDE4OC42MjUsMTYuMTA5NCBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXN0eWxlPSJpdGFsaWMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjEiIHg9IjIwNCIgeT0iMjcuODQ2NyI+Q2FsZW5kYXI8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTc2IiB4Mj0iMjY3IiB5MT0iMzkiIHkyPSIzOSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjE3NiIgeDI9IjI2NyIgeTE9IjQ3IiB5Mj0iNDciLz48L2c+PCEtLWNsYXNzIEphcGFuZXNlSW1wZXJpYWxDYWxlbmRhci0tPjxnIGlkPSJlbGVtX0phcGFuZXNlSW1wZXJpYWxDYWxlbmRhciI+PHJlY3QgY29kZUxpbmU9IjYiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDgiIGlkPSJKYXBhbmVzZUltcGVyaWFsQ2FsZW5kYXIiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjIwOSIgeD0iNyIgeT0iMTE1Ii8+PGVsbGlwc2UgY3g9IjIyIiBjeT0iMTMxIiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTI0Ljk2ODgsMTM2LjY0MDYgUTI0LjM5MDYsMTM2LjkzNzUgMjMuNzUsMTM3LjA3ODEgUTIzLjEwOTQsMTM3LjIzNDQgMjIuNDA2MywxMzcuMjM0NCBRMTkuOTA2MywxMzcuMjM0NCAxOC41NzgxLDEzNS41OTM4IFExNy4yNjU2LDEzMy45Mzc1IDE3LjI2NTYsMTMwLjgxMjUgUTE3LjI2NTYsMTI3LjY4NzUgMTguNTc4MSwxMjYuMDMxMyBRMTkuOTA2MywxMjQuMzc1IDIyLjQwNjMsMTI0LjM3NSBRMjMuMTA5NCwxMjQuMzc1IDIzLjc1LDEyNC41MzEzIFEyNC40MDYzLDEyNC42ODc1IDI0Ljk2ODgsMTI0Ljk4NDQgTDI0Ljk2ODgsMTI3LjcwMzEgUTI0LjM0MzgsMTI3LjEyNSAyMy43NSwxMjYuODU5NCBRMjMuMTU2MywxMjYuNTc4MSAyMi41MzEzLDEyNi41NzgxIFEyMS4xODc1LDEyNi41NzgxIDIwLjUsMTI3LjY1NjMgUTE5LjgxMjUsMTI4LjcxODggMTkuODEyNSwxMzAuODEyNSBRMTkuODEyNSwxMzIuOTA2MyAyMC41LDEzMy45ODQ0IFEyMS4xODc1LDEzNS4wNDY5IDIyLjUzMTMsMTM1LjA0NjkgUTIzLjE1NjMsMTM1LjA0NjkgMjMuNzUsMTM0Ljc4MTMgUTI0LjM0MzgsMTM0LjUgMjQuOTY4OCwxMzMuOTIxOSBMMjQuOTY4OCwxMzYuNjQwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE3NyIgeD0iMzYiIHk9IjEzNS44NDY3Ij5KYXBhbmVzZUltcGVyaWFsQ2FsZW5kYXI8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjIxNSIgeTE9IjE0NyIgeTI9IjE0NyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjgiIHgyPSIyMTUiIHkxPSIxNTUiIHkyPSIxNTUiLz48L2c+PCEtLWNsYXNzIEdyZWdvcmlhbkNhbGVuZGFyLS0+PGcgaWQ9ImVsZW1fR3JlZ29yaWFuQ2FsZW5kYXIiPjxyZWN0IGNvZGVMaW5lPSI5IiBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjQ4IiBpZD0iR3JlZ29yaWFuQ2FsZW5kYXIiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE2MSIgeD0iMjUxIiB5PSIxMTUiLz48ZWxsaXBzZSBjeD0iMjY2IiBjeT0iMTMxIiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTI2OC45Njg4LDEzNi42NDA2IFEyNjguMzkwNiwxMzYuOTM3NSAyNjcuNzUsMTM3LjA3ODEgUTI2Ny4xMDk0LDEzNy4yMzQ0IDI2Ni40MDYzLDEzNy4yMzQ0IFEyNjMuOTA2MywxMzcuMjM0NCAyNjIuNTc4MSwxMzUuNTkzOCBRMjYxLjI2NTYsMTMzLjkzNzUgMjYxLjI2NTYsMTMwLjgxMjUgUTI2MS4yNjU2LDEyNy42ODc1IDI2Mi41NzgxLDEyNi4wMzEzIFEyNjMuOTA2MywxMjQuMzc1IDI2Ni40MDYzLDEyNC4zNzUgUTI2Ny4xMDk0LDEyNC4zNzUgMjY3Ljc1LDEyNC41MzEzIFEyNjguNDA2MywxMjQuNjg3NSAyNjguOTY4OCwxMjQuOTg0NCBMMjY4Ljk2ODgsMTI3LjcwMzEgUTI2OC4zNDM4LDEyNy4xMjUgMjY3Ljc1LDEyNi44NTk0IFEyNjcuMTU2MywxMjYuNTc4MSAyNjYuNTMxMywxMjYuNTc4MSBRMjY1LjE4NzUsMTI2LjU3ODEgMjY0LjUsMTI3LjY1NjMgUTI2My44MTI1LDEyOC43MTg4IDI2My44MTI1LDEzMC44MTI1IFEyNjMuODEyNSwxMzIuOTA2MyAyNjQuNSwxMzMuOTg0NCBRMjY1LjE4NzUsMTM1LjA0NjkgMjY2LjUzMTMsMTM1LjA0NjkgUTI2Ny4xNTYzLDEzNS4wNDY5IDI2Ny43NSwxMzQuNzgxMyBRMjY4LjM0MzgsMTM0LjUgMjY4Ljk2ODgsMTMzLjkyMTkgTDI2OC45Njg4LDEzNi42NDA2IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI5IiB4PSIyODAiIHk9IjEzNS44NDY3Ij5HcmVnb3JpYW5DYWxlbmRhcjwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyNTIiIHgyPSI0MTEiIHkxPSIxNDciIHkyPSIxNDciLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyNTIiIHgyPSI0MTEiIHkxPSIxNTUiIHkyPSIxNTUiLz48L2c+PCEtLWNsYXNzIEJ1ZGRoaXN0Q2FsZW5kYXItLT48ZyBpZD0iZWxlbV9CdWRkaGlzdENhbGVuZGFyIj48cmVjdCBjb2RlTGluZT0iMTIiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDgiIGlkPSJCdWRkaGlzdENhbGVuZGFyIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTUiIHg9IjI1NCIgeT0iMjIzIi8+PGVsbGlwc2UgY3g9IjI2OSIgY3k9IjIzOSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik0yNzEuOTY4OCwyNDQuNjQwNiBRMjcxLjM5MDYsMjQ0LjkzNzUgMjcwLjc1LDI0NS4wNzgxIFEyNzAuMTA5NCwyNDUuMjM0NCAyNjkuNDA2MywyNDUuMjM0NCBRMjY2LjkwNjMsMjQ1LjIzNDQgMjY1LjU3ODEsMjQzLjU5MzggUTI2NC4yNjU2LDI0MS45Mzc1IDI2NC4yNjU2LDIzOC44MTI1IFEyNjQuMjY1NiwyMzUuNjg3NSAyNjUuNTc4MSwyMzQuMDMxMyBRMjY2LjkwNjMsMjMyLjM3NSAyNjkuNDA2MywyMzIuMzc1IFEyNzAuMTA5NCwyMzIuMzc1IDI3MC43NSwyMzIuNTMxMyBRMjcxLjQwNjMsMjMyLjY4NzUgMjcxLjk2ODgsMjMyLjk4NDQgTDI3MS45Njg4LDIzNS43MDMxIFEyNzEuMzQzOCwyMzUuMTI1IDI3MC43NSwyMzQuODU5NCBRMjcwLjE1NjMsMjM0LjU3ODEgMjY5LjUzMTMsMjM0LjU3ODEgUTI2OC4xODc1LDIzNC41NzgxIDI2Ny41LDIzNS42NTYzIFEyNjYuODEyNSwyMzYuNzE4OCAyNjYuODEyNSwyMzguODEyNSBRMjY2LjgxMjUsMjQwLjkwNjMgMjY3LjUsMjQxLjk4NDQgUTI2OC4xODc1LDI0My4wNDY5IDI2OS41MzEzLDI0My4wNDY5IFEyNzAuMTU2MywyNDMuMDQ2OSAyNzAuNzUsMjQyLjc4MTMgUTI3MS4zNDM4LDI0Mi41IDI3MS45Njg4LDI0MS45MjE5IEwyNzEuOTY4OCwyNDQuNjQwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyMyIgeD0iMjgzIiB5PSIyNDMuODQ2NyI+QnVkZGhpc3RDYWxlbmRhcjwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyNTUiIHgyPSI0MDgiIHkxPSIyNTUiIHkyPSIyNTUiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyNTUiIHgyPSI0MDgiIHkxPSIyNjMiIHkyPSIyNjMiLz48L2c+PCEtLXJldmVyc2UgbGluayBDYWxlbmRhciB0byBKYXBhbmVzZUltcGVyaWFsQ2FsZW5kYXItLT48ZyBpZD0ibGlua19DYWxlbmRhcl9KYXBhbmVzZUltcGVyaWFsQ2FsZW5kYXIiPjxwYXRoIGQ9Ik0xODQuNDAxLDY3Ljc1MjYgQzE2Ni4wNjEsODUuNDMyNiAxNTMuOTEsOTcuMTMgMTM1LjU4LDExNC43OSAiIGZpbGw9Im5vbmUiIGlkPSJDYWxlbmRhci1iYWNrdG8tSmFwYW5lc2VJbXBlcmlhbENhbGVuZGFyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjE5Ny4zNiw1NS4yNiwxODAuMjM2OCw2My40MzMsMTg4LjU2NTIsNzIuMDcyMywxOTcuMzYsNTUuMjYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjwvZz48IS0tcmV2ZXJzZSBsaW5rIENhbGVuZGFyIHRvIEdyZWdvcmlhbkNhbGVuZGFyLS0+PGcgaWQ9ImxpbmtfQ2FsZW5kYXJfR3JlZ29yaWFuQ2FsZW5kYXIiPjxwYXRoIGQ9Ik0yNTguNTk5LDY3Ljc1MjYgQzI3Ni45MzksODUuNDMyNiAyODkuMDksOTcuMTMgMzA3LjQyLDExNC43OSAiIGZpbGw9Im5vbmUiIGlkPSJDYWxlbmRhci1iYWNrdG8tR3JlZ29yaWFuQ2FsZW5kYXIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwb2x5Z29uIGZpbGw9Im5vbmUiIHBvaW50cz0iMjQ1LjY0LDU1LjI2LDI1NC40MzQ4LDcyLjA3MjMsMjYyLjc2MzIsNjMuNDMzLDI0NS42NCw1NS4yNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1yZXZlcnNlIGxpbmsgR3JlZ29yaWFuQ2FsZW5kYXIgdG8gQnVkZGhpc3RDYWxlbmRhci0tPjxnIGlkPSJsaW5rX0dyZWdvcmlhbkNhbGVuZGFyX0J1ZGRoaXN0Q2FsZW5kYXIiPjxwYXRoIGQ9Ik0zMzEuNSwxODEuMjYgQzMzMS41LDE5OC45NCAzMzEuNSwyMDUuMTMgMzMxLjUsMjIyLjc5ICIgZmlsbD0ibm9uZSIgaWQ9IkdyZWdvcmlhbkNhbGVuZGFyLWJhY2t0by1CdWRkaGlzdENhbGVuZGFyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDsiLz48cG9seWdvbiBmaWxsPSJub25lIiBwb2ludHM9IjMzMS41LDE2My4yNiwzMjUuNSwxODEuMjYsMzM3LjUsMTgxLjI2LDMzMS41LDE2My4yNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PC9nPjwhLS1TUkM9W1pPbW4yVzhuNDROeEVLS3dBcXJsZ09OZUJSeDlpMWtPUDREYzVlSjVrbmlLamphangzd0Z6X3ZYREFqd3podUFZaXJQSmM3QUZXWEtacDVYUUNYNFVBZXIxN0RWeGd1R0JYN0RCVkdjLWg0N0FXZWh0dEZiYlkyaG1vX2hPcC13REh3Y1JmVV94Q2lTdXZaS0RsQnNQZDR6LW0wMF0tLT48L2c+PC9zdmc+'><h2 id="32-jdk-javatextnumberformat-simple-factory-pattern"><a class="markdownIt-Anchor" href="#32-jdk-javatextnumberformat-simple-factory-pattern"></a> 3.2. JDK-java.text.NumberFormat (Simple Factory Pattern)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// java.text.NumberFormat</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">NumberFormat</span> <span class="keyword">extends</span> <span class="title class_">Format</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Constants used by factory methods to specify a style of format.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">NUMBERSTYLE</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CURRENCYSTYLE</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PERCENTSTYLE</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SCIENTIFICSTYLE</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">INTEGERSTYLE</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> NumberFormat <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getInstance(Locale.getDefault(Locale.Category.FORMAT), NUMBERSTYLE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> NumberFormat <span class="title function_">getInstance</span><span class="params">(Locale desiredLocale, <span class="type">int</span> choice)</span> &#123;</span><br><span class="line">        LocaleProviderAdapter adapter;</span><br><span class="line">        adapter = LocaleProviderAdapter.getAdapter(NumberFormatProvider.class, desiredLocale);</span><br><span class="line">        <span class="type">NumberFormat</span> <span class="variable">numberFormat</span> <span class="operator">=</span> getInstance(adapter, desiredLocale, choice);</span><br><span class="line">        <span class="keyword">if</span> (numberFormat == <span class="literal">null</span>) &#123;</span><br><span class="line">            numberFormat = getInstance(LocaleProviderAdapter.forJRE(), desiredLocale, choice);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> numberFormat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Obtain different `NumberFormat` instances for various purposes based on the `choice`.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> NumberFormat <span class="title function_">getInstance</span><span class="params">(LocaleProviderAdapter adapter, Locale locale, <span class="type">int</span> choice)</span> &#123;</span><br><span class="line">        <span class="type">NumberFormatProvider</span> <span class="variable">provider</span> <span class="operator">=</span> adapter.getNumberFormatProvider();</span><br><span class="line">        <span class="type">NumberFormat</span> <span class="variable">numberFormat</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">switch</span> (choice) &#123;</span><br><span class="line">            <span class="keyword">case</span> NUMBERSTYLE:</span><br><span class="line">                numberFormat = provider.getNumberInstance(locale);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> PERCENTSTYLE:</span><br><span class="line">                numberFormat = provider.getPercentInstance(locale);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> CURRENCYSTYLE:</span><br><span class="line">                numberFormat = provider.getCurrencyInstance(locale);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> INTEGERSTYLE:</span><br><span class="line">                numberFormat = provider.getIntegerInstance(locale);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> numberFormat;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The <code>getInstance()</code> static method in <code>NumberFormat</code> generates different subclass instances of <code>NumberFormat</code> based on the provided <code>locale</code> parameter. By default, it calls <code>sun.util.locale.provider.NumberFormatProviderImpl#getInstance</code> to create a new <code>java.text.DecimalFormat</code> instance, applying specific formatting settings as required, such as currency format, percentage format, and others.</p><h2 id="33-jdk-javaneturlstreamhandlerfactory-factory-method-pattern"><a class="markdownIt-Anchor" href="#33-jdk-javaneturlstreamhandlerfactory-factory-method-pattern"></a> 3.3. JDK-java.net.URLStreamHandlerFactory (Factory Method Pattern)</h2><p>The <code>URLStreamHandlerFactory</code> interface (abstract factory) defines a factory for URL stream protocol handlers, serving as a common base for all stream protocol handlers. Stream protocol handlers understand how to establish connections for specific protocol types, such as HTTP or HTTPS.</p><p>The <code>URLStreamHandler</code> abstract class acts as an abstract product, where instances of its subclasses (concrete products) are not created directly by the application. Instead, they are managed and created by classes that implement the <code>URLStreamHandlerFactory</code> factory interface (concrete factories).</p><p>Abstract Factory and Its Subclasses (Concrete Factories):</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract factory</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">URLStreamHandlerFactory</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new `URLStreamHandler` instance for a specified protocol.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> protocol e.g. &quot;ftp&quot;, &quot;http&quot;, &quot;nntp&quot;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    URLStreamHandler <span class="title function_">createURLStreamHandler</span><span class="params">(String protocol)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Launcher</span> &#123;</span><br><span class="line">    <span class="comment">// concrete factory</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Factory</span> <span class="keyword">implements</span> <span class="title class_">URLStreamHandlerFactory</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">PREFIX</span> <span class="operator">=</span> <span class="string">&quot;sun.net.www.protocol&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="title function_">Factory</span><span class="params">()</span> &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// var1: Create instances based on different protocols for the specified `protocol`.</span></span><br><span class="line">        <span class="keyword">public</span> URLStreamHandler <span class="title function_">createURLStreamHandler</span><span class="params">(String protocol)</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">var2</span> <span class="operator">=</span> PREFIX + <span class="string">&quot;.&quot;</span> + protocol + <span class="string">&quot;.Handler&quot;</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">Class</span> <span class="variable">var3</span> <span class="operator">=</span> Class.forName(var2);</span><br><span class="line">                <span class="keyword">return</span> (URLStreamHandler)var3.newInstance();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (ReflectiveOperationException var4) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InternalError</span>(<span class="string">&quot;could not load &quot;</span> + protocol + <span class="string">&quot;system protocol handler&quot;</span>, var4);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Abstract Product and Its Subclasses (Concrete Products):</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">URLStreamHandler</span> &#123;</span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">protected</span> URLConnection <span class="title function_">openConnection</span><span class="params">(URL u)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// concrete product：e.g. sun.net.www.protocol.http.Handler</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Handler</span> <span class="keyword">extends</span> <span class="title class_">sun</span>.net.www.protocol.http.Handler &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Handler</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> URLConnection <span class="title function_">openConnection</span><span class="params">(URL var1)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">URLConnection</span> <span class="variable">var2</span> <span class="operator">=</span> <span class="built_in">super</span>.openConnection(var1);</span><br><span class="line">        URLUtil.setTimeouts(var2);</span><br><span class="line">        <span class="keyword">return</span> var2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The specific subclasses of the <code>URLStreamHandler</code> abstract product are shown in the red box in the figure below:<br /><img src="https://s2.loli.net/2021/12/08/el1WbKtVH78yDz4.png" alt="URLStreamHandler_subclasses.png" width="700"  srcFile="URLStreamHandler_subclasses.png"></p><h2 id="34-slf4j-orgslf4jiloggerfactory-factory-method-pattern"><a class="markdownIt-Anchor" href="#34-slf4j-orgslf4jiloggerfactory-factory-method-pattern"></a> 3.4. slf4j-org.slf4j.ILoggerFactory (Factory Method Pattern)</h2><p>Abstract Factory and Its Concrete Factories are as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract factory</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ILoggerFactory</span> &#123;</span><br><span class="line">    <span class="comment">// Used for creating `Logger` objects</span></span><br><span class="line">    Logger <span class="title function_">getLogger</span><span class="params">(String name)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// concrete factory：NOPLoggerFactory</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NOPLoggerFactory</span> <span class="keyword">implements</span> <span class="title class_">ILoggerFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">NOPLoggerFactory</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Logger <span class="title function_">getLogger</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> NOPLogger.NOP_LOGGER;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// concrete factory: log4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Log4jLoggerFactory</span> <span class="keyword">implements</span> <span class="title class_">ILoggerFactory</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> Logger <span class="title function_">getLogger</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="type">Logger</span> <span class="variable">slf4jLogger</span> <span class="operator">=</span> (Logger)<span class="built_in">this</span>.loggerMap.get(name);</span><br><span class="line">        <span class="keyword">if</span> (slf4jLogger != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> slf4jLogger;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            org.apache.log4j.Logger log4jLogger;</span><br><span class="line">            <span class="keyword">if</span> (name.equalsIgnoreCase(<span class="string">&quot;ROOT&quot;</span>)) &#123;</span><br><span class="line">                log4jLogger = LogManager.getRootLogger();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                log4jLogger = LogManager.getLogger(name);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">Logger</span> <span class="variable">newInstance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Log4jLoggerAdapter</span>(log4jLogger);</span><br><span class="line">            <span class="type">Logger</span> <span class="variable">oldInstance</span> <span class="operator">=</span> (Logger)<span class="built_in">this</span>.loggerMap.putIfAbsent(name, newInstance);</span><br><span class="line">            <span class="keyword">return</span> (Logger)(oldInstance == <span class="literal">null</span> ? newInstance : oldInstance);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Abstract Product and Its Concrete Products are as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// concrete product: `NOPLogger`, corresponding to the factory `NOPLoggerFactory`.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NOPLogger</span> <span class="keyword">extends</span> <span class="title class_">MarkerIgnoringBase</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// concrete product: Log4j&#x27;s `Logger` subclass, corresponding to the factory `Log4jLoggerFactory`.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Log4jLoggerAdapter</span> <span class="keyword">extends</span> <span class="title class_">MarkerIgnoringBase</span> <span class="keyword">implements</span> <span class="title class_">LocationAwareLogger</span>, Serializable &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">MarkerIgnoringBase</span> <span class="keyword">extends</span> <span class="title class_">NamedLoggerBase</span> <span class="keyword">implements</span> <span class="title class_">Logger</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="35-jdk-javaxxmlbindjaxbcontext-factory-method-pattern"><a class="markdownIt-Anchor" href="#35-jdk-javaxxmlbindjaxbcontext-factory-method-pattern"></a> 3.5. JDK-javax.xml.bind.JAXBContext (Factory Method Pattern)</h2><p>Abstract Factory and Its Concrete Factories are as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract factory</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">JAXBContext</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> Marshaller <span class="title function_">createMarshaller</span><span class="params">()</span> <span class="keyword">throws</span> JAXBException;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// concrete factory</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">JAXBContextImpl</span> <span class="keyword">extends</span> <span class="title class_">JAXBRIContext</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> MarshallerImpl <span class="title function_">createMarshaller</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MarshallerImpl</span>(<span class="built_in">this</span>, (AssociationMap)<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">JAXBRIContext</span> <span class="keyword">extends</span> <span class="title class_">JAXBContext</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Abstract Product and Its Concrete Products are as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Marshaller</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Concrete Product, corresponding to the factory method `JAXBContextImpl.createMarshaller()`.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">MarshallerImpl</span> <span class="keyword">extends</span> <span class="title class_">AbstractMarshallerImpl</span> <span class="keyword">implements</span> <span class="title class_">ValidationEventHandler</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractMarshallerImpl</span> <span class="keyword">implements</span> <span class="title class_">Marshaller</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="36-iterator-javautilcollection-factory-method-pattern"><a class="markdownIt-Anchor" href="#36-iterator-javautilcollection-factory-method-pattern"></a> 3.6. Iterator-java.util.Collection (Factory Method Pattern)</h2><p>Abstract Factory and Its Concrete Factories are as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract factory</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Collection</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">Iterable</span>&lt;E&gt; &#123;</span><br><span class="line">    <span class="comment">// Obtain an iterator instance.</span></span><br><span class="line">    Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Concrete Factory: `ArrayList` implements the `List` interface and inherits from the `Collection` interface.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractList</span>&lt;E&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Concrete implementation method: Obtain an iterator instance of `Iterator`: `Itr`.</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Itr</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// concrete factory：ArrayDeque</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayDeque</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractCollection</span>&lt;E&gt;</span><br><span class="line">                           <span class="keyword">implements</span> <span class="title class_">Deque</span>&lt;E&gt;, Cloneable, Serializable</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Concrete implementation method: Obtain an iterator instance of `Iterator`: `DeqIterator`.</span></span><br><span class="line">    <span class="keyword">public</span> Iterator&lt;E&gt; <span class="title function_">iterator</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DeqIterator</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Abstract Product and Its Concrete Products are as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// abstract product</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    E <span class="title function_">next</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Concrete Product `Itr`: A private inner class of `ArrayList`.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayList</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractList</span>&lt;E&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">List</span>&lt;E&gt;, RandomAccess, Cloneable, java.io.Serializable</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// concrete product</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Itr</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line">        Itr() &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cursor != size;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Concrete Product `ArrayDeque`: A private inner class of `ArrayDeque`.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrayDeque</span>&lt;E&gt; <span class="keyword">extends</span> <span class="title class_">AbstractCollection</span>&lt;E&gt;</span><br><span class="line">                           <span class="keyword">implements</span> <span class="title class_">Deque</span>&lt;E&gt;, Cloneable, Serializable</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// concrete product</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">DeqIterator</span> <span class="keyword">implements</span> <span class="title class_">Iterator</span>&lt;E&gt; &#123;</span><br><span class="line">        Itr() &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasNext</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> cursor != size;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">public</span> E <span class="title function_">next</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="references"><a class="markdownIt-Anchor" href="#references"></a> References</h1><ul><li><a href="http://c.biancheng.net/view/8385.html">C语言中文网-简单工厂模式</a></li><li><a href="http://c.biancheng.net/view/1348.html">C语言中文网-工厂模式</a></li><li><a href="https://www.cnblogs.com/jing99/p/12595494.html">设计模式之工厂模式(3种)详解及代码示例</a></li></ul>]]></content>
        
        
        <categories>
            
            <category> 23 Design Patterns </category>
            
            <category> 1. Creational Pattern </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Design_Pattern </tag>
            
            <tag> Creational_Pattern </tag>
            
        </tags>
        
    </entry>
    
    
    
    <entry>
        <title>Singleton Pattern</title>
        <link href="/en/design-pattern/singleton-pattern/"/>
        <url>/en/design-pattern/singleton-pattern/</url>
        
        <content type="html"><![CDATA[<h1 id="0-overview"><a class="markdownIt-Anchor" href="#0-overview"></a> 0. Overview</h1><p><strong>Singleton</strong> is a Creational Design Pattern that ensures a class has <u>only one instance</u>, and provides <u>a global access point</u> to this singleton instance.</p><p>Wikipedia says:</p><blockquote><p>In software engineering, the singleton pattern is a software design pattern that restricts the instantiation of a class to a singular instance. This pattern is useful when exactly one object is needed to coordinate actions across a system.</p></blockquote><p><strong>Key Characteristics</strong>:</p><ul><li><strong>Single Instance</strong>:  a class has only one instance.</li><li><strong>Global Access Point</strong>: provides a global access point to that instance.</li></ul><p><strong>Basic Structure</strong>:</p><ul><li><strong>Private Constructor</strong>: the constructor is made private so that the class cannot be instantiated from outside the class.</li><li><strong>Private Static Field</strong>: a private static field <code>instance</code> holds the single instance of the class and should be created inside the class.</li><li><strong>Public Static Method</strong>: a public static method <code>getInstance()</code>, commonly used as a global access point, is declared to return the singleton instance of the class.</li></ul><img class="kroki" src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXMtYXNjaWkiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgaGVpZ2h0PSIyMzVweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjIwNnB4O2hlaWdodDoyMzVweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyMDYgMjM1IiB3aWR0aD0iMjA2cHgiIHpvb21BbmRQYW49Im1hZ25pZnkiPjxkZWZzLz48Zz48IS0tY2xhc3MgU2luZ2xldG9uLS0+PGcgaWQ9ImVsZW1fU2luZ2xldG9uIj48cmVjdCBjb2RlTGluZT0iMyIgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI5Ni44OTA2IiBpZD0iU2luZ2xldG9uIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxOTIiIHg9IjciIHk9IjEzMiIvPjxlbGxpcHNlIGN4PSI2Ni4yNSIgY3k9IjE0OCIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MS4wOyIvPjxwYXRoIGQ9Ik02OS4yMTg4LDE1My42NDA2IFE2OC42NDA2LDE1My45Mzc1IDY4LDE1NC4wNzgxIFE2Ny4zNTk0LDE1NC4yMzQ0IDY2LjY1NjMsMTU0LjIzNDQgUTY0LjE1NjMsMTU0LjIzNDQgNjIuODI4MSwxNTIuNTkzOCBRNjEuNTE1NiwxNTAuOTM3NSA2MS41MTU2LDE0Ny44MTI1IFE2MS41MTU2LDE0NC42ODc1IDYyLjgyODEsMTQzLjAzMTMgUTY0LjE1NjMsMTQxLjM3NSA2Ni42NTYzLDE0MS4zNzUgUTY3LjM1OTQsMTQxLjM3NSA2OCwxNDEuNTMxMyBRNjguNjU2MywxNDEuNjg3NSA2OS4yMTg4LDE0MS45ODQ0IEw2OS4yMTg4LDE0NC43MDMxIFE2OC41OTM4LDE0NC4xMjUgNjgsMTQzLjg1OTQgUTY3LjQwNjMsMTQzLjU3ODEgNjYuNzgxMywxNDMuNTc4MSBRNjUuNDM3NSwxNDMuNTc4MSA2NC43NSwxNDQuNjU2MyBRNjQuMDYyNSwxNDUuNzE4OCA2NC4wNjI1LDE0Ny44MTI1IFE2NC4wNjI1LDE0OS45MDYzIDY0Ljc1LDE1MC45ODQ0IFE2NS40Mzc1LDE1Mi4wNDY5IDY2Ljc4MTMsMTUyLjA0NjkgUTY3LjQwNjMsMTUyLjA0NjkgNjgsMTUxLjc4MTMgUTY4LjU5MzgsMTUxLjUgNjkuMjE4OCwxNTAuOTIxOSBMNjkuMjE4OCwxNTMuNjQwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY1IiB4PSI4Ni43NSIgeT0iMTUyLjg0NjciPlNpbmdsZXRvbjwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI4IiB4Mj0iMTk4IiB5MT0iMTY0IiB5Mj0iMTY0Ii8+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjEuMDsiIHdpZHRoPSI2IiB4PSIxNSIgeT0iMTc0LjY0ODQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0LWRlY29yYXRpb249InVuZGVybGluZSIgdGV4dExlbmd0aD0iMTMzIiB4PSIyNyIgeT0iMTgwLjk5NTEiPmluc3RhbmNlOiBTaW5nbGV0b248L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjE5OCIgeTE9IjE4OC4yOTY5IiB5Mj0iMTg4LjI5NjkiLz48cmVjdCBmaWxsPSIjRjI0RDVDIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MS4wOyIgd2lkdGg9IjYiIHg9IjE1IiB5PSIxOTguOTQ1MyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc1IiB4PSIyNyIgeT0iMjA1LjI5MiI+U2luZ2xldG9uKCk8L3RleHQ+PGVsbGlwc2UgY3g9IjE4IiBjeT0iMjE4LjI0MjIiIGZpbGw9IiM4NEJFODQiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDM4MDQ4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dC1kZWNvcmF0aW9uPSJ1bmRlcmxpbmUiIHRleHRMZW5ndGg9IjE2NiIgeD0iMjciIHk9IjIyMS41ODg5Ij5nZXRJbnN0YW5jZSgpOiBTaW5nbGV0b248L3RleHQ+PC9nPjwhLS1jbGFzcyBTaW5nbGV0b25NYWluLS0+PGcgaWQ9ImVsZW1fU2luZ2xldG9uTWFpbiI+PHJlY3QgY29kZUxpbmU9IjkiIGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDgiIGlkPSJTaW5nbGV0b25NYWluIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMjkiIHg9IjM4LjUiIHk9IjciLz48ZWxsaXBzZSBjeD0iNTMuNSIgY3k9IjIzIiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHBhdGggZD0iTTU2LjQ2ODgsMjguNjQwNiBRNTUuODkwNiwyOC45Mzc1IDU1LjI1LDI5LjA3ODEgUTU0LjYwOTQsMjkuMjM0NCA1My45MDYzLDI5LjIzNDQgUTUxLjQwNjMsMjkuMjM0NCA1MC4wNzgxLDI3LjU5MzggUTQ4Ljc2NTYsMjUuOTM3NSA0OC43NjU2LDIyLjgxMjUgUTQ4Ljc2NTYsMTkuNjg3NSA1MC4wNzgxLDE4LjAzMTMgUTUxLjQwNjMsMTYuMzc1IDUzLjkwNjMsMTYuMzc1IFE1NC42MDk0LDE2LjM3NSA1NS4yNSwxNi41MzEzIFE1NS45MDYzLDE2LjY4NzUgNTYuNDY4OCwxNi45ODQ0IEw1Ni40Njg4LDE5LjcwMzEgUTU1Ljg0MzgsMTkuMTI1IDU1LjI1LDE4Ljg1OTQgUTU0LjY1NjMsMTguNTc4MSA1NC4wMzEzLDE4LjU3ODEgUTUyLjY4NzUsMTguNTc4MSA1MiwxOS42NTYzIFE1MS4zMTI1LDIwLjcxODggNTEuMzEyNSwyMi44MTI1IFE1MS4zMTI1LDI0LjkwNjMgNTIsMjUuOTg0NCBRNTIuNjg3NSwyNy4wNDY5IDU0LjAzMTMsMjcuMDQ2OSBRNTQuNjU2MywyNy4wNDY5IDU1LjI1LDI2Ljc4MTMgUTU1Ljg0MzgsMjYuNSA1Ni40Njg4LDI1LjkyMTkgTDU2LjQ2ODgsMjguNjQwNiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3IiB4PSI2Ny41IiB5PSIyNy44NDY3Ij5TaW5nbGV0b25NYWluPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjM5LjUiIHgyPSIxNjYuNSIgeTE9IjM5IiB5Mj0iMzkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIzOS41IiB4Mj0iMTY2LjUiIHkxPSI0NyIgeTI9IjQ3Ii8+PC9nPjwhLS1saW5rIFNpbmdsZXRvbk1haW4gdG8gU2luZ2xldG9uLS0+PGcgaWQ9ImxpbmtfU2luZ2xldG9uTWFpbl9TaW5nbGV0b24iPjxwYXRoIGNvZGVMaW5lPSIxMiIgZD0iTTEwMyw1NS4zNiBDMTAzLDc1LjgzIDEwMywxMDAuMiAxMDMsMTI1Ljc4ICIgZmlsbD0ibm9uZSIgaWQ9IlNpbmdsZXRvbk1haW4tdG8tU2luZ2xldG9uIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjEuMDtzdHJva2UtZGFzaGFycmF5OjcuMCw3LjA7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMDMsMTMxLjc4LDEwNywxMjIuNzgsMTAzLDEyNi43OCw5OSwxMjIuNzgsMTAzLDEzMS43OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxLjA7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjMiIHg9IjEwNCIgeT0iOTguMDY2OSI+dXNlPC90ZXh0PjwvZz48IS0tU1JDPVtLeXllQUlhZWpqQk5CeVg5cDJpZnBTdEhJeXhGcktfRUlJbWtyYXQ5SjRtbElpcGJ1VzlwNU84cHl6OXBLYWxveW5JZ2tOR0xnZWpCNGFpb2FzaUxDbEUwaEJwYUwyazQwZzBxZEFzWG9RTURLOW9VTWs4OUxRLVhZUW9aNWlDTXR5SENhNHIwMkxHWEZKcXg5QVRPQVBHTWZ0ODEwMDAwXS0tPjwvZz48L3N2Zz4='><p><strong>Pros</strong>:</p><ul><li>Has only one single instance.</li><li>Provides a single, globally accessible point to the instance.</li><li>Useful for managing shared resources.</li><li>Prevents frequent creation and destruction of instances, thereby reducing memory overhead.</li><li>Ensures consistency by using a single instance.</li><li>The instance can be created only when it’s first accessed based on Lazy Initialization.</li></ul><p><strong>Cons</strong>:</p><ul><li>Inflexibility: it can make the code less flexible, as it ties the code to a specific instance.</li><li>Typically marked as <code>final</code> or designed in such a way that they cannot be subclassed.</li><li>Not suitable for mutable objects. If objects of the same type need to change in different use case scenarios, it can easily lead to data errors.</li><li>Violates the <u>Single Responsibility Principle</u>, if the design of the functionality is not reasonable.</li><li>Makes unit testing challenging.</li></ul><p><strong>Comparison of several implementations of Singleton Pattern</strong>:</p><table><thead><tr><th>Type</th><th>Thread Safety</th><th>Loading Type</th><th>Recommendable</th><th>Reflection Attack</th><th>Serialization Attack</th><th>Perfect  Version</th></tr></thead><tbody><tr><td><a href="#11-lazy-singleton-thread-unsafe">1.1. Lazy Singleton - Thread Unsafe</a></td><td>×</td><td>Lazy</td><td>❌</td><td>-</td><td>-</td><td>-</td></tr><tr><td><a href="#12-lazy-singleton-synchronized">1.2. Lazy Singleton - synchronized</a></td><td>√ (synchronized static method)</td><td>Lazy</td><td>❌</td><td>-</td><td>-</td><td>-</td></tr><tr><td><a href="#13-lazy-singleton-delay-lock">1.3. Lazy Singleton - Delay Lock</a></td><td>×</td><td>Lazy</td><td>❌</td><td>-</td><td>-</td><td>-</td></tr><tr><td><a href="#14-lazy-singleton-double-checked-locking-without-volatile">1.4. Lazy Singleton - Double-checked Locking Without volatile</a></td><td>×</td><td>Lazy</td><td>❌</td><td>-</td><td>-</td><td>-</td></tr><tr><td><a href="#15-lazy-singleton-double-checked-locking-dcl">1.5. Lazy Singleton - Double-checked Locking (DCL)</a></td><td>√ (volatile instance + DCL)</td><td>Lazy (DCL)</td><td>👍</td><td>× (<a href="#151-reflection-attack-on-lazy-singleton-double-checked-locking-singleton">1.5.1. Reflection Attack on Lazy Singleton - Double-checked Locking Singleton</a>)</td><td>√ (<a href="#152-serialization-attack-on-lazy-singleton-double-checked-locking-singleton">1.5.2. Serialization Attack on Lazy Singleton - Double-checked Locking Singleton</a>)</td><td><a href="#153-perfect-version-of-lazy-singleton-double-checked-locking-singleton">1.5.3. Perfect Version of Lazy Singleton - Double-checked Locking Singleton</a></td></tr><tr><td><a href="#21-eager-singleton-static-constant">2.1. Eager Singleton - static constant</a></td><td>√ (class loading mechanism)</td><td>Eager (when class is loaded)</td><td>👍</td><td>√ (<a href="#211-reflection-attack-on-eager-singleton-static-constant">2.1.1. Reflection Attack on Eager Singleton - static constant</a>)</td><td>√ (<a href="#212-serialization-attack-on-eager-singleton-static-constant">2.1.2. Serialization Attack on Eager Singleton - static constant</a>)</td><td><a href="#213-perfect-version-of-eager-singleton-static-constant">2.1.3. Perfect Version of Eager Singleton - static constant</a></td></tr><tr><td><a href="#22-eager-singleton-static-block">2.2. Eager Singleton - static block</a></td><td>√ (class loading mechanism)</td><td>Eager (when class is loaded)</td><td>👍</td><td>√ (<a href="#221-reflection-attack-on-eager-singleton-static-block">2.2.1. Reflection Attack on Eager Singleton - static block</a>)</td><td>√ (<a href="#222-serialization-attack-on-eager-singleton-static-block">2.2.2. Serialization Attack on Eager Singleton - static block</a>)</td><td><a href="#223-perfect-version-of-eager-singleton-static-block">2.2.3. Perfect Version of Eager Singleton - static block</a></td></tr><tr><td><a href="#3-static-inner-class-singleton">3. Static Inner Class Singleton</a></td><td>√ (class loading mechanism)</td><td>Lazy (static inner class)</td><td>👍</td><td>√ (<a href="#31-reflection-attack-on-static-inner-class-singleton">3.1. Reflection Attack on Static Inner Class Singleton</a>)</td><td>√ (<a href="#32-serialization-attack-on-static-inner-class-singleton">3.2. Serialization Attack on Static Inner Class Singleton</a>)</td><td><a href="#33-perfect-version-of-static-inner-class-singleton">3.3. Perfect Version of Static Inner Class Singleton</a></td></tr><tr><td><a href="#4-enum-singleton">4. Enum Singleton</a></td><td>√ (inherently safe, class loading mechanism)</td><td>Eager (when the enum class is loaded)</td><td>👍</td><td>√ (<a href="#41-reflection-attack-on-enum-singleton">4.1. Reflection Attack on Enum Singleton</a>)</td><td>√ (<a href="#42-serialization-attack-on-enum-singleton">4.2. Serialization Attack on Enum Singleton</a>)</td><td><a href="#43-perfect-version-of-enum-singleton">4.3. Perfect Version of Enum Singleton</a></td></tr></tbody></table><h1 id="1-lazy-singleton"><a class="markdownIt-Anchor" href="#1-lazy-singleton"></a> 1. Lazy Singleton</h1><p>Lazy initialization means that the instance can be created only when it is first accessed or the static method is first invoked.</p><h2 id="11-lazy-singleton-thread-unsafe"><a class="markdownIt-Anchor" href="#11-lazy-singleton-thread-unsafe"></a> 1.1. Lazy Singleton - Thread Unsafe</h2><p>It works fine in a single-threaded environment but may break the singleton pattern in a multi-threaded environment,  resulting in different instances.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LazySingletonThreadUnsafe</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingletonThreadUnsafe instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonThreadUnsafe</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingletonThreadUnsafe <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">            <span class="comment">/*try &#123;</span></span><br><span class="line"><span class="comment">                // Simulate the scenario where multiple threads do not always get the same instance of a singleton,</span></span><br><span class="line"><span class="comment">                // increasing the probability of reproducing the issue.</span></span><br><span class="line"><span class="comment">                TimeUnit.MILLISECONDS.sleep(200);</span></span><br><span class="line"><span class="comment">            &#125; catch (InterruptedException e) &#123;</span></span><br><span class="line"><span class="comment">                e.printStackTrace();</span></span><br><span class="line"><span class="comment">            &#125;*/</span></span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">LazySingletonThreadUnsafe</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Testing Codes：</strong></p><ul><li>Single-threaded Environment:  can get the same instance.</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLazySingletonThreadUnsafeSingleThread</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">LazySingletonThreadUnsafe</span> <span class="variable">instance1</span> <span class="operator">=</span> LazySingletonThreadUnsafe.getInstance();</span><br><span class="line">    <span class="type">LazySingletonThreadUnsafe</span> <span class="variable">instance2</span> <span class="operator">=</span> LazySingletonThreadUnsafe.getInstance();</span><br><span class="line">    System.out.println(<span class="string">&quot;instance1: &quot;</span> + instance1);</span><br><span class="line">    System.out.println(<span class="string">&quot;instance2: &quot;</span> + instance2);</span><br><span class="line">    <span class="comment">// `instance1` and `instance2` are the same instance.</span></span><br><span class="line">    Assertions.assertSame(instance1, instance2); <span class="comment">// √</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Multi-threaded Environment: may get different instances.</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLazySingletonThreadUnsafeMultiThread</span><span class="params">()</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">THREAD_COUNT</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newFixedThreadPool(THREAD_COUNT);</span><br><span class="line"></span><br><span class="line">    Callable&lt;LazySingletonThreadUnsafe&gt; callableTask = () -&gt; LazySingletonThreadUnsafe.getInstance();</span><br><span class="line">    Future&lt;LazySingletonThreadUnsafe&gt;[] futures = <span class="keyword">new</span> <span class="title class_">Future</span>[THREAD_COUNT];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; THREAD_COUNT; i++) &#123;</span><br><span class="line">        futures[i] = executorService.submit(callableTask);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">LazySingletonThreadUnsafe</span> <span class="variable">firstInstance</span> <span class="operator">=</span> futures[<span class="number">0</span>].get();</span><br><span class="line">    <span class="keyword">for</span> (Future&lt;LazySingletonThreadUnsafe&gt; future : futures) &#123;</span><br><span class="line">        <span class="type">LazySingletonThreadUnsafe</span> <span class="variable">instance</span> <span class="operator">=</span> future.get();</span><br><span class="line">        System.out.println(instance);</span><br><span class="line">        <span class="comment">// It may break the singleton pattern in a multi-threaded environment, resulting in different instances.</span></span><br><span class="line">        <span class="comment">// If the issue cannot be reproduced, try running the test method multiple times or uncommenting the code in LazySingletonThreadUnsafe.getInstance().</span></span><br><span class="line">        Assertions.assertSame(firstInstance, instance); <span class="comment">// ×</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    executorService.shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="12-lazy-singleton-synchronized"><a class="markdownIt-Anchor" href="#12-lazy-singleton-synchronized"></a> 1.2. Lazy Singleton - synchronized</h2><p><a href="#11-lazy-singleton-thread-unsafe">1.1. Lazy Singleton - Thread Unsafe</a> does not support multi-threading situations. We can simply and crudely add a lock with <code>synchronized</code> on the <code>getInstance()</code> method. While this approach can solve the thread safety issue, it is inefficient because it locks the class object (class-level lock, not object-level lock ) by locking the static method. This means that every time multiple threads try to access the singleton instance using the <code>getInstance()</code> method, it will be locked and only one thread can get access, greatly impacting performance. In fact, this method only needs to execute once for creating the instance of the class, and afterwards, all subsequent requests could directly return this instantiated object.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LazySingletonSynchronized</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingletonSynchronized instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonSynchronized</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// synchronized static method: the class-level lock ensures that only one thread can execute the static synchronized method at a time.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">static</span> LazySingletonSynchronized <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">            <span class="comment">/*try &#123;</span></span><br><span class="line"><span class="comment">                // Simulate the scenario where multiple threads do not always get the same instance of a singleton,</span></span><br><span class="line"><span class="comment">                // increasing the probability of reproducing the issue.</span></span><br><span class="line"><span class="comment">                TimeUnit.MILLISECONDS.sleep(200);</span></span><br><span class="line"><span class="comment">            &#125; catch (InterruptedException e) &#123;</span></span><br><span class="line"><span class="comment">                e.printStackTrace();</span></span><br><span class="line"><span class="comment">            &#125;*/</span></span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">LazySingletonSynchronized</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="13-lazy-singleton-delay-lock"><a class="markdownIt-Anchor" href="#13-lazy-singleton-delay-lock"></a> 1.3. Lazy Singleton - Delay Lock</h2><p>Based on <a href="#12-lazy-singleton-synchronized">1.2. Lazy Singleton - synchronized</a>, we can consider locking the instantiating process only when the instance returns at the first time. The instance is instantiated within the critical section, in order to ensure thread safety in a multi-threaded environment. Then, all subsequent operations will directly return the instance without entering the critical section, in order to improve multithreading performance.</p><p>BUT, there will still be thread safety issues in a multi-threaded environment.  For example, in the following scenario, threads T1 and T2 may create two different instances.</p><ol><li>T1: just enters the critical section and hasn’t instantiated yet: <code>instance=null</code>, T1 is holding the class-level lock</li><li>T2: enters the if code block, as the <code>instance</code> field hasn’t finished instantiation in T1 (<code>instance</code> is still null): <code>instance=null</code>, T1 is holding the class-level lock, T2 will be blocked before the critical section</li><li>T1: finishes instantiation and exits the critical section: <code>instance=LazySingletonDelayLock@4a87761d</code> (<code>instance!=null</code>), T1 released the lock, T2 has a chance to acquire the lock</li><li>T2: enters the critical section and executes instantiation again: <code>instance=LazySingletonDelayLock@2db7a79b</code> (Now it returns 2 different instances and breaks the singleton pattern!)</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LazySingletonDelayLock</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingletonDelayLock instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonDelayLock</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// delay lock in the if code block when `instance` is null</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingletonDelayLock <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">            <span class="comment">// T2: may still enter if code block here, as the `instance` field hasn&#x27;t finished instantiation in T1 (`instance` is still null)</span></span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingletonDelayLock.class) &#123; <span class="comment">// class-level lock</span></span><br><span class="line">                <span class="comment">// T1: just enters the critical section and hasn&#x27;t instantiated yet</span></span><br><span class="line">                instance = <span class="keyword">new</span> <span class="title class_">LazySingletonDelayLock</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="14-lazy-singleton-double-checked-locking-without-volatile"><a class="markdownIt-Anchor" href="#14-lazy-singleton-double-checked-locking-without-volatile"></a> 1.4. Lazy Singleton - Double-checked Locking Without volatile</h2><p>To improve the issue of <a href="#13-lazy-singleton-delay-lock">1.3. Lazy Singleton - Delay Lock</a> mentioned above, we further add a check within the synchronized block to verify whether the <code>instance</code> is null. If it is null, then proceed with instantiation. This helps prevent multiple instantiations caused by multi-threading scenarios.</p><p>However, due to the <code>instance</code> field not being marked as <code>volatile</code>, errors may still occur due to <u>instruction reordering</u>.</p><p>When creating a new object (such as <code>instance = new LazySingletonNoVolatileDoubleCheck()</code>), there are essentially three main steps involved internally: <code>1. space allocation</code> → <code>2. initialization</code> → <code>3. reference assignment</code>.</p><p>The JVM allows for reordering of instructions for performance reasons, while these three steps may be reordered, such as <code>1. space allocation</code>  → <code>3. reference assignment</code> → <code>2. initialization</code>,  it can potentially lead to thread safety issues:</p><ol><li>T1: enters the critical section and ready to new</li><li>T1: space allocation</li><li>T1: reference assignment (Since initialization is not yet complete, although <code>instance</code> now points to the newly allocated heap space, the object is only half-initialized.)</li><li>T2: In the first <code>if</code> check, when <code>instance</code> is found to be non-null (T1 has not finished full initialization yet), returning the partially initialized object directly leads to program errors.</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LazySingletonNoVolatileDoubleCheck</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> LazySingletonNoVolatileDoubleCheck instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonNoVolatileDoubleCheck</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add double-checked locking without volatile `instance`</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingletonNoVolatileDoubleCheck <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123; <span class="comment">// T2: directly returns the `instance`, but not fully initialized, leading to a partially constructed or uninitialized instance being returned</span></span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingletonNoVolatileDoubleCheck.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">LazySingletonNoVolatileDoubleCheck</span>();</span><br><span class="line">                    <span class="comment">// bytecode: 1. space allocation -&gt; 2. initialization -&gt; 3. reference assignment</span></span><br><span class="line">                    <span class="comment">// may reorder instructions as follows:</span></span><br><span class="line">                    <span class="comment">// 1. space allocation</span></span><br><span class="line">                    <span class="comment">// 3. reference assignment // T1: the `instance` is assigned the reference, but not fully initialized</span></span><br><span class="line">                    <span class="comment">// 2. initialization</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>We already find out that there are so many steps inside creating a new object. So, Let’s delve into understanding the creation of a new object from the perspective of Java bytecode. Let’s start by writing a simple test code for creating an object as shown below:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NewTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NewTest</span> <span class="variable">newTest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NewTest</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>We can compile <code>NewTest.java</code> to get <code>NewTest.class</code> via <code>javac -g NewTest.java</code>. Then, we can execute <code>javap -v -p NewTest.class</code> to get the bytecode information about the fields, constructors, and methods of a class file.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">Classfile /DesignPattern-Lab/src/main/java/com/sissilab/dp/ox1_creational/ox11_singleton/NewTest.<span class="keyword">class</span></span><br><span class="line">  <span class="title class_">Last</span> modified <span class="number">25</span>/<span class="number">07</span>/<span class="number">2024</span>; size <span class="number">487</span> bytes</span><br><span class="line">  MD5 checksum e132b23dc7ec6394be9137ad5aa7c33a</span><br><span class="line">  Compiled from <span class="string">&quot;NewTest.java&quot;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">com</span>.sissilab.dp.ox1_creational.ox11_singleton.NewTest</span><br><span class="line">  minor version: <span class="number">0</span></span><br><span class="line">  major version: <span class="number">52</span> <span class="comment">// Java major version, 52 indicates Java classes compiled with JDK 1.8</span></span><br><span class="line">  flags: ACC_PUBLIC, ACC_SUPER <span class="comment">// class access modifiers: the class is public</span></span><br><span class="line">Constant pool:</span><br><span class="line">   #<span class="number">1</span> = Methodref          #<span class="number">4.</span>#<span class="number">19</span>         <span class="comment">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   #<span class="number">2</span> = Class              #<span class="number">20</span>            <span class="comment">// com/sissilab/dp/ox1_creational/ox11_singleton/NewTest</span></span><br><span class="line">   #<span class="number">3</span> = Methodref          #<span class="number">2.</span>#<span class="number">19</span>         <span class="comment">// com/sissilab/dp/ox1_creational/ox11_singleton/NewTest.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">   #<span class="number">4</span> = Class              #<span class="number">21</span>            <span class="comment">// java/lang/Object</span></span><br><span class="line">   #<span class="number">5</span> = Utf8               &lt;init&gt;</span><br><span class="line">   #<span class="number">6</span> = Utf8               ()V</span><br><span class="line">   #<span class="number">7</span> = Utf8               Code</span><br><span class="line">   #<span class="number">8</span> = Utf8               LineNumberTable</span><br><span class="line">   #<span class="number">9</span> = Utf8               LocalVariableTable</span><br><span class="line">  #<span class="number">10</span> = Utf8               <span class="built_in">this</span></span><br><span class="line">  #<span class="number">11</span> = Utf8               Lcom/sissilab/dp/ox1_creational/ox11_singleton/NewTest;</span><br><span class="line">  #<span class="number">12</span> = Utf8               main</span><br><span class="line">  #<span class="number">13</span> = Utf8               ([Ljava/lang/String;)V</span><br><span class="line">  #<span class="number">14</span> = Utf8               args</span><br><span class="line">  #<span class="number">15</span> = Utf8               [Ljava/lang/String;</span><br><span class="line">  #<span class="number">16</span> = Utf8               newTest</span><br><span class="line">  #<span class="number">17</span> = Utf8               SourceFile</span><br><span class="line">  #<span class="number">18</span> = Utf8               NewTest.java</span><br><span class="line">  #<span class="number">19</span> = NameAndType        #<span class="number">5</span>:#<span class="number">6</span>          <span class="comment">// &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">  #<span class="number">20</span> = Utf8               com/sissilab/dp/ox1_creational/ox11_singleton/NewTest</span><br><span class="line">  #<span class="number">21</span> = Utf8               java/lang/Object</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> com.sissilab.dp.ox1_creational.ox11_singleton.NewTest(); <span class="comment">// auto-generated default no-argument constructor</span></span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">1</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="number">1</span>: invokespecial #<span class="number">1</span>                  <span class="comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">6</span>: <span class="number">0</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  <span class="built_in">this</span>   Lcom/sissilab/dp/ox1_creational/ox11_singleton/NewTest;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(java.lang.String[])</span>; <span class="comment">// main method</span></span><br><span class="line">    descriptor: ([Ljava/lang/String;)V</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">2</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="comment">// new: allocates memory for an object of the class referenced by #2 -&gt; adds the reference to the top of the operand stack</span></span><br><span class="line">         <span class="number">0</span>: <span class="keyword">new</span>           #<span class="number">2</span>                  <span class="comment">// class com/sissilab/dp/ox1_creational/ox11_singleton/NewTest</span></span><br><span class="line">         <span class="comment">// dup: duplicates the top stack value -&gt; adds the duplicated reference to the top of the operand stack (because the subsequent `invokespecial` will consume a reference.)</span></span><br><span class="line">         <span class="number">3</span>: dup</span><br><span class="line">         <span class="comment">// invokespecial: calls the constructor to initialize the newly opened space and consume a reference</span></span><br><span class="line">         <span class="number">4</span>: invokespecial #<span class="number">3</span>                  <span class="comment">// Method &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line">         <span class="comment">// astore_1: pops the top stack value -&gt; assigns the reference to the element at position 1 (`newTest`) in the LocalVariableTable</span></span><br><span class="line">         <span class="number">7</span>: astore_1</span><br><span class="line">         <span class="number">8</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable: <span class="comment">// maps the bytecode instructions to the lines in the source file</span></span><br><span class="line">        line <span class="number">8</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">9</span>: <span class="number">8</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">9</span>     <span class="number">0</span>  args   [Ljava/lang/String;</span><br><span class="line">            <span class="number">8</span>       <span class="number">1</span>     <span class="number">1</span> newTest   Lcom/sissilab/dp/ox1_creational/ox11_singleton/NewTest;</span><br><span class="line">&#125;</span><br><span class="line">SourceFile: <span class="string">&quot;NewTest.java&quot;</span></span><br></pre></td></tr></table></figure><p>Although just a few simple lines of source code, the decompiled content is extensive. Focus mainly on the Code section below:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>: <span class="keyword">new</span>           #<span class="number">2</span>                  <span class="comment">// class com/sissilab/dp/ox1_creational/ox11_singleton/NewTest</span></span><br><span class="line"><span class="number">3</span>: dup</span><br><span class="line"><span class="number">4</span>: invokespecial #<span class="number">3</span>                  <span class="comment">// Method &quot;&lt;init&gt;&quot;:()V</span></span><br><span class="line"><span class="number">7</span>: astore_1</span><br></pre></td></tr></table></figure><p>The process is illustrated below:</p><div class="excalidraw-svg"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1081.6370313640625 772.25" filter="invert(93%) hue-rotate(180deg)" class="excalidraw-svg"><!-- svg-source:excalidraw --><defs><style class="style-fonts"> @font-face { font-family: Virgil; src: url(data:font/woff2;base64,d09GMgABAAAAABiAAAsAAAAAJtwAABgwAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABmAAgRwRCArDWLIAC1oAATYCJAOBMAQgBYMcByAb6RxRVM8qZF8c8ObQKYfzYhl1y0eMQV7LSUc0Z7N3uUsupuAxxBPEvyQhCSFYMGkJEtxq+o7U5SsKfVEqKnzfpOb8pdNPuuuk1vChPSAob3rArtlt97UkcKzAWjLF+SA7QCTo/4ACgf+b0+/lrbS9unKcwoPgA6ZVOjlzMsCfNptm27eVHduhgu1QYSDw27QD1DfAsvXBlOXQVLP2iL9rg5pCeIzD/fKh/Wb9h1cRqZROLMdHH8zsEEuTJN6uzWIVtSQa99fqQiuUuFJmaW2tg0+xU6RcNovrixdnAhpmQf1AAGAfYQUAkAKVbjjAJxAKryMWIEiMYYA7IJ3GroUZZjPoQA59eNf7j4BoR6AuAODlmi3oHPY2Fk89U0QmxCqHvJYGC5gH8KfAJTxMBX4QDOEQBbFggVTIgTxogW7oGx8HqAr7QhBoSLauFNp+q/Ex99xy3TVXXHLUIT+Mfz8+Mj48vhcQYAiNA0zKA0mBEKFhpRTZbwE9DEAJAxSaMZ8seCVgiYQb5zSnP3CjKCjcU+gp9Z3EKyvIFIsnTcjM+EDrFCcOkIXma2VFBUYnN5lvuspmdpX7i4PMFbZYW/Id+ZvHyLBXDVdO3xHQXjM0MrWKekNDt4Wf6azUExbrNYJQP43wKeQllFy0bZuJyPbz8b3b9ZweMB88gkpFIObiTB4JdqlxDF03qnGggBhMeFKzuXIBgyHFQEoo++9hZEXa4KUgCCQ0HMWbRIp6kOHIR5fXyo6yGem8aKMY50QtE6zUtjt5SKENSuJFwe5+CWNFHLXw/v2/st2cUQFN/8QbL/vqoU4/yqVf7CYnogRb7M/nV4West7eXrxRpkoXHfUIh1vTUKlx+sb/8VNhcN+nCadRyAdmcAmjMXo4HGKeG5YTMbp6miDP5uGlPrW59O3axLaZo9ilwMK9i8LBkfLmp9haTLTPMrHvzmp7ndyY/EjNJTyFjlWY/v+8RhxS0xf1bpcBJ/KGgj+QqFJYsNSgcYzI0OWV6UXQHIyRLsetnShngmHQNQPY7VsuSUc6YHesyc3d6dNTgeJ54x7zqkRhaPeCllNI8ZQehAXMDa9UQLcL+O+cpeZK6uBk4e3VtNRs7r7L1Lwyf9X1q2AN0Yt5KfBQOupTRPx1/4Nh8r1X5chxMFoTonWMasgJTal59M7kaHxR9ifNkspzIdj9GbBop54UvIwnT4Ez8PfRyXiWO/q2vKrJvtytWjeS8t+j8wMzUCa6+IvA6fKxwEOYMKkJ0e06HU+z2YZJ0oWxMgezap2iDGiHoOdxVbAGRvgBO75TN1xd0dN8r7Mvnos2xEHPKGpw56h0QgFaCwhh34IQI5tsp2gZAmX6kF03g0e2hDMFlUfmCnYHq15tJqL5hY3K4lVhkMJlQFdKikvI/YV4mvV7B6kL2CCqC9zHV+9XaKD0YOGazQ3Ti/PuRHC9NhBtWRN6zXB1y9Bb+awYLgKqxlNlM9jPnk4yIaJWXd3KT48rE9WMkiRYbiigFa8BKCV4Bxol7xbK30czTL+eXzxZW6LTuupgIlYZpIr0vAJ0m0Dnpwwu1jGqhXbIKbRt4gQZzyTlaCBWi1Rcvw+xru1aUYKVzvpHosPxVZgwGXSmnZ+E/PRT7LfvyXPJOGciykEAVkFRdsLtmJd8OdNR58600BQ3/qbXqhZjNf4DYe3cRYrT9a02mXQEhGEedJn0dw3yJEcJ6VLGDKln4C2kAceYUDzrYAGllGhPsEadvL2SJdu2PV6SYi6fidrqViayEQ9NJLgLBTrKVA2CgAU7tnguSua6icX+JnZLWvzqtyHrQ8im+mJtMBE+8Z+JO8GxMTWfU2/dB1ilnLEJqOn/KwSUF12SOLPS5EiLB/neY3ofzTvnapPraH2/KhL9xY8idhksPF/WbPZ4eaA9Tj2bh6eTEvCckZETYWuYvDNgkL/cHeZ0G63K2J/XP+pXlkSsD8sFfEsGsx1lFmwDe1dYLfB4Gs+EH3cLhR5pJT0k6dnVkE8fkhtK/HUupeYZSllOvrm5q89n273i4EAAJnDwFfIY7G63oBoeXz6/vvAneYBdyJ9U0+o4Kbu1z+kfM0pGcDEu2NljIGrT6b9jo05Je03Eedrm5LkcV4gqBcp0iDT55+FGzENAao5w39/0W4gKivvR+NdjlFRqO5Vjt7Cg7llqXgwpw16idI32O6di9aEvNne27uG3QZ4rtNJFXQZOYfjyJTttiX98pGtedd9TssJY5aJBVkZCJ0akRdTeEiMG2WkcN5Y5eS5BV6K1IoMT5CSX7s4UbE7j8+cN6maQmgRn1GScJ6QTp5QMgM9THSuOnplP9VXvbRDZZ1rEOu0dhc2DjWQu0Vc3GdxWnpTAD06A0sZWvMdA/5ZKLvqEH764CKEyCxTtcQYzF5pGfav7vv25W8D4ElJjsYMt7VdrItGrlRUnaZc7nGybl2kVE8cXfTVjUNyOD5bpBgJSk5ucqaLVUwZZWeHjm3SdPPDs+EdMW69zkkSjdHyeUqrprXDVcMkrbOyR4dsrDDi9Sr0eb87ENMF08414GstuPJDb00vMMyVJkgd8fbZ8LBxbo+ZJ+uPODeVLyl3U1FPKHGdya3I2q6dl7s2o1bYkm51WzSYPiUNi86dOlpdprcMgSxs3xJMHkAPJIHh1ySlJ+YwPSv0LlS3p+cX/H4oZFBX/k0gRgFa8ZpPTDt4Ph5/61cpTPLg7P7I2s73jTnOgxUp+Wny5EKxmVxMDTC32W86qEVHswgKNn/DMBLsSbIRsuB5DAaS5xb7hdtp7fyv3KzPI/WIGtND4rFp6esAhFRLlEvlLyGAgpFZ7ySTcsFNl6E/VJCFgQA3yJlZFbuEQTdnlqpDpVGwyiG+X/QI4DL6nJ7+NzTJtnP4DdU6qvhNhFTYZhD58ioxE16ss/fX0mJyh5D066kGe3PCUIgVDU7dJB+tipTqp1u16gfaW0nYymZ/hRg3WSoppSb65uXnfy+VGeRLsBd6JIjTjIIDGlhk2VlLkudI8cOdJ53RZ6uJ4Q6NRuM/gotRP88GVct/H7lXRojYIX9r4Aj5XMN/KPAgAXb4eX17/I5731fCrI285K/+tD0VYzM0Q2fGR2+LHU2u/VN8jRTEHm2X7na+/ns70wQ4VNOy5hlpuptTxAQchgODcK86KnXo6D+Puz49wSGdH+NNWOkqQ/9ZMnmPrM7FDHs6oY524uLwDXxdFuHFoS93Lf+z/EG22/DVDDJcPy0DIiJFtL7pEQWNMgk+KUwZ5GQy26ltC1ysfkfdj0kuVpA2vx3uiHsX6qJynHlHHCmA3NMGXzdpoHBx+vjlXFaPXuiwKjxhdFHtPrpoe9EudWWKiRVtimoewvsfnSJONvtExufv7q786OFYg1Lfo7MzjucMEy7r1mWi1bbnaf9fjcYQzg2u1mtjUV0WI4IRWOpNuZMT186+ncdyfNtsMLuUlDFwWHh8do/0Xw78xbfc4FTABg++wWT1RHeZ0OtESQrJYLgF94S8Grw/hf13jUEN8JO+SuQaO+TDODxb227nlbV3ZPl7cZIcr6RtKz9O7gGsurVtQgHNI38T1jLHWsMwkrSRvN2UFwkqLIW8wnDwmC7MZyomM9YKj87qE7sFu1H8cPBIz0dasE+ZOXyxgdpFta78KJEazYbUH4+qJ2Z8Fw6zYz35OuR9MdYlDhWG5+c+yMkkMxSLMrcF8YMZB3ohS6LK5aT+LvoM6n66IHZSVyBPRm0I/bBhHQJ0K/8ZgeRcyXxBXF4nESMgP1Ss6ciOWLVGXi2MsBZ3Kbr/xnDFn1iTKYH927rvz7nKgY5WCoFz/9u44VfvkbVnrTvMF8Br4gtv7JRz6etry6wxVYpoya7Yyz20Bx2LWz8SveF6RDhyg6E9xHohJmeWJTPyC6P/9on3t+vJDhWNVMwaldp/+48b7guXbwOgkTUG9Fb95D2WwSksPSWasboTp1pg1JpZ+9m3kwyDKfXP0+h7lmCo3cMFXGypp3rbUO6apE+M/QYVOpUFThK/oRe89dVHf9vgZ1z2BkZJDaergma+WXdo4M34hVKV5s8Q+zk55/7PFT6TZvRHIhbmvjImxebQGLmcSXp3cS2OL/kZGNOqBQfHAlTvd9FpyxAPvi5/MNHjtpa/scWrNa1w2q0GEpMgLhcmz9Lrw77xCypR/Z+XJY+5T0MWpm6rK9jNcrOq7MmPREQM/IcejZle8nF6x8IJgSrMtPpssvXhy+a4RdFHisyH+/zfGj2lj+V+KFHyEs49KnVXn4RlOkiHmBeWzipVPMsVWXZpi9/GMH6PjqCXX96U6by/mVJaZypdbD/i8HbZJdZKXbaXUWLpYXO5s/WzCJ5cuBtv/nP3oC0HpB7RqMMfnrd9Gm5dENkyCvghL4e+l8yJYNGO2cWUDfe3jsYWOl6YxmP7f0Qfp4tOOtVZnBhc7nZhvMm0f3PPRg6yiZ8SzdRELq0Xd/iEv6BGIvwyJFWU3BGaZgCPMHpFIgtZhSr8Fc3Zv4a1h8x8L0dVQbvQnrhJ5AGjatUpTCZ9B4IE0yOzj8QrXjs4Z/SYk0CHyX/RY4V3D5Mlv17ksvzzyWJiO6XEMaeS4H67RgMYujnR/SP4U3NohiPPSWp8s6kziNJ8I+AxLQcfwKaPY0bOeZoasQ2Un7TQH5Q8ZOa4eW3huC1gbWcgQ+SGpk2r2+NN+mhHH5/xVQQ9Apl6MO/fArKXOE6HyBwPRpz5tZooZpaPtCTUqySyiJsDJ1sNXlkwoCGEVoixsFBdt5D93bmhjcKkkhQcyIs7XQoZBAq+C3abiFllIca1NHVXpLN1+DOFYfrMryuBSJle/DFHHPjk5i7J54XZYitdRWdgefWbUb/8ma9RFET0SqzZgUiCDLEV/LgliiTZwrJv/KXjqN9FNRBU23QxTHZ7PnLE26+OsqSBwrZpG4fXBGDWPC8wOfvCY9xIt2vbUW4es1F/9S7JN2txGn8nxvGur9rTaNGgy/vX9j2ckQdvga8OBReXzdCyifx5WgmyiGs2uKeH709yY5IEVKZ7t/REJ6XMnPdPHNzoaUTuWrtyyrRhSUrklGlsOZKBprR7js1QSXrz763K/JdmyErqOcMzF17bwiRamBY1ZaQGkWeHJQMv4Leta2JvYIkL3QEf8Rc+H8wwmtXw97jRd+R3/iCExzIHSCRHtBMiiZr60j3xvPoKU25SOOo+8sydqespGPdKk1mTOL9j+6Y8ff4vlBkZ456hzvyv5egduw3zD3qVVzt+f3PNxaO/APvX8Hte/M6M0IDM4n85FGsLMIluIx3t5tu94ayRkcZV8A5Yrj+U4kgSB7CoiASewhhnbGTZiBv8NEclgfwR5hqdF0KPs1s4l1itC9we26tplGXX24eJNsOTzzvXJlca1D/RO3p/WXc/Ilfgjf9M3gZXKAQsvgy6oXR59+vZkrWNi+PrwzspX/fxtmG8cWu3EnuVdHmfQzsmr8pe4qAXX0BSHBe+hh1tpYUMFwy00kEV+w3SV/MeR1N0WLGG6PSR48934HzEMchx/pqNlkgLLcs9gmzK65cMlqeF2VJnkZw2mSpClQUdF7/N+aOLCa2OWYLh35AuxKHF4iSMNeAebPp8lLfX5Q3dMUdWUcGwU3/drTPimP1sfdV5uSMXLAjY+j1/bKOxxdhwn4v98WnG+QWQt83z3GohtdCpjdl86W78BY45kaRQjjjCwtexXyF7URZlWSxHei6QM+yrOtFn0+K8fZrmmBMl4ZBPpxa5Xe6apdYClYCH5bq46q8ffEXRizzL//aTtrfhYbGpYUvKhYxztiZu7XpGZUOWWVJzrWoVfKDYH0vLyEyNl4b8qSa0CUUxdZ5EeH5LiwYNBQ/SybyivaMP6z4/+Js/HbZpkL5+Jf/k090kkP8+hzWKoUALbX+f67ItMJ5cbVSgS0qm+LYWS6SpPfn/sMIlKZSSrmCXaNy4q8hO9aE7VFUyqGPFOUlCEatvpjY7/c5yMsbrcyvw09R9Hbdy53NqjJxaL8i8tmRAATySu9ZK13jLnLgbBiHabzqLfTlMMvJw/y69PIkyE1NtlMuF3xsEXShySBWTKhBhuZzIrLlSTMj/WwozLzjuUHpUEJIP93eiXpgcfJBvj4pK3VX0ruKWWG8Slnh+vxPkPNMP6OWoznUlzj64xBXzKX0Dmdt8O/EMoMkcVNa7QOUPsv9/51Ycn13DYV1nSQeGKcDVO44SEabAUIV6MOVOtTjGs2W0w/utdZlBMYgMlIrs6e6qkUoVF7Fmwxq3A30ssyGMxvC9bZGYmLxE4gZN+RraBTdk7QwvyYwS1zG4p5vcpn9po+dOVbqMX0F3c//Q+ck7S2HwpiKEMQViIX51hI3BA5WWTsrqN7xfsmCo1r6D7cxKGM1OCFIHuAz9lfiPlzi3goLoci+f+j32ec8M4JVzLDu7L+8vDQq46STP+Lgr1O+zwps35qjAdVn+2pwJhDIwq35Ax1XRsW1jQtyxmtbvBX0R8pvlSjenr6cWqXkvb2pe1Swm95rfNbAFZjZPmlwc7bBPLIJH5UwCfDGg3uQ8UXJhm4hpuYnXBkLKHxTpJB4oV1Ct18+Qw8SQmB00U1yIrJ8a/ZnQNp++YWHYMST7IhBZ5aeCj3kcFfl8/E0eVOlTxab3Xdy+0jjIKUf5P7iu82d0Hc8abdnwUNAWroLTZxh7BqgyhSYXCUv8dwm4n5LPqMC0Y7V6Gj2kb7erV2JNYKXsARDx9VESWKDi9dZ3xe89k1iJ3Ao/BCRo/8aH8UF0AxUSdkF+THnnTfHWUz9hQ11+/zyMpV5iJH0Auf8lrSKazsKpaqC/x3mVJKmOA25yGOv/av7rfbF6aYF2QcCzMvDOhcarbM0eLhuFf+2NyekDjw331Ab550uRoM4t7cJlneE5woDR61rKTs5W8b3cRRa7eoGU+PCEycehDnR4ayzv2tP+aJihvZoWvolHYPAW9LrZycFnk3paWm3k/CHySmFsYUOWCskoo49DEiJ7sFLd41xMuhsRTNxZsGnJNJigFqFj19xZpY8zHcsLDcFmI7Sm3I9z5xnmGRnfly9yED90nBOTVS3+wrvuYw/172vXVoDeJrnhFh/7tvnGvjiUNHArrClqdZnB4pMSYyy+6ko36RNGrEnU2gSnwR9phY5dFkjWXyHw40vnm2uW5L+4NZ2I0Jju5pC1VdOmhoFUxbRps+Q5luqfkJeppcsp9b/mt+4kxogK2pkpYjVbWSDcGe6H8KvQM097cq7+waTvMLHth5u/l97PMbG9p4m4X7UPqouaJbVg/x9RdOyWJ1ineNXrhTqbOPjkqzdYqn8a6UOx18UsvRE9kAKxz1kWf2UnHafYNXMUrNRZYSaU2BTyJYZFEoSZqcZ/F+w7++7WEi6haKGXmcsjg5yKlduY1rPXDYDZOw9ResSF+z8tfsyTWZ4eVs/tXRRA4yHYqH1b8xrz8Xo+nuNRJPE/ufKx6V9J0bZ+vnVygPODPIwOSZ+lspkkrLf8aNgu+RosEB7WC4W8M7vxHTpZTZWqdB0g9STZfH6avtl+df1dJFRJNdLpO6CSlX9PqlcVYo1EYybhRe0T4jeS0aPMvhoIdFofAgTJ1dm5B+weWYKPZKA891+lwNlqW43LWpdC1VH7ABA83VAJzmQ9br72cww6nO5tWRHR8UiH8Y5k8tsrA4tWQrk3N5ut2+2XN96OV7MkiEW8RSuF4LMjQfvpl3O1qtIyPGzTM0mJnvs3mlNo9lswYJTS/6ACpf7+t3fxcXFbKi3/GYOF/AOo36xtPJdf4ef1/G8Yr3r2m/UWbCgAMwBiJnz5thLpCM14kTvEYHohMAOgpBe7Jt1kDTJQFArQCREgIBmwPaBBvHHYGidhWQNgMYGEu4ASPQY/5gAeWDxzMDhSuHj89Ahh47Pgf7YdCjPu5b0GKngOFxQCGqUCIfhv/uWfARf+BM9wCAlnGF6Dfx59Eh1SsFwLQJZBh/iBF/4IT2lXs7QlcLGL8wqLBB2MBHyubLsSDZOv9gXAXSGA+h1T6QNWADkWGIRpVGGfBaBABG0aCGHBhcxCHPLAFaSCF2CABHuAG0gEoA7XQBtXD4Q0QBFng0KQTZREaJw7SPrwZmkAOmlDUQnDCs5YmDAohA8xgprfGURYTx2VxEKrEPuJ0IRWiCn6beNbwRGiGFugdR61fqwY6QA6+UAF+iaihDVSzcuh1KKSh01FVyIDuLcuZt7C5I0OnR2UVpSHYMz00hNnypebax+BIiANdDpWkHhwQjQAAAAA=); } </style></defs><rect x="0" y="0" width="1081.6370313640625" height="772.25" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(14.490141898123547 38.5) rotate(0 50 67)"><path d="M0 0 C25.66 0.7, 51.37 1.35, 100 0 M0 0 C24.31 -0.36, 48.98 -0.01, 100 0 M100 0 C100.25 29.92, 99.83 56.31, 100 134 M100 0 C101.85 34.28, 101.22 68.56, 100 134 M100 134 C79.06 133.86, 56.21 136.15, 0 134 M100 134 C65.44 132.33, 31.25 132.83, 0 134 M0 134 C0.3 88.25, -0.78 48.12, 0 0 M0 134 C-1.61 98.19, -2.28 60.29, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(13.490141898123547 83.5) rotate(0 50.5 0.5)"><path d="M-1.04 0.59 C15.95 0.49, 84.78 -0.22, 101.69 -0.11 M0.61 -0.14 C17.53 -0.18, 84.66 0.37, 101.11 0.84" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(14.990141898123547 128) rotate(0 50.5 0.5)"><path d="M0.39 0.38 C17.24 0.29, 84.83 0.36, 101.56 0.38 M-0.87 -0.47 C15.83 -0.48, 84.11 1.26, 100.91 1.59" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(236.74014189812357 76) rotate(0 59 47)"><path d="M0 0 C38.66 0.54, 74.91 -1.33, 118 0 M0 0 C39.08 -1.01, 79 -1.36, 118 0 M118 0 C118.44 24.68, 117.96 48.68, 118 94 M118 0 C117.52 19.38, 118.21 40.02, 118 94 M118 94 C75.19 94.43, 34.15 92.27, 0 94 M118 94 C77.82 94.84, 36.63 93.55, 0 94 M0 94 C-0.41 67.76, 0.15 44.89, 0 0 M0 94 C-1.14 63.88, 0.01 33.28, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(307.74014189812357 77) rotate(0 22.649986267089844 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Heap</text></g><g transform="translate(31.740141898123547 10) rotate(0 28.91998291015625 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Stack</text></g><g stroke-linecap="round" transform="translate(246.74014189812357 131) rotate(0 27.5 15)"><path d="M0 0 C13.07 -0.5, 24.09 -0.47, 55 0 M0 0 C20.86 0, 40.47 -0.2, 55 0 M55 0 C54.71 11.37, 53.62 22.77, 55 30 M55 0 C55.08 7.66, 54.81 15.23, 55 30 M55 30 C33.78 28.33, 16.56 30.71, 0 30 M55 30 C32.6 31.02, 12.05 30.79, 0 30 M0 30 C-1.55 19.6, 1.06 11.72, 0 0 M0 30 C-0.39 19.09, 1.08 8.35, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(425.48199552483726 66.08986759809187) rotate(0 60.999977111816406 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#f08c00" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">0: new #2</text></g><g transform="translate(390.7271973769546 101.93924394222455) rotate(0 244.56980895996094 37.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">The `new` instruction opens a space in the heap </text><text x="0" y="42.62" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">and a (ref) reference returned will be pushed </text><text x="0" y="67.62" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">onto the top of the stack.</text></g><g transform="translate(49.740141898123575 49) rotate(0 15.269989013671875 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref</text></g><g stroke-linecap="round"><g transform="translate(92.74014189812357 68.11313063217625) rotate(0 82.39279176369308 37.4946599132646)"><path d="M-0.89 0.14 C26.71 12.72, 136.76 63.71, 164.57 76.09 M0.85 -0.83 C28.35 11.39, 136.01 61.83, 163.51 74.55" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(92.74014189812357 68.11313063217625) rotate(0 82.39279176369308 37.4946599132646)"><path d="M138.6 72.39 C144.3 72.68, 151.34 75.49, 163.51 74.55 M138.6 72.39 C145.59 72.46, 151.07 72.86, 163.51 74.55" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(92.74014189812357 68.11313063217625) rotate(0 82.39279176369308 37.4946599132646)"><path d="M145.82 56.88 C150.02 60.52, 155.49 66.71, 163.51 74.55 M145.82 56.88 C150.92 60.89, 154.56 65.24, 163.51 74.55" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(11.115141898123547 221.25) rotate(0 50 67)"><path d="M0 0 C29.44 -0.7, 55.63 -0.91, 100 0 M0 0 C36.16 0.91, 72.68 1.15, 100 0 M100 0 C97.91 46.56, 99.03 90.25, 100 134 M100 0 C100.41 37.51, 99.77 72.39, 100 134 M100 134 C67.63 134.86, 33.94 131.36, 0 134 M100 134 C77.67 134.39, 57.98 134.63, 0 134 M0 134 C2.75 104.98, 2.63 78.39, 0 0 M0 134 C-1.83 83.55, 0.09 33.35, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(10.115141898123547 266.25) rotate(0 50.5 0.5)"><path d="M0.88 -0.71 C17.85 -0.59, 84 -0.18, 100.81 0.16 M-0.12 1.53 C16.77 1.83, 82.84 1.65, 99.77 1.26" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(11.615141898123547 310.75) rotate(0 50.5 0.5)"><path d="M-0.71 -0.19 C16.08 -0.04, 83.15 1.77, 100.16 1.78 M1.11 -1.33 C18.33 -1.6, 85.82 -0.26, 102.43 0.07" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(233.36514189812357 258.75) rotate(0 59 47)"><path d="M0 0 C42.67 1.49, 88.71 -1.62, 118 0 M0 0 C31.27 0.9, 61.87 -0.44, 118 0 M118 0 C116.3 18.86, 118.41 37.34, 118 94 M118 0 C117.98 31.1, 118.45 60.79, 118 94 M118 94 C80.55 91.6, 48.08 93.72, 0 94 M118 94 C92.77 94.22, 65.9 94.37, 0 94 M0 94 C-0.01 59.36, 2.06 21.49, 0 0 M0 94 C0.08 75.51, 0.38 55.61, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(304.36514189812357 259.75) rotate(0 22.649986267089844 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Heap</text></g><g transform="translate(28.365141898123547 192.75) rotate(0 28.91998291015625 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Stack</text></g><g stroke-linecap="round" transform="translate(243.36514189812357 313.75) rotate(0 27.5 15)"><path d="M0 0 C10.84 -0.9, 25.31 -0.94, 55 0 M0 0 C16.97 -0.85, 35.99 -0.29, 55 0 M55 0 C53.47 6.68, 56.7 11.52, 55 30 M55 0 C54.14 6.46, 55.97 12.28, 55 30 M55 30 C43.64 28.78, 31.78 32.41, 0 30 M55 30 C35.4 30.41, 16.62 30.35, 0 30 M0 30 C-0.46 20.24, -0.55 16.21, 0 0 M0 30 C0.03 21.98, 0.66 12.97, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(46.365141898123575 231.75) rotate(0 15.269989013671875 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref</text></g><g stroke-linecap="round"><g transform="translate(89.36514189812357 250.8631306321763) rotate(0 82.39279176369308 37.4946599132646)"><path d="M-0.45 0.01 C26.88 12.74, 136.69 62.83, 164.32 75.29 M1.52 -1.03 C28.62 11.41, 135.91 60.48, 163.13 73.32" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(89.36514189812357 250.8631306321763) rotate(0 82.39279176369308 37.4946599132646)"><path d="M138.22 71.2 C146.41 71.22, 155.08 73.57, 163.13 73.32 M138.22 71.2 C145.51 71.66, 151.38 72.37, 163.13 73.32" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(89.36514189812357 250.8631306321763) rotate(0 82.39279176369308 37.4946599132646)"><path d="M145.41 55.69 C151.09 60.78, 157.4 68.23, 163.13 73.32 M145.41 55.69 C150.52 60.48, 154.35 65.6, 163.13 73.32" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(433.1110687114803 250) rotate(0 31.09998321533203 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#f08c00" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">3: dup</text></g><g transform="translate(393.14524620608216 289.2974478460208) rotate(0 298.8397216796875 25)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">The `dup` instruction duplicates the top-of-stack reference</text><text x="0" y="42.62" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">and pushes onto the top of the stack</text></g><g transform="translate(45.240141898123575 276.5) rotate(0 15.269989013671875 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref</text></g><g stroke-linecap="round"><g transform="translate(81.74014189812357 292) rotate(0 87.5 22)"><path d="M0.79 1.12 C30.02 8.49, 145.53 36.27, 174.71 43.52 M-0.26 0.67 C28.85 8.25, 144.31 37.82, 173.62 44.81" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(81.74014189812357 292) rotate(0 87.5 22)"><path d="M148.75 47.44 C156.66 46.16, 160.01 47.45, 173.62 44.81 M148.75 47.44 C156.56 46.86, 166.93 46.31, 173.62 44.81" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(81.74014189812357 292) rotate(0 87.5 22)"><path d="M152.88 30.84 C159.7 33.61, 162.05 38.92, 173.62 44.81 M152.88 30.84 C159.34 36.09, 168.26 41.38, 173.62 44.81" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(12.115141898123547 411.25) rotate(0 50 67)"><path d="M0 0 C19.69 1.07, 41.15 -0.13, 100 0 M0 0 C21.49 0.15, 42.58 -0.64, 100 0 M100 0 C100.48 53.16, 99.2 103.32, 100 134 M100 0 C101.39 46.8, 101.78 92.67, 100 134 M100 134 C66.76 133, 32.53 133.77, 0 134 M100 134 C67.78 134.08, 37 132.29, 0 134 M0 134 C1.53 90.27, 0.18 45.61, 0 0 M0 134 C-1.97 100.65, -0.29 66.6, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(11.115141898123547 456.25) rotate(0 50.5 0.5)"><path d="M-0.49 0.94 C16.4 1.04, 84.35 1.01, 101.08 1.22 M1.45 0.39 C18.21 0.05, 83.39 -0.8, 100.18 -0.79" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(12.615141898123547 500.75) rotate(0 50.5 0.5)"><path d="M0.94 0.08 C17.71 0.15, 84.34 -0.33, 101.22 -0.1 M-0.02 -0.92 C16.56 -0.7, 83.37 0.81, 100.38 0.86" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(234.36514189812357 448.75) rotate(0 59 47)"><path d="M0 0 C30.93 -1.92, 63.12 0.7, 118 0 M0 0 C42.96 -0.18, 87.17 -0.8, 118 0 M118 0 C116.75 26.54, 120.01 50.16, 118 94 M118 0 C118.85 31.12, 118.03 61.86, 118 94 M118 94 C74.04 95.33, 32.57 93.16, 0 94 M118 94 C87.18 94.96, 57.79 94.75, 0 94 M0 94 C0.48 58.73, 1.28 23.94, 0 0 M0 94 C-0.24 73.85, 0.19 53.27, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(305.36514189812357 449.75) rotate(0 22.649986267089844 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Heap</text></g><g transform="translate(29.365141898123547 382.75) rotate(0 28.91998291015625 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Stack</text></g><g stroke-linecap="round" transform="translate(244.36514189812357 503.75) rotate(0 27.5 15)"><path d="M0 0 C18.28 0.78, 36.09 1.31, 55 0 M0 0 C15.43 -0.69, 30.64 -1.33, 55 0 M55 0 C54.01 7.15, 56.34 14.56, 55 30 M55 0 C55.66 10.51, 54.37 20.52, 55 30 M55 30 C38.77 29.36, 28.15 31.33, 0 30 M55 30 C43.04 30.56, 31.3 29.88, 0 30 M0 30 C-1.28 17.98, 1.03 10.96, 0 0 M0 30 C0.16 20.09, 0.38 10.71, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(47.365141898123575 421.75) rotate(0 15.269989013671875 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref</text></g><g stroke-linecap="round"><g transform="translate(90.36514189812357 440.8631306321763) rotate(0 82.39279176369308 37.4946599132646)"><path d="M0.79 0.65 C28.24 13.02, 138.38 62.15, 165.9 74.69 M-0.25 -0.05 C27.04 12.46, 137.87 63.73, 165.53 76.07" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(90.36514189812357 440.8631306321763) rotate(0 82.39279176369308 37.4946599132646)"><path d="M140.61 74.11 C151.65 76.58, 160.01 77.34, 165.53 76.07 M140.61 74.11 C150.35 74.01, 158.58 76.1, 165.53 76.07" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(90.36514189812357 440.8631306321763) rotate(0 82.39279176369308 37.4946599132646)"><path d="M147.7 58.55 C155.97 67.28, 161.5 74.25, 165.53 76.07 M147.7 58.55 C154.81 64.28, 160.38 72.23, 165.53 76.07" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(419.6149755175017 430.81225042906715) rotate(0 94.59992218017578 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#f08c00" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">4: invokespecial #3</text></g><g transform="translate(387.0312628834218 465.7106415908338) rotate(0 317.7896728515625 37.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">The `invokespecial` instruction pops the top-of-stack reference </text><text x="0" y="42.62" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">and the just-allocated space will be initialized </text><text x="0" y="67.62" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">through invoking constructor</text></g><g stroke-linecap="round" transform="translate(18.115141898123547 628.25) rotate(0 50 67)"><path d="M0 0 C27.21 -2.16, 56.06 -0.53, 100 0 M0 0 C25.49 1.09, 50.43 -0.09, 100 0 M100 0 C101.25 34.81, 101.43 67.17, 100 134 M100 0 C99.98 48.89, 100.22 100.35, 100 134 M100 134 C64.98 132.82, 31.63 132.48, 0 134 M100 134 C78.36 135.42, 58.06 134.6, 0 134 M0 134 C-0.85 88.88, 0.92 45.52, 0 0 M0 134 C0.5 81.08, 1.13 28.5, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g stroke-linecap="round"><g transform="translate(17.115141898123547 673.25) rotate(0 50.5 0.5)"><path d="M-0.72 -0.7 C15.86 -0.68, 83.7 1.05, 100.55 1.27 M1.11 1.55 C17.4 1.69, 83 -0.74, 99.37 -0.7" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(18.615141898123547 717.75) rotate(0 50.5 0.5)"><path d="M-0.7 -0.45 C15.98 -0.26, 84.39 0.22, 101.27 0.42 M1.14 -1.73 C17.58 -1.32, 84.05 1.03, 100.47 1.65" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(240.36514189812357 665.75) rotate(0 59 47)"><path d="M0 0 C28.82 -0.53, 56.11 0.05, 118 0 M0 0 C39.17 -0.63, 79.53 0.51, 118 0 M118 0 C117.68 31.64, 118.62 60.76, 118 94 M118 0 C118.17 27.15, 117.38 53.6, 118 94 M118 94 C81.3 93.08, 48.76 96.11, 0 94 M118 94 C90.15 94.37, 62.42 93.61, 0 94 M0 94 C0.76 71.07, -0.58 44.86, 0 0 M0 94 C0.1 67.58, 0.86 39.02, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(311.36514189812357 666.75) rotate(0 22.649986267089844 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Heap</text></g><g transform="translate(35.36514189812355 599.75) rotate(0 28.91998291015625 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">Stack</text></g><g stroke-linecap="round" transform="translate(250.36514189812357 720.75) rotate(0 27.5 15)"><path d="M0 0 C17.37 0.86, 37.31 0.44, 55 0 M0 0 C15.61 -0.12, 30.33 -0.03, 55 0 M55 0 C55.53 7.58, 53.57 15.97, 55 30 M55 0 C55.43 11.77, 54.42 24.38, 55 30 M55 30 C44.69 28.87, 33.53 30.24, 0 30 M55 30 C38.16 29.69, 21.87 30.57, 0 30 M0 30 C0.17 20.13, -0.72 11.72, 0 0 M0 30 C-0.63 22.11, -0.38 13.21, 0 0" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(97.36514189812357 582.75) rotate(0 15.269989013671875 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">ref</text></g><g stroke-linecap="round"><g transform="translate(127.65758538749535 601.4438513166059) rotate(0 63.746570019007194 60.704299571049816)"><path d="M0.41 1.07 C21.75 21.29, 106.57 100.89, 127.65 121.07 M-0.83 0.59 C20.4 21.01, 105.67 102.5, 126.79 122.43" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(127.65758538749535 601.4438513166059) rotate(0 63.746570019007194 60.704299571049816)"><path d="M103.87 112.44 C111.81 115.32, 115.62 116.8, 126.79 122.43 M103.87 112.44 C112.66 116.31, 120.14 120.32, 126.79 122.43" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(127.65758538749535 601.4438513166059) rotate(0 63.746570019007194 60.704299571049816)"><path d="M115.66 100.05 C120.4 106.3, 121.04 111.12, 126.79 122.43 M115.66 100.05 C120.26 108.42, 123.49 116.91, 126.79 122.43" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask><g transform="translate(428.2009363095722 633.4493379904595) rotate(0 56.8299560546875 12.5)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#f08c00" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">7: astore_1</text></g><g transform="translate(389.6775587078126 675.0892343538062) rotate(0 340.979736328125 25)"><text x="0" y="17.619999999999997" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">The top-of-stack reference is popped and assigned to </text><text x="0" y="42.62" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">the element (`newTest`) at the position 1 of the LocalVariableTable</text></g><g transform="translate(234.74014189812357 570) rotate(0 78.76631927490234 42.39130434782609)"><text x="0" y="14.938695652173916" font-family="Virgil, Segoe UI Emoji" font-size="16.956521739130437px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">LocalVariableTable</text><text x="0" y="36.134347826086966" font-family="Virgil, Segoe UI Emoji" font-size="16.956521739130437px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">0 args</text><text x="0" y="57.33000000000001" font-family="Virgil, Segoe UI Emoji" font-size="16.956521739130437px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic">1 newTest</text><text x="0" y="78.52565217391306" font-family="Virgil, Segoe UI Emoji" font-size="16.956521739130437px" fill="#000000" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="alphabetic"></text></g><g stroke-linecap="round"><g transform="translate(230.60415477559212 622.0730316488514) rotate(0 -54.1325581609058 -16.281023290192607)"><path d="M0.67 -0.55 C-17.37 -6.08, -88.99 -27.43, -107.21 -32.79 M-0.43 1.77 C-18.63 -3.6, -89.41 -25.84, -107.61 -31.38" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(230.60415477559212 622.0730316488514) rotate(0 -54.1325581609058 -16.281023290192607)"><path d="M-82.64 -32.6 C-93.2 -30.23, -102.3 -32.13, -107.61 -31.38 M-82.64 -32.6 C-90.05 -31.68, -96.14 -32.09, -107.61 -31.38" stroke="#000000" stroke-width="1" fill="none"></path></g><g transform="translate(230.60415477559212 622.0730316488514) rotate(0 -54.1325581609058 -16.281023290192607)"><path d="M-87.7 -16.26 C-96.35 -20.23, -103.5 -28.44, -107.61 -31.38 M-87.7 -16.26 C-93.61 -20.09, -98.25 -25.2, -107.61 -31.38" stroke="#000000" stroke-width="1" fill="none"></path></g></g><mask></mask></svg></div><p>The reason why the <code>dup</code> instruction is needed to duplicate the top element of the stack is because the next step, <code>invokespecial</code>, needs to execute the default constructor, which will pop a reference from the top of the stack. If there is no <code>dup</code> to duplicate the top of the stack, it would result in an empty stack after <code>invokespecial</code>, causing the newly created object to be lost.</p><p>This explains why <code>new</code> is not an atomic operation. Although in Java code it is just one line, at the bytecode level, it translates to key four instruction operations. Due to the instruction reordering, the three steps inside <code>new</code> can be reordered. In a multi-threaded environment, this can lead to issues in the singleton pattern mentioned above. Therefore, it’s necessary to add <code>volatile</code> to the <code>instance</code> field to prevent reordering.</p><h2 id="15-lazy-singleton-double-checked-locking-dcl"><a class="markdownIt-Anchor" href="#15-lazy-singleton-double-checked-locking-dcl"></a> 1.5. Lazy Singleton - Double-checked Locking (DCL)</h2><p>Double Checked Locking is the most recommended lazy initialization singleton pattern, which ensures <span style="background:#fff88f">thread safety</span> and enables <span style="background:#fff88f">lazy loading</span>. The complete code is as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1.5. Lazy Singleton - Double-checked Locking (DCL)</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * Pros:</span></span><br><span class="line"><span class="comment"> * 1. lazy initialization</span></span><br><span class="line"><span class="comment"> * 2. can guarantee thread safety using double-checked locking (DCL)</span></span><br><span class="line"><span class="comment"> * 3. can reduce locking overhead</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Cons:</span></span><br><span class="line"><span class="comment"> * 1. more complex</span></span><br><span class="line"><span class="comment"> * 2. may influence its performance when facing a large number of initial `getInstance()` requests</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Best Use Cases:</span></span><br><span class="line"><span class="comment"> * 1. Use it when the singleton class holds heavy resources.</span></span><br><span class="line"><span class="comment"> * 2. Use it when we want to delay the creation of the singleton instance until it is actually needed.</span></span><br><span class="line"><span class="comment"> * 3. Use it when we consider both performance and lazy initialization.</span></span><br><span class="line"><span class="comment"> * 4. Avoid it when the singleton class is lightweight or always needed.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LazySingletonDoubleCheck</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: add volatile to prevent reordering</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> LazySingletonDoubleCheck instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonDoubleCheck</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use double-checked locking</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingletonDoubleCheck <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingletonDoubleCheck.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">LazySingletonDoubleCheck</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="151-reflection-attack-on-lazy-singleton-dcl"><a class="markdownIt-Anchor" href="#151-reflection-attack-on-lazy-singleton-dcl"></a> 1.5.1. Reflection Attack on ‘Lazy Singleton - DCL’</h3><p>Typically, to avoid reflection attacks, we usually add a check in the private constructor to see if the <code>instance</code> field is null. If the <code>instance</code> is not null, we can assume that this singleton class has already created its object and throw an exception to prevent the reflection attack.</p><p>However, it is vulnerable to reflection attacks, which can break the intended singleton behaviour. Let’s see the following two cases:</p><ul><li>case 1 (√): If we call <code>getInstance()</code> first and then call <code>constructor.newInstance()</code>, an error will be thrown to prevent reflection attacks.</li><li>case 2 (×): If we call <code>constructor.newInstance()</code> first and then call <code>getInstance()</code>, we will get two different instances leading to break singleton pattern.</li></ul><p>So, Lazy Singleton cannot prevent reflection attacks in all cases. The specific reasons are:</p><ol><li>Reflection allows access to private constructors. An attacker can use reflection mechanism to bypass the private constructor and create a new instance of a singleton class.</li><li>It lacks any inherent mechanism to check if the instance of a singleton class already exists when accessed via reflection.</li><li>Throwing an exception in the private constructor to prevent reflection attacks is not a foolproof plan, as an attacker can still manipulate the instance creation process.</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LazySingletonDoubleCheckReflectionProof</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: add volatile to prevent reordering</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> LazySingletonDoubleCheckReflectionProof instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves, but cannot prevent constructor reflection</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonDoubleCheckReflectionProof</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// cannot prevent reflection attack: the first call using reflection will still succeed, but subsequent attempts will fail.</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use double-checked locking</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingletonDoubleCheckReflectionProof <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingletonDoubleCheckReflectionProof.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">LazySingletonDoubleCheckReflectionProof</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="152-serialization-attack-on-lazy-singleton-dcl"><a class="markdownIt-Anchor" href="#152-serialization-attack-on-lazy-singleton-dcl"></a> 1.5.2. Serialization Attack on ‘Lazy Singleton - DCL’</h3><p>Serializing and deserializing a class need to implement <code>java.io.Serializable</code>, otherwise it’ll throw an <code>java.io.NotSerializableException</code>. The general process of serialization and deserialization:</p><ol><li>Serializing the singleton class to generate a serialized file.</li><li>Reading the serialized file to obtain the instance of the singleton class via deserialization.</li><li>Comparing whether the serialized instance and the deserialized instance are the same.</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The class has to implement `java.io.Serializable` to avoid throwing `java.io.NotSerializableException`.</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LazySingletonDoubleCheckSerialization</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: add volatile to prevent reordering</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> LazySingletonDoubleCheckSerialization instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonDoubleCheckSerialization</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// cannot prevent reflection attacks in all cases</span></span><br><span class="line">        iif (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use double-checked locking</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingletonDoubleCheckSerialization <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingletonDoubleCheckSerialization.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">LazySingletonDoubleCheckSerialization</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>First, let’s serialize the singleton class to generate a serialized file -&gt; read the serialized file and obtain the instance of the singleton class via deserialization -&gt; the deserialized instance is not the same as the instance of <code>getInstance()</code>, thereby breaking the singleton pattern. Here is the testing code:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSerializationAttackOnLazySingletonDoubleCheckSerialization</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">LazySingletonDoubleCheckSerialization</span> <span class="variable">instance</span> <span class="operator">=</span> LazySingletonDoubleCheckSerialization.getInstance();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">Path</span> <span class="variable">serializedClassPath</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;TestSerialization-&quot;</span> + LazySingletonDoubleCheckSerialization.class.getSimpleName());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// serialize:</span></span><br><span class="line">    <span class="keyword">try</span> (<span class="type">ObjectOutputStream</span> <span class="variable">objectOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(Files.newOutputStream(serializedClassPath))) &#123;</span><br><span class="line">        objectOutputStream.writeObject(instance);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// deserialize: the constructor will not be called, the data will be initialized by reading from the byte stream.</span></span><br><span class="line">    LazySingletonDoubleCheckSerialization testSerializableInstance;</span><br><span class="line">    <span class="keyword">try</span> (<span class="type">ObjectInputStream</span> <span class="variable">objectInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(Files.newInputStream(serializedClassPath))) &#123;</span><br><span class="line">        testSerializableInstance = ((LazySingletonDoubleCheckSerialization) objectInputStream.readObject());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Assertions.assertSame(instance, testSerializableInstance); <span class="comment">// ×</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The reason why the above deserialization generated a new object is that serialization has its own mechanism. It<font color="#00b050"> reads the byte stream data and does not call the constructor</font>. For non-Enum Singleton, to prevent serialization attacks, you need to add a version number like <code>private static final long serialVersionUID = -1L;</code>, and also implement the <code>readResolve()</code> method, and return the instance of the class. In this way, you can get the same object. The code is as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LazySingletonDoubleCheckSerializationProof</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * It is mainly used for version control, ensuring compatibility between serialized and deserialized class versions.</span></span><br><span class="line"><span class="comment">     * If the `serialVersionUID` is not added during serialization, a version number will be automatically generated based on the current class data.</span></span><br><span class="line"><span class="comment">     * When deserializing, a version number will also be automatically generated.</span></span><br><span class="line"><span class="comment">     * If the two version numbers do not match (e.g. the class content is modified before deserialization), the following error will be reported:</span></span><br><span class="line"><span class="comment">     * `java.io.InvalidClassException: local class incompatible: stream classdesc serialVersionUID = -4190675925334731018, local class serialVersionUID = 1437610846000386433</span></span><br><span class="line"><span class="comment">     * Specifying a serialVersionUID can solve this problem.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: add volatile to prevent reordering</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> LazySingletonDoubleCheckSerializationProof instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonDoubleCheckSerializationProof</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// cannot prevent reflection attacks in all cases</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use double-checked locking</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingletonDoubleCheckSerializationProof <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingletonDoubleCheckSerializationProof.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">LazySingletonDoubleCheckSerializationProof</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * For non-Enum Singleton pattern, when facing serialization attacks, the `readResolve()` method must be implemented.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ObjectStreamException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="comment">// during deserialization: returning the existing instance, instead of creating a new one.</span></span><br><span class="line">        <span class="keyword">return</span> getInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Let’s analyse deserialization source code: <code>objectInputStream.readObject()</code> -&gt; <code>readObject(Object.class)</code> -&gt; <code>Object obj = readObject0(type, false);</code> -&gt; in the case-when for TC_OBJECT：<code>readOrdinaryObject(unshared)</code>.</p><p>The key points of <code>readOrdinaryObject(unshared)</code> are:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Object <span class="title function_">readOrdinaryObject</span><span class="params">(<span class="type">boolean</span> unshared)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (obj != <span class="literal">null</span> &amp;&amp;</span><br><span class="line">        handles.lookupException(passHandle) == <span class="literal">null</span> &amp;&amp;</span><br><span class="line">        <span class="comment">// hasReadResolveMethod：check if the current class has the `readResolve()` method.</span></span><br><span class="line">        desc.hasReadResolveMethod())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Calling the `readResolve()` method of the current class.</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">rep</span> <span class="operator">=</span> desc.invokeReadResolve(obj);</span><br><span class="line">        <span class="keyword">if</span> (unshared &amp;&amp; rep.getClass().isArray()) &#123;</span><br><span class="line">            rep = cloneArray(rep);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (rep != obj) &#123;</span><br><span class="line">            <span class="comment">// Filter the replacement object</span></span><br><span class="line">            <span class="keyword">if</span> (rep != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (rep.getClass().isArray()) &#123;</span><br><span class="line">                    filterCheck(rep.getClass(), Array.getLength(rep));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    filterCheck(rep.getClass(), -<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// The `rep` returned by `readResolve()` is assigned to the `obj`.</span></span><br><span class="line">            handles.setObject(passHandle, obj = rep);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">hasReadResolveMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    requireInitialized();</span><br><span class="line">    <span class="comment">// if the `readResolveMethod` is not null, it means the current class has the `readResolve()` method.</span></span><br><span class="line">    <span class="keyword">return</span> (readResolveMethod != <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="title function_">ObjectStreamClass</span><span class="params">(<span class="keyword">final</span> Class&lt;?&gt; cl)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the `readResolve()` method of the current class and assign it to the `readResolveMethod` variable</span></span><br><span class="line">    readResolveMethod = getInheritableMethod(cl, <span class="string">&quot;readResolve&quot;</span>, <span class="literal">null</span>, Object.class);</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="153-perfect-version-of-lazy-singleton-dcl"><a class="markdownIt-Anchor" href="#153-perfect-version-of-lazy-singleton-dcl"></a> 1.5.3. Perfect Version of ‘Lazy Singleton - DCL’</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Lazy Singleton - Double-checked Locking (DCL): Perfect Version</span></span><br><span class="line"><span class="comment"> * 1. Using volatile + DCL to guarantee thread safety and minimize the use of synchronization</span></span><br><span class="line"><span class="comment"> * 2. Trying to use the private constructor checks to prevent reflection attacks, but cannot guarantee in all cases</span></span><br><span class="line"><span class="comment"> * 3. Using defined serialVersionUID and readResolve() to prevent serialization attacks</span></span><br><span class="line"><span class="comment"> * 4. Overriding clone() to prevent cloning attacks</span></span><br><span class="line"><span class="comment"> * 5. Using final class to prevent subclassing and avoid any subclass to break the singleton pattern</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">LazySingletonDoubleCheckPerfect</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicitly defining `serialVersionUID` can avoid potential incompatibility issues.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: add volatile to prevent reordering</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> LazySingletonDoubleCheckPerfect instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">LazySingletonDoubleCheckPerfect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// cannot prevent reflection attacks in all cases</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use double-checked locking</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> LazySingletonDoubleCheckPerfect <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (LazySingletonDoubleCheckPerfect.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="literal">null</span> == instance) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">LazySingletonDoubleCheckPerfect</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Prevent serialization attacks</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="comment">// during deserialization: returning the existing instance, instead of creating a new one.</span></span><br><span class="line">        <span class="keyword">return</span> getInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Prevent cloning</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="comment">// (1) throw an exception to prevent cloning</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">CloneNotSupportedException</span>(<span class="string">&quot;Cloning of this singleton instance is not allowed&quot;</span>);</span><br><span class="line">        <span class="comment">// (2) or directly return the same instance from the clone method</span></span><br><span class="line">        <span class="comment">//return getInstance();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-eager-singleton"><a class="markdownIt-Anchor" href="#2-eager-singleton"></a> 2. Eager Singleton</h1><p>The eager Initialization pattern completes initialization when the class is loaded, relying on the <font color="#00b050">class loading mechanism</font> to ensure singleton behaviour without locking, thus achieving higher execution efficiency. However, due to instantiation during class loading, it lacks the advantage of lazy loading. If the instance is not used, it will be needlessly instantiated, wasting resources.</p><p>In the following two Eager Singleton examples, both are very simpler than the Lazy Singleton. These two patterns leverage the JVM’s class loading mechanism to ensure the uniqueness of the instance. Initialization occurs only once, and the JVM synchronizes the class loading process.</p><p>The class loading process involves:</p><ol><li><strong>Loading</strong>: the JVM locates and loads the class file’s bytecode into memory, generating the corresponding Class data structure.</li><li><strong>Linking</strong>: <strong>Verification</strong> (verifying the correctness of the loaded bytecode) → <strong>Preparation</strong> (initializing static fields to their default values) → <strong>Resolution</strong> (resolving symbolic references from the class file to actual references)</li><li><strong>Initialization</strong>: the <font color="#00b050">static initializers</font> and <font color="#00b050">static blocks</font> in the class are executed inside <code>&lt;clinit&gt;</code> and this process only happens the first time the class is used, such as an instance is created or a static method is invoked.</li><li><strong>Using</strong>: After a class is loaded and initialized, its instances can be created, methods can be invoked, and fields can be accessed.</li><li><strong>Unloading</strong>: When a class and its associated class loader are no longer in use and can be garbage collected, the class is removed from memory.</li></ol><p>As <code>instance</code> variable is a static member variable, its instantiation occurs during the class loading initialization phase. This phase involves executing the class constructor <code>&lt;clinit&gt;()</code> method, which the compiler automatically collects all static variables and static blocks within. Therefore, <code>private static final EagerSingletonStaticConstant instance = new EagerSingletonStaticConstant();</code> and <code> static &#123; instance = new EagerSingletonStaticBlock(); &#125;</code> also happen within this method. The JVM ensures that <code>&lt;clinit&gt;()</code> of a class is synchronized in a multi-threaded environment, guaranteeing thread safety.</p><details class="custom-callout tip" open><summary class="callout-title"><div class="callout-icon"></div><div>Tip</div><div class="callout-fold"></div></summary><div class="callout-body"><p>Some people may feel confused about why Eager Singleton is more wasting resources. They may think: ‘When that Eager Singleton class is never used, it appears to not invoke the constructor of the class’.</p><p>Actually, it is more of this kind of scenario, calling other methods of the class, rather than calling the <code>getInstance()</code>. For Eager Singleton, even if you don’t get the instance of the Eager Singleton and just call any other methods, it’ll still trigger the class creation due to the class loading mechanism. But for Lazy Singleton, it won’t trigger class creation and just execute that other method.</p><p>Please refer to this example <a href="https://github.com/sissilab/DesignPattern-Lab/blob/master/src/main/java/com/sissilab/dp/ox1_creational/ox11_singleton/EagerSingletonWastingReason.java">EagerSingletonWastingReason.java at sissilab/DesignPattern-Lab (github.com)</a> for more details.</p></div></details><h2 id="21-eager-singleton-static-constant"><a class="markdownIt-Anchor" href="#21-eager-singleton-static-constant"></a> 2.1. Eager Singleton - static constant</h2><p>It’s very simple to implement, but it may lead to wasting resources as the instance of the class is always created, whether it is required or not. It is also not easy to handle exception during the class creation.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 2.1. Eager Singleton - static constant</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Pros:</span></span><br><span class="line"><span class="comment"> * 1. can guarantee the creation is thread-safe based on class loading mechanism without the need for synchronization</span></span><br><span class="line"><span class="comment"> * 2. more straightforward and easy to understand, and no need for additional code to handle lazy initialization or synchronization mechanisms</span></span><br><span class="line"><span class="comment"> * 3. no performance overhead during `getInstance()`, as the instance is created at the time of class loading</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Cons:</span></span><br><span class="line"><span class="comment"> * 1. may waste resources due to prematurely creation, especially for the resource-heavy singleton classes with large caches or database connections</span></span><br><span class="line"><span class="comment"> * 2. lack of lazy initialization</span></span><br><span class="line"><span class="comment"> * 3. inflexible to handle exceptions during the class creation using static constant</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Best Use Cases:</span></span><br><span class="line"><span class="comment"> * 1. Use it when the singleton class is relatively lightweight.</span></span><br><span class="line"><span class="comment"> * 2. Use it when the singleton class is frequently needed during the application&#x27;s lifecycle.</span></span><br><span class="line"><span class="comment"> * 3. Avoid it when lazy loading is preferable.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EagerSingletonStaticConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">EagerSingletonStaticConstant</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EagerSingletonStaticConstant</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingletonStaticConstant</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingletonStaticConstant <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="211-reflection-attack-on-eager-singleton-static-constant"><a class="markdownIt-Anchor" href="#211-reflection-attack-on-eager-singleton-static-constant"></a> 2.1.1. Reflection Attack on Eager Singleton - static constant</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EagerSingletonStaticConstantReflectionProof</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">EagerSingletonStaticConstantReflectionProof</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EagerSingletonStaticConstantReflectionProof</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingletonStaticConstantReflectionProof</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// prevent reflection attack</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingletonStaticConstantReflectionProof <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="212-serialization-attack-on-eager-singleton-static-constant"><a class="markdownIt-Anchor" href="#212-serialization-attack-on-eager-singleton-static-constant"></a> 2.1.2.  Serialization Attack on Eager Singleton - static constant</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EagerSingletonStaticConstantSerializationProof</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicitly defining `serialVersionUID` can avoid potential incompatibility issues.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">EagerSingletonStaticConstantSerializationProof</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EagerSingletonStaticConstantSerializationProof</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingletonStaticConstantSerializationProof</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// prevent reflection attack</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingletonStaticConstantSerializationProof <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="comment">// during deserialization: returning the existing instance, instead of creating a new one.</span></span><br><span class="line">        <span class="keyword">return</span> getInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="213-perfect-version-of-eager-singleton-static-constant"><a class="markdownIt-Anchor" href="#213-perfect-version-of-eager-singleton-static-constant"></a> 2.1.3. Perfect Version of Eager Singleton - static constant</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Eager Singleton - static constant: Perfect Version</span></span><br><span class="line"><span class="comment"> * 1. Using static constant to create the singleton instance based on class loading mechanism</span></span><br><span class="line"><span class="comment"> * 2. Trying to use the private constructor checks to prevent reflection attacks, but cannot guarantee in all cases</span></span><br><span class="line"><span class="comment"> * 3. Using defined serialVersionUID and readResolve() to prevent serialization attacks</span></span><br><span class="line"><span class="comment"> * 4. Overriding clone() to prevent cloning attacks</span></span><br><span class="line"><span class="comment"> * 5. Using final class to prevent subclassing and avoid any subclass to break the singleton pattern</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">EagerSingletonStaticConstantPerfect</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicitly defining `serialVersionUID` can avoid potential incompatibility issues.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">EagerSingletonStaticConstantPerfect</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EagerSingletonStaticConstantPerfect</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingletonStaticConstantPerfect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// cannot prevent reflection attacks in all cases</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingletonStaticConstantPerfect <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Prevent serialization attacks</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="comment">// during deserialization: returning the existing instance, instead of creating a new one.</span></span><br><span class="line">        <span class="keyword">return</span> getInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Prevent cloning</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="comment">// (1) throw an exception to prevent cloning</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">CloneNotSupportedException</span>(<span class="string">&quot;Cloning of this singleton instance is not allowed&quot;</span>);</span><br><span class="line">        <span class="comment">// (2) or directly return the same instance from the clone method</span></span><br><span class="line">        <span class="comment">//return getInstance();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="22-eager-singleton-static-block"><a class="markdownIt-Anchor" href="#22-eager-singleton-static-block"></a> 2.2. Eager Singleton - static block</h2><p>Using static block to finish class instantiation may also lead to wasting resources due to class loading mechanism. But it’s easier to handle exception and do more things inside the static block.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 2.2. Eager Singleton - static block</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Pros:</span></span><br><span class="line"><span class="comment"> * 1. can guarantee the creation is thread-safe based on class loading mechanism without the need for synchronization</span></span><br><span class="line"><span class="comment"> * 2. more straightforward and easy to understand, and no need for additional code to handle lazy initialization or synchronization mechanisms</span></span><br><span class="line"><span class="comment"> * 3. no performance overhead during `getInstance()`, as the instance is created at the time of class loading</span></span><br><span class="line"><span class="comment"> * 4. flexible to handle more complex logic or exception in static block during the creation</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Cons:</span></span><br><span class="line"><span class="comment"> * 1. may waste resources due to prematurely creation, especially for the resource-heavy singleton classes with large caches or database connections</span></span><br><span class="line"><span class="comment"> * 2. lack of lazy initialization</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Best Use Cases:</span></span><br><span class="line"><span class="comment"> * 1. Use it when the singleton class is relatively lightweight.</span></span><br><span class="line"><span class="comment"> * 2. Use it when the singleton class is frequently needed during the application&#x27;s lifecycle.</span></span><br><span class="line"><span class="comment"> * 3. Use it when we require complex initialization steps, as the static block gives flexibility to handle.</span></span><br><span class="line"><span class="comment"> * 4. Avoid it when lazy loading is preferable.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EagerSingletonStaticBlock</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> EagerSingletonStaticBlock instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        instance = <span class="keyword">new</span> <span class="title class_">EagerSingletonStaticBlock</span>();</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingletonStaticBlock</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingletonStaticBlock <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="221-reflection-attack-on-eager-singleton-static-block"><a class="markdownIt-Anchor" href="#221-reflection-attack-on-eager-singleton-static-block"></a> 2.2.1. Reflection Attack on Eager Singleton - static block</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EagerSingletonStaticBlockReflectionProof</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class in the static block</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> EagerSingletonStaticBlockReflectionProof instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> <span class="title class_">EagerSingletonStaticBlockReflectionProof</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingletonStaticBlockReflectionProof</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// prevent reflection attack</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingletonStaticBlockReflectionProof <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="222-serialization-attack-on-eager-singleton-static-block"><a class="markdownIt-Anchor" href="#222-serialization-attack-on-eager-singleton-static-block"></a> 2.2.2. Serialization Attack on Eager Singleton - static block</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EagerSingletonStaticBlockSerializationProof</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicitly defining `serialVersionUID` can avoid potential incompatibility issues.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class in the static block</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> EagerSingletonStaticBlockSerializationProof instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> <span class="title class_">EagerSingletonStaticBlockSerializationProof</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingletonStaticBlockSerializationProof</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// prevent reflection attack</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingletonStaticBlockSerializationProof <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// prevent serialization attack</span></span><br><span class="line">    Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="comment">// during deserialization: returning the existing instance, instead of creating a new one.</span></span><br><span class="line">        <span class="keyword">return</span> getInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="223-perfect-version-of-eager-singleton-static-block"><a class="markdownIt-Anchor" href="#223-perfect-version-of-eager-singleton-static-block"></a> 2.2.3. Perfect Version of Eager Singleton - static block</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Eager Singleton - static block: Perfect Version</span></span><br><span class="line"><span class="comment"> * 1. Using static block to create the singleton instance based on class loading mechanism</span></span><br><span class="line"><span class="comment"> * 2. Trying to use the private constructor checks to prevent reflection attacks, but cannot guarantee in all cases</span></span><br><span class="line"><span class="comment"> * 3. Using defined serialVersionUID and readResolve() to prevent serialization attacks</span></span><br><span class="line"><span class="comment"> * 4. Overriding clone() to prevent cloning attacks</span></span><br><span class="line"><span class="comment"> * 5. Using final class to prevent subclassing and avoid any subclass to break the singleton pattern</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">EagerSingletonStaticBlockPerfect</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicitly defining `serialVersionUID` can avoid potential incompatibility issues.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> EagerSingletonStaticBlockPerfect instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        instance = <span class="keyword">new</span> <span class="title class_">EagerSingletonStaticBlockPerfect</span>();</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">EagerSingletonStaticBlockPerfect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// cannot prevent reflection attacks in all cases</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> EagerSingletonStaticBlockPerfect <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Prevent serialization attacks</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="comment">// during deserialization: returning the existing instance, instead of creating a new one.</span></span><br><span class="line">        <span class="keyword">return</span> getInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Prevent cloning</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="comment">// (1) throw an exception to prevent cloning</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">CloneNotSupportedException</span>(<span class="string">&quot;Cloning of this singleton instance is not allowed&quot;</span>);</span><br><span class="line">        <span class="comment">// (2) or directly return the same instance from the clone method</span></span><br><span class="line">        <span class="comment">//return getInstance();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-static-inner-class-singleton"><a class="markdownIt-Anchor" href="#3-static-inner-class-singleton"></a> 3.  Static Inner Class Singleton</h1><p>The Static Inner Class Singleton pattern essentially also utilises the classloader mechanism to ensure thread safety. Due to its characteristics, it can guarantee that the class initialization will only be triggered when it is actually used, which is also a form of lazy loading.</p><ul><li>Compared to <a href="#15-lazy-singleton-double-checked-locking-dcl">1.5. Lazy Singleton - Double-checked Locking (DCL)</a>, this pattern can also achieve the similar effect of lazy loading but with a simpler implementation.</li><li>Compared to <a href="#2-eager-singleton">2. Eager Singleton</a>, this pattern also utilises classloader mechanism to initialize and ensure only one instance of the class. When the class is loaded, the Eager Singleton will be instantiated, but the Static Inner Class Singleton may not be. This is because the instance will only be created when its static inner class <code>InstanceHolder</code> is used and loaded. So, the instance of <code>StaticInnerClassSingleton</code> won’t be created until the method <code>getInstance()</code> has been used, which can achieve the effect of lazy loading.</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 3. Static Inner Class Singleton</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Pros:</span></span><br><span class="line"><span class="comment"> * 1. lazy initialization based on the characteristics of static inner class</span></span><br><span class="line"><span class="comment"> * 2. can guarantee thread safety for the static initialization of the `InstanceHolder` class based on class loading mechanism</span></span><br><span class="line"><span class="comment"> * 3. can avoid synchronization overhead, unlike the DCL pattern</span></span><br><span class="line"><span class="comment"> * 4. relatively easier to understand compared to the DCL pattern</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Cons:</span></span><br><span class="line"><span class="comment"> * 1. inflexible to handle exceptions during the class creation</span></span><br><span class="line"><span class="comment"> * 2. unexpected issues due to class loading timing</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Best Use Cases:</span></span><br><span class="line"><span class="comment"> * 1. Use it when the singleton class holds heavy resources.</span></span><br><span class="line"><span class="comment"> * 2. Use it when we want to delay the creation of the singleton instance until it is actually needed.</span></span><br><span class="line"><span class="comment"> * 3. Avoid it when we require complex initialization steps</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StaticInnerClassSingleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// static inner class to provide the singleton instance of the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">InstanceHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">StaticInnerClassSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StaticInnerClassSingleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">StaticInnerClassSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> StaticInnerClassSingleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// It is only here that the initialization of `InstanceHolder.instance` will be triggered</span></span><br><span class="line">        <span class="keyword">return</span> InstanceHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="31-reflection-attack-on-static-inner-class-singleton"><a class="markdownIt-Anchor" href="#31-reflection-attack-on-static-inner-class-singleton"></a> 3.1. Reflection Attack on Static Inner Class Singleton</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">StaticInnerSingletonReflectionProof</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// static inner class to provide the singleton instance of the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">InstanceHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">StaticInnerSingletonReflectionProof</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StaticInnerSingletonReflectionProof</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves, but cannot prevent constructor reflection</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">StaticInnerSingletonReflectionProof</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// prevent reflection attack</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != InstanceHolder.instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> StaticInnerSingletonReflectionProof <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// It is only here that the initialization of `InstanceHolder.instance` will be triggered.</span></span><br><span class="line">        <span class="keyword">return</span> InstanceHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="32-serialization-attack-on-static-inner-class-singleton"><a class="markdownIt-Anchor" href="#32-serialization-attack-on-static-inner-class-singleton"></a> 3.2. Serialization Attack on Static Inner Class Singleton</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">StaticInnerSingletonSerializationProof</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * If the `serialVersionUID` is not added during serialization, a version number will be automatically generated based on the current class data.</span></span><br><span class="line"><span class="comment">     * When deserializing, a version number will also be automatically generated.</span></span><br><span class="line"><span class="comment">     * If the two version numbers do not match (the class content is modified before deserialization), the following error will be reported:</span></span><br><span class="line"><span class="comment">     * `java.io.InvalidClassException: local class incompatible: stream classdesc serialVersionUID = -6193354024038071874, local class serialVersionUID = 3430229600994946531`</span></span><br><span class="line"><span class="comment">     * Specifying a serialVersionUID can solve this problem.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// static inner class to provide the singleton instance of the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">InstanceHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">StaticInnerSingletonSerializationProof</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StaticInnerSingletonSerializationProof</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves, but cannot prevent constructor reflection</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">StaticInnerSingletonSerializationProof</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// prevent reflection attack</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != InstanceHolder.instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> StaticInnerSingletonSerializationProof <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> InstanceHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * For non-Enum Singleton pattern, when facing serialization attacks, the `readResolve()` method must be implemented.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ObjectStreamException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="comment">// during deserialization: returning the existing instance, instead of creating a new one.</span></span><br><span class="line">        <span class="keyword">return</span> getInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="33-perfect-version-of-static-inner-class-singleton"><a class="markdownIt-Anchor" href="#33-perfect-version-of-static-inner-class-singleton"></a> 3.3. Perfect Version of Static Inner Class Singleton</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Static Inner Class Singleton: Perfect Version</span></span><br><span class="line"><span class="comment"> * 1. Using the characteristics of static inner class to provide lazy initialization and thread safety based on class loading mechanism</span></span><br><span class="line"><span class="comment"> * 2. Trying to use the private constructor checks to prevent reflection attacks, but cannot guarantee in all cases</span></span><br><span class="line"><span class="comment"> * 3. Using defined serialVersionUID and readResolve() to prevent serialization attacks</span></span><br><span class="line"><span class="comment"> * 4. Overriding clone() to prevent cloning attacks</span></span><br><span class="line"><span class="comment"> * 5. Using final class to prevent subclassing and avoid any subclass to break the singleton pattern</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">StaticInnerSingletonPerfect</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Explicitly defining `serialVersionUID` can avoid potential incompatibility issues.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// static inner class to provide the singleton instance of the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">InstanceHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">StaticInnerSingletonPerfect</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StaticInnerSingletonPerfect</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// private constructor: restricts users from creating instances themselves</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">StaticInnerSingletonPerfect</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// prevent reflection attack</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != InstanceHolder.instance) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;This singleton instance already exists.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> StaticInnerSingletonPerfect <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> StaticInnerSingletonPerfect.InstanceHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// prevent serialization attacks</span></span><br><span class="line">    Object <span class="title function_">readResolve</span><span class="params">()</span> <span class="keyword">throws</span> ObjectStreamException &#123;</span><br><span class="line">        <span class="comment">// during deserialization: returning the existing instance, instead of creating a new one.</span></span><br><span class="line">        <span class="keyword">return</span> getInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Prevent cloning</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="comment">// (1) throw an exception to prevent cloning</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">CloneNotSupportedException</span>(<span class="string">&quot;Cloning of this singleton instance is not allowed&quot;</span>);</span><br><span class="line">        <span class="comment">// (2) or directly return the same instance from the clone method</span></span><br><span class="line">        <span class="comment">//return getInstance();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="4-enum-singleton"><a class="markdownIt-Anchor" href="#4-enum-singleton"></a> 4. Enum Singleton</h1><p>Enum is considered the best way to implement the singleton pattern. It not only leverages the class loading mechanism to guarantee thread safety, but also prevents the reconstruction of objects during deserialization, and avoids reflection attacks.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 4. Enum Singleton</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Pros:</span></span><br><span class="line"><span class="comment"> * 1. very easy to implement and the code is concise.</span></span><br><span class="line"><span class="comment"> * 2. inherently thread-safe as classloader mechanism, private constructor, and public static final instance field.</span></span><br><span class="line"><span class="comment"> * 3. can prevent reflection attacks because it&#x27;ll throw an IllegalArgumentException while calling `newInstance()`.</span></span><br><span class="line"><span class="comment"> * 4. inherently serializable and can prevent serialization attacks.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * Cons:</span></span><br><span class="line"><span class="comment"> * 1. no lazy loading.</span></span><br><span class="line"><span class="comment"> * 2. cannot extend other classes because an enum class implicitly inherits `java.lang.Enum`.</span></span><br><span class="line"><span class="comment"> * 3. inconvenient to debug because some key codes are implicitly auto-generated, like private constructor, static initialization block, ...</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">EnumSingleton</span> &#123;</span><br><span class="line">    instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">anyMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Let’s analyse the bytecode of the enum class. After compiling the <code>EnumSingleton.java</code> and generating the class file through <code>javac -g EnumSingleton.java</code>, executing <code>javap -v -p EnumSingleton.class</code> to generate the bytecode file, as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line">Classfile /DesignPattern-Lab/src/main/java/com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton.<span class="keyword">class</span></span><br><span class="line">  <span class="title class_">Last</span> modified <span class="number">26</span>/08/<span class="number">2024</span>; size <span class="number">1195</span> bytes</span><br><span class="line">  MD5 checksum 1e21098493b1502d48f3a4fba5884dcc</span><br><span class="line">  Compiled from <span class="string">&quot;EnumSingleton.java&quot;</span></span><br><span class="line"><span class="comment">// enum class implicitly exted `java.lang.Enum`</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">com</span>.sissilab.dp.ox1_creational.ox11_singleton.EnumSingleton <span class="keyword">extends</span> <span class="title class_">java</span>.lang.Enum&lt;com.sissilab.dp.ox1_creational.ox11_singleton.EnumSingleton&gt;</span><br><span class="line">  minor version: <span class="number">0</span></span><br><span class="line">  major version: <span class="number">52</span></span><br><span class="line">  flags: ACC_PUBLIC, ACC_FINAL, ACC_SUPER, ACC_ENUM</span><br><span class="line">Constant pool:</span><br><span class="line">   #<span class="number">1</span> = Fieldref           #<span class="number">4.</span>#<span class="number">34</span>         <span class="comment">// com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton.$VALUES:[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br><span class="line">   #<span class="number">2</span> = Methodref          #<span class="number">35.</span>#<span class="number">36</span>        <span class="comment">// &quot;[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;&quot;.clone:()Ljava/lang/Object;</span></span><br><span class="line">   #<span class="number">3</span> = Class              #<span class="number">14</span>            <span class="comment">// &quot;[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;&quot;</span></span><br><span class="line">   #<span class="number">4</span> = Class              #<span class="number">37</span>            <span class="comment">// com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton</span></span><br><span class="line">   #<span class="number">5</span> = Methodref          #<span class="number">10.</span>#<span class="number">38</span>        <span class="comment">// java/lang/Enum.valueOf:(Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Enum;</span></span><br><span class="line">   #<span class="number">6</span> = Methodref          #<span class="number">10.</span>#<span class="number">39</span>        <span class="comment">// java/lang/Enum.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;I)V</span></span><br><span class="line">   #<span class="number">7</span> = String             #<span class="number">11</span>            <span class="comment">// instance</span></span><br><span class="line">   #<span class="number">8</span> = Methodref          #<span class="number">4.</span>#<span class="number">39</span>         <span class="comment">// com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;I)V</span></span><br><span class="line">   #<span class="number">9</span> = Fieldref           #<span class="number">4.</span>#<span class="number">40</span>         <span class="comment">// com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton.instance:Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br><span class="line">  #<span class="number">10</span> = Class              #<span class="number">41</span>            <span class="comment">// java/lang/Enum</span></span><br><span class="line">  #<span class="number">11</span> = Utf8               instance</span><br><span class="line">  #<span class="number">12</span> = Utf8               Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">  #<span class="number">13</span> = Utf8               $VALUES</span><br><span class="line">  #<span class="number">14</span> = Utf8               [Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">  #<span class="number">15</span> = Utf8               values</span><br><span class="line">  #<span class="number">16</span> = Utf8               ()[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">  #<span class="number">17</span> = Utf8               Code</span><br><span class="line">  #<span class="number">18</span> = Utf8               LineNumberTable</span><br><span class="line">  #<span class="number">19</span> = Utf8               valueOf</span><br><span class="line">  #<span class="number">20</span> = Utf8               (Ljava/lang/String;)Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">  #<span class="number">21</span> = Utf8               LocalVariableTable</span><br><span class="line">  #<span class="number">22</span> = Utf8               name</span><br><span class="line">  #<span class="number">23</span> = Utf8               Ljava/lang/String;</span><br><span class="line">  #<span class="number">24</span> = Utf8               &lt;init&gt;</span><br><span class="line">  #<span class="number">25</span> = Utf8               (Ljava/lang/String;I)V</span><br><span class="line">  #<span class="number">26</span> = Utf8               <span class="built_in">this</span></span><br><span class="line">  #<span class="number">27</span> = Utf8               Signature</span><br><span class="line">  #<span class="number">28</span> = Utf8               ()V</span><br><span class="line">  #<span class="number">29</span> = Utf8               anyMethod</span><br><span class="line">  #<span class="number">30</span> = Utf8               &lt;clinit&gt;</span><br><span class="line">  #<span class="number">31</span> = Utf8               Ljava/lang/Enum&lt;Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;&gt;;</span><br><span class="line">  #<span class="number">32</span> = Utf8               SourceFile</span><br><span class="line">  #<span class="number">33</span> = Utf8               EnumSingleton.java</span><br><span class="line">  #<span class="number">34</span> = NameAndType        #<span class="number">13</span>:#<span class="number">14</span>        <span class="comment">// $VALUES:[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br><span class="line">  #<span class="number">35</span> = Class              #<span class="number">14</span>            <span class="comment">// &quot;[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;&quot;</span></span><br><span class="line">  #<span class="number">36</span> = NameAndType        #<span class="number">42</span>:#<span class="number">43</span>        <span class="comment">// clone:()Ljava/lang/Object;</span></span><br><span class="line">  #<span class="number">37</span> = Utf8               com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton</span><br><span class="line">  #<span class="number">38</span> = NameAndType        #<span class="number">19</span>:#<span class="number">44</span>        <span class="comment">// valueOf:(Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Enum;</span></span><br><span class="line">  #<span class="number">39</span> = NameAndType        #<span class="number">24</span>:#<span class="number">25</span>        <span class="comment">// &quot;&lt;init&gt;&quot;:(Ljava/lang/String;I)V</span></span><br><span class="line">  #<span class="number">40</span> = NameAndType        #<span class="number">11</span>:#<span class="number">12</span>        <span class="comment">// instance:Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br><span class="line">  #<span class="number">41</span> = Utf8               java/lang/Enum</span><br><span class="line">  #<span class="number">42</span> = Utf8               clone</span><br><span class="line">  #<span class="number">43</span> = Utf8               ()Ljava/lang/Object;</span><br><span class="line">  #<span class="number">44</span> = Utf8               (Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Enum;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// The `instance` is a `public static final` field.</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> com.sissilab.dp.ox1_creational.ox11_singleton.EnumSingleton instance;</span><br><span class="line">    descriptor: Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC, ACC_FINAL, ACC_ENUM</span><br><span class="line"></span><br><span class="line">  <span class="comment">// the `private static final $VALUES` field holds all enum constants</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> com.sissilab.dp.ox1_creational.ox11_singleton.EnumSingleton[] $VALUES;</span><br><span class="line">    descriptor: [Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">    flags: ACC_PRIVATE, ACC_STATIC, ACC_FINAL, ACC_SYNTHETIC</span><br><span class="line"></span><br><span class="line">  <span class="comment">// `values()` method is automatically generated by the compiler to return the array of defined enum constants.</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> com.sissilab.dp.ox1_creational.ox11_singleton.EnumSingleton[] values();</span><br><span class="line">    descriptor: ()[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">1</span>, locals=<span class="number">0</span>, args_size=<span class="number">0</span></span><br><span class="line">         <span class="number">0</span>: getstatic     #<span class="number">1</span>                  <span class="comment">// Field $VALUES:[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br><span class="line">         <span class="number">3</span>: invokevirtual #<span class="number">2</span>                  <span class="comment">// Method &quot;[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;&quot;.clone:()Ljava/lang/Object;</span></span><br><span class="line">         <span class="number">6</span>: checkcast     #<span class="number">3</span>                  <span class="comment">// class &quot;[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;&quot;</span></span><br><span class="line">         <span class="number">9</span>: areturn</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">17</span>: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> com.sissilab.dp.ox1_creational.ox11_singleton.EnumSingleton <span class="title function_">valueOf</span><span class="params">(java.lang.String)</span>;</span><br><span class="line">    descriptor: (Ljava/lang/String;)Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">    flags: ACC_PUBLIC, ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">2</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: ldc           #<span class="number">4</span>                  <span class="comment">// class com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton</span></span><br><span class="line">         <span class="number">2</span>: aload_0</span><br><span class="line">         <span class="number">3</span>: invokestatic  #<span class="number">5</span>                  <span class="comment">// Method java/lang/Enum.valueOf:(Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Enum;</span></span><br><span class="line">         <span class="number">6</span>: checkcast     #<span class="number">4</span>                  <span class="comment">// class com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton</span></span><br><span class="line">         <span class="number">9</span>: areturn</span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">17</span>: <span class="number">0</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>      <span class="number">10</span>     <span class="number">0</span>  name   Ljava/lang/String;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The private constructor with two arguments (String, int) is automatically generated.</span></span><br><span class="line">  <span class="keyword">private</span> com.sissilab.dp.ox1_creational.ox11_singleton.EnumSingleton();</span><br><span class="line">    descriptor: (Ljava/lang/String;I)V</span><br><span class="line">    flags: ACC_PRIVATE</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">3</span>, locals=<span class="number">3</span>, args_size=<span class="number">3</span></span><br><span class="line">         <span class="comment">// Loads the `this` reference onto the stack (from slot 0).</span></span><br><span class="line">         <span class="number">0</span>: aload_0</span><br><span class="line">         <span class="comment">// Loads the first argument (`name` of the enum constant) stored in local variable 1 onto the stack.</span></span><br><span class="line">         <span class="number">1</span>: aload_1</span><br><span class="line">         <span class="comment">// Loads the second argument (`ordinal` of the enum constant) stored in local variable 2 onto the stack.</span></span><br><span class="line">         <span class="number">2</span>: iload_2</span><br><span class="line">         <span class="comment">// calls superclass constructor `java.lang.Enum (String name, int ordinal)`</span></span><br><span class="line">         <span class="number">3</span>: invokespecial #<span class="number">6</span>                  <span class="comment">// Method java/lang/Enum.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;I)V</span></span><br><span class="line">         <span class="number">6</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">17</span>: <span class="number">0</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">7</span>     <span class="number">0</span>  <span class="built_in">this</span>   Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line">    Signature: #<span class="number">28</span>                          <span class="comment">// ()V</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">anyMethod</span><span class="params">()</span>;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_PUBLIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">0</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></span><br><span class="line">         <span class="number">0</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">21</span>: <span class="number">0</span></span><br><span class="line">      LocalVariableTable:</span><br><span class="line">        Start  Length  Slot  Name   Signature</span><br><span class="line">            <span class="number">0</span>       <span class="number">1</span>     <span class="number">0</span>  <span class="built_in">this</span>   Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// static initialization block</span></span><br><span class="line">  <span class="keyword">static</span> &#123;&#125;;</span><br><span class="line">    descriptor: ()V</span><br><span class="line">    flags: ACC_STATIC</span><br><span class="line">    Code:</span><br><span class="line">      stack=<span class="number">4</span>, locals=<span class="number">0</span>, args_size=<span class="number">0</span></span><br><span class="line">         <span class="comment">// allocates memory for an object of the class referenced by #4 -&gt; adds the reference to the top of the operand stack</span></span><br><span class="line">         <span class="number">0</span>: <span class="keyword">new</span>           #<span class="number">4</span>                  <span class="comment">// class com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton</span></span><br><span class="line">         <span class="comment">// dup: duplicates the top stack value -&gt; adds the duplicated reference to the top of the operand stack</span></span><br><span class="line">         <span class="number">3</span>: dup</span><br><span class="line">         <span class="comment">// ldc: loads String instance onto the stack （`String name`）</span></span><br><span class="line">         <span class="number">4</span>: ldc           #<span class="number">7</span>                  <span class="comment">// String instance</span></span><br><span class="line">         <span class="comment">// iconst_0: pushes the integer constant 0 onto the stack (`int ordinal`)</span></span><br><span class="line">         <span class="number">6</span>: iconst_0</span><br><span class="line">         <span class="comment">// invokespecial：invokes the constructor EnumSingleton(String, int) to initialize</span></span><br><span class="line">         <span class="number">7</span>: invokespecial #<span class="number">8</span>                  <span class="comment">// Method &quot;&lt;init&gt;&quot;:(Ljava/lang/String;I)V</span></span><br><span class="line">        <span class="comment">// putstatic: assigns the created instance to the static field `instance` of EnumSingleton</span></span><br><span class="line">        <span class="number">10</span>: putstatic     #<span class="number">9</span>                  <span class="comment">// Field instance:Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br><span class="line">        <span class="comment">// iconst_1: pushes the integer 1 (the size of the array to be created) onto the stack.</span></span><br><span class="line">        <span class="number">13</span>: iconst_1</span><br><span class="line">        <span class="comment">// anewarray: creates a new array of EnumSingleton objects (size=1)</span></span><br><span class="line">        <span class="number">14</span>: anewarray     #<span class="number">4</span>                  <span class="comment">// class com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton</span></span><br><span class="line">        <span class="comment">// dup: duplicates the reference to the array on the stack</span></span><br><span class="line">        <span class="number">17</span>: dup</span><br><span class="line">        <span class="comment">// iconst_0: pushes the integer 0 (the index of the array) onto the stack</span></span><br><span class="line">        <span class="number">18</span>: iconst_0</span><br><span class="line">        <span class="comment">// getstatic: get static field `instance`</span></span><br><span class="line">        <span class="number">19</span>: getstatic     #<span class="number">9</span>                  <span class="comment">// Field instance:Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br><span class="line">        <span class="comment">// aastore: stores the instance into the array at index 0</span></span><br><span class="line">        <span class="number">22</span>: aastore</span><br><span class="line">        <span class="comment">// putstatic: stores the array into the static field `$VALUES` (it holds all the enum constants in the order)</span></span><br><span class="line">        <span class="number">23</span>: putstatic     #<span class="number">1</span>                  <span class="comment">// Field $VALUES:[Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br><span class="line">        <span class="number">26</span>: <span class="keyword">return</span></span><br><span class="line">      LineNumberTable:</span><br><span class="line">        line <span class="number">18</span>: <span class="number">0</span></span><br><span class="line">        line <span class="number">17</span>: <span class="number">13</span></span><br><span class="line">&#125;</span><br><span class="line">Signature: #<span class="number">31</span>                          <span class="comment">// Ljava/lang/Enum&lt;Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;&gt;;</span></span><br><span class="line">SourceFile: <span class="string">&quot;EnumSingleton.java&quot;</span></span><br></pre></td></tr></table></figure><p>In fact, the initialization process happens in the static initialization block (<code>static &#123;&#125;</code>, it’ll be executed when the class is first loaded.), the key code is as follows:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// allocates memory for an object of the class referenced by #4 -&gt; adds the reference to the top of the operand stack</span></span><br><span class="line"><span class="number">0</span>: <span class="keyword">new</span>           #<span class="number">4</span>                  <span class="comment">// class com/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// dup: duplicates the top stack value -&gt; adds the duplicated reference to the top of the operand stack</span></span><br><span class="line"><span class="number">3</span>: dup</span><br><span class="line"></span><br><span class="line"><span class="comment">// ldc: loads String instance onto the stack</span></span><br><span class="line"><span class="number">4</span>: ldc           #<span class="number">7</span>                  <span class="comment">// String instance</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// iconst_0: pushes the integer constant 0 onto the stack</span></span><br><span class="line"><span class="number">6</span>: iconst_0</span><br><span class="line"></span><br><span class="line"><span class="comment">// invokespecial：invokes the constructor EnumSingleton(String, int) to initialize</span></span><br><span class="line"><span class="number">7</span>: invokespecial #<span class="number">8</span>                  <span class="comment">// Method &quot;&lt;init&gt;&quot;:(Ljava/lang/String;I)V</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// putstatic: assigns the created instance to the static field `instance` of EnumSingleton</span></span><br><span class="line"><span class="number">10</span>: putstatic     #<span class="number">9</span>                  <span class="comment">// Field instance:Lcom/sissilab/dp/ox1_creational/ox11_singleton/EnumSingleton;</span></span><br></pre></td></tr></table></figure><h2 id="41-reflection-attack-on-enum-singleton"><a class="markdownIt-Anchor" href="#41-reflection-attack-on-enum-singleton"></a> 4.1. Reflection Attack on Enum Singleton</h2><p>When attempting to obtain the instance of an enum class through reflection, an error will be thrown: <code>java.lang.IllegalArgumentException: Cannot reflectively create enum objects</code>. This effectively prevents reflection attacks</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReflectionAttackOnEnumSingleton</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException &#123;</span><br><span class="line">    <span class="comment">// get the constructor: only automatically generate a private constructor with two parameters, like `private EnumSingleton(String, int)`</span></span><br><span class="line">    Constructor&lt;EnumSingleton&gt; constructor = EnumSingleton.class.getDeclaredConstructor(String.class, <span class="type">int</span>.class);</span><br><span class="line">    <span class="comment">// set the accessibility of the constructor</span></span><br><span class="line">    constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    <span class="comment">// reflectInstance: create the instance through constructor</span></span><br><span class="line">    <span class="type">EnumSingleton</span> <span class="variable">reflectInstance</span> <span class="operator">=</span> constructor.newInstance(<span class="string">&quot;instance&quot;</span>, <span class="number">0</span>); <span class="comment">// java.lang.IllegalArgumentException: Cannot reflectively create enum objects</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// instance: get the instance through the normal public static final `instance` field</span></span><br><span class="line">    <span class="type">EnumSingleton</span> <span class="variable">instance</span> <span class="operator">=</span> EnumSingleton.instance;</span><br><span class="line"></span><br><span class="line">    Assertions.assertSame(reflectInstance, instance); <span class="comment">// ×</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In fact, the error is thrown during <code>public T newInstance(Object ... initargs)</code>. The following source code indicates that there is an explicit check about whether current class is enum type and the <code>IllegalArgumentException</code> will be thrown if yes. So, Enum Singleton can prevent reflection attacks.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Constructor</span>&lt;T&gt; <span class="keyword">extends</span> <span class="title class_">Executable</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@CallerSensitive</span></span><br><span class="line">    <span class="keyword">public</span> T <span class="title function_">newInstance</span><span class="params">(Object ... initargs)</span> <span class="keyword">throws</span> InstantiationException, IllegalAccessException, IllegalArgumentException, InvocationTargetException &#123;</span><br><span class="line">        <span class="keyword">if</span> (!override) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!Reflection.quickCheckMemberAccess(clazz, modifiers)) &#123;</span><br><span class="line">                Class&lt;?&gt; caller = Reflection.getCallerClass();</span><br><span class="line">                checkAccess(caller, clazz, <span class="literal">null</span>, modifiers);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// If current class is enum type, the `IllegalArgumentException` will be thrown.</span></span><br><span class="line">        <span class="keyword">if</span> ((clazz.getModifiers() &amp; Modifier.ENUM) != <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Cannot reflectively create enum objects&quot;</span>);</span><br><span class="line">        <span class="type">ConstructorAccessor</span> <span class="variable">ca</span> <span class="operator">=</span> constructorAccessor;   <span class="comment">// read volatile</span></span><br><span class="line">        <span class="keyword">if</span> (ca == <span class="literal">null</span>) &#123;</span><br><span class="line">            ca = acquireConstructorAccessor();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">        <span class="type">T</span> <span class="variable">inst</span> <span class="operator">=</span> (T) ca.newInstance(initargs);</span><br><span class="line">        <span class="keyword">return</span> inst;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="42-serialization-attack-on-enum-singleton"><a class="markdownIt-Anchor" href="#42-serialization-attack-on-enum-singleton"></a> 4.2. Serialization Attack on Enum Singleton</h2><p>Every enum classes implicitly inherit from <code>java.lang.Enum</code> abstract class that implements <code>java.io.Serializable</code>, which means enum classes can support serialization and deserialization. Thanks to its built-in mechanisms, Enum Singleton is inherently safe from serialization attacks, for no new instances of enum constants are created during deserialization.</p><p>Let’s see what happened about Enum Singleton in deserialization source code. Within <code>readObject0(type, false)</code> method, in the case-when for TC_ENUM：–&gt; <code>readEnum(boolean unshared)</code>：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Enum&lt;?&gt; readEnum(<span class="type">boolean</span> unshared) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">// only objects serialized as enum are processed</span></span><br><span class="line">    <span class="keyword">if</span> (bin.readByte() != TC_ENUM) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InternalError</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">ObjectStreamClass</span> <span class="variable">desc</span> <span class="operator">=</span> readClassDesc(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// If the class isn&#x27;t an enum, an InvalidClassException will be thrown. </span></span><br><span class="line">    <span class="keyword">if</span> (!desc.isEnum()) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">InvalidClassException</span>(<span class="string">&quot;non-enum class: &quot;</span> + desc);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">enumHandle</span> <span class="operator">=</span> handles.assign(unshared ? unsharedMarker : <span class="literal">null</span>);</span><br><span class="line">    <span class="type">ClassNotFoundException</span> <span class="variable">resolveEx</span> <span class="operator">=</span> desc.getResolveException();</span><br><span class="line">    <span class="keyword">if</span> (resolveEx != <span class="literal">null</span>) &#123;</span><br><span class="line">        handles.markException(enumHandle, resolveEx);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the name of the enum constant, e.g. `instance` (Each constant name must be unique within an enum.)</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> readString(<span class="literal">false</span>);</span><br><span class="line">    Enum&lt;?&gt; result = <span class="literal">null</span>;</span><br><span class="line">    Class&lt;?&gt; cl = desc.forClass();</span><br><span class="line">    <span class="keyword">if</span> (cl != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">            <span class="comment">// find the constant using the enum class (e.g. `EnumSingleton`) and the constant name (e.g. `instance`)</span></span><br><span class="line">            <span class="comment">// It&#x27;s the key part that no new enum instances are created, regardless of how many times the enum is serialized and deserialized.</span></span><br><span class="line">            Enum&lt;?&gt; en = Enum.valueOf((Class)cl, name);</span><br><span class="line">            result = en;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalArgumentException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> (IOException) <span class="keyword">new</span> <span class="title class_">InvalidObjectException</span>(</span><br><span class="line">                <span class="string">&quot;enum constant &quot;</span> + name + <span class="string">&quot; does not exist in &quot;</span> +</span><br><span class="line">                cl).initCause(ex);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!unshared) &#123;</span><br><span class="line">            <span class="comment">// In the default mode (Shared Mode), the `unshared` is false. This means that if an object appears multiple times in a serialized stream, all references to that object will point to the same deserialized instance.</span></span><br><span class="line">            <span class="comment">// The existing handle (`Object[] entries`) will be updated, which can ensure that the same enum instance is reused, especially for Enum Singleton.</span></span><br><span class="line">            handles.setObject(enumHandle, result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handles.finish(enumHandle);</span><br><span class="line">    passHandle = enumHandle;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;T&gt;&gt; T <span class="title function_">valueOf</span><span class="params">(Class&lt;T&gt; enumType, String name)</span> &#123;</span><br><span class="line">    <span class="comment">// get the enum constant by its name from an internal map (`Map&lt;String, T&gt; enumConstantDirectory`)</span></span><br><span class="line">    <span class="comment">// There&#x27;s a pre-built internal map within `enumConstantDirectory()` that contains all enum constants loaded into memory, which ensures the uniqueness of each enum constant.</span></span><br><span class="line">    <span class="type">T</span> <span class="variable">result</span> <span class="operator">=</span> enumType.enumConstantDirectory().get(name);</span><br><span class="line">    <span class="keyword">if</span> (result != <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    <span class="keyword">if</span> (name == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;Name is null&quot;</span>);</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(</span><br><span class="line">        <span class="string">&quot;No enum constant &quot;</span> + enumType.getCanonicalName() + <span class="string">&quot;.&quot;</span> + name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="43-perfect-version-of-enum-singleton"><a class="markdownIt-Anchor" href="#43-perfect-version-of-enum-singleton"></a> 4.3. Perfect Version of Enum Singleton</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Use this singleton:</span></span><br><span class="line"><span class="comment"> * `EnumSingletonPerfect.instance.anyMethod();`</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">EnumSingletonPerfect</span> &#123;</span><br><span class="line">    instance;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">anyMethod</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Access the lazy-loaded resource:</span></span><br><span class="line"><span class="comment">     * `EnumSingletonPerfect.instance.getExpensiveResource().useResource();`</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// Using a static inner class to implement lazy loading of heavy resources</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LazyHeavyResource</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">HeavyResource</span> <span class="variable">RESOURCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HeavyResource</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> HeavyResource <span class="title function_">getExpensiveResource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> LazyHeavyResource.RESOURCE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This static inner class represents a heavy resource.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">HeavyResource</span> &#123;</span><br><span class="line">        HeavyResource() &#123;</span><br><span class="line">            <span class="comment">// simulate expensive initialization... need a lot of time to load</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                TimeUnit.SECONDS.sleep(<span class="number">3</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">useResource</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Use this heavy resource...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="5-application-in-source-code"><a class="markdownIt-Anchor" href="#5-application-in-source-code"></a> 5. Application in Source Code</h1><h2 id="51-javalangruntime-eager-singleton-static-constant"><a class="markdownIt-Anchor" href="#51-javalangruntime-eager-singleton-static-constant"></a> 5.1. java.lang.Runtime (Eager Singleton - static constant)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Eager initialization: the single instance `currentRuntime` is initialized when the class is loaded, ensuring that the instance is created early (eagerly) and is thread-safe.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Runtime</span> &#123;</span><br><span class="line">    <span class="comment">// holds the singleton instance: initialized when loading the class</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Runtime</span> <span class="variable">currentRuntime</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runtime</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// private constructor: prevents external instantiation</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Runtime</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Runtime <span class="title function_">getRuntime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> currentRuntime;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="52-orgquartzimplschedulerrepository-lazy-singleton-synchronized"><a class="markdownIt-Anchor" href="#52-orgquartzimplschedulerrepository-lazy-singleton-synchronized"></a> 5.2. org.quartz.impl.SchedulerRepository (Lazy Singleton - synchronized)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Scheduler scheduler = new StdSchedulerFactory().getScheduler(); -&gt; SchedulerRepository schedRep = SchedulerRepository.getInstance();</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SchedulerRepository</span> &#123;</span><br><span class="line">    <span class="comment">// holds the singleton instance</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SchedulerRepository inst;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// private constructor: prevents external instantiation</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">SchedulerRepository</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance: use static synchronized method to ensure thread safety</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> SchedulerRepository <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (inst == <span class="literal">null</span>) &#123;</span><br><span class="line">            inst = <span class="keyword">new</span> <span class="title class_">SchedulerRepository</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> inst;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="53-spring-orgspringframeworkbeansfactorysupportdefaultsingletonbeanregistry-lazy-singleton-double-checked-locking"><a class="markdownIt-Anchor" href="#53-spring-orgspringframeworkbeansfactorysupportdefaultsingletonbeanregistry-lazy-singleton-double-checked-locking"></a> 5.3. Spring - org.springframework.beans.factory.support.DefaultSingletonBeanRegistry (Lazy Singleton - Double-checked Locking)</h2><p>Spring’s singleton pattern: When a bean is defined in the Spring application context without explicitly specified scope, Spring will treat it as a singleton by default. This means that Spring will create only one instance of the bean that can be shared by all the classes. By leveraging this kind of singleton pattern in Spring, we can benefit from efficient memory management, centralized bean configuration, and the sharing and reuse of bean instances across the application.</p><p>In Spring, the process of loading a singleton typically starts from the <code>getBean()</code> method of the <code>org.springframework.beans.factory.BeanFactory</code>, whose default implementation is the abstract class <code>org.springframework.beans.factory.support.AbstractBeanFactory</code>. The various <code>getBean()</code> methods ultimately call the <code>doGetBean()</code> method of <code>AbstractBeanFactory</code>, such as <code>org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean</code>.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// org.springframework.beans.factory.support.AbstractBeanFactory</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractBeanFactory</span> <span class="keyword">extends</span> <span class="title class_">FactoryBeanRegistrySupport</span> <span class="keyword">implements</span> <span class="title class_">ConfigurableBeanFactory</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> &lt;T&gt; T <span class="title function_">doGetBean</span><span class="params">(<span class="keyword">final</span> String name, <span class="keyword">final</span> Class&lt;T&gt; requiredType, <span class="keyword">final</span> Object[] args, <span class="type">boolean</span> typeCheckOnly)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="comment">// get the transformed bean name, in case the name contains illegal characters</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">beanName</span> <span class="operator">=</span> transformedBeanName(name);</span><br><span class="line">        Object bean;</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// Eagerly check singleton cache for manually registered singletons.</span></span><br><span class="line">        <span class="comment">// In general, it will return null the first time a bean is requested.</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">sharedInstance</span> <span class="operator">=</span> getSingleton(beanName);</span><br><span class="line">        <span class="keyword">if</span> (sharedInstance != <span class="literal">null</span> &amp;&amp; args == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// get the object for the given bean instance, either the bean instance itself or its created object in case of a FactoryBean. </span></span><br><span class="line">            bean = getObjectForBeanInstance(sharedInstance, name, beanName, <span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">final</span> <span class="type">RootBeanDefinition</span> <span class="variable">mbd</span> <span class="operator">=</span> getMergedLocalBeanDefinition(beanName);</span><br><span class="line">                <span class="comment">// ...</span></span><br><span class="line">    </span><br><span class="line">                <span class="comment">// Create bean instance.</span></span><br><span class="line">                <span class="keyword">if</span> (mbd.isSingleton()) &#123;</span><br><span class="line">                    <span class="comment">// If the bean is a singleton, it will enter the overloaded `getSingleton()` method.</span></span><br><span class="line">                    sharedInstance = getSingleton(beanName, <span class="keyword">new</span> <span class="title class_">ObjectFactory</span>&lt;Object&gt;() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> Object <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                <span class="keyword">return</span> createBean(beanName, mbd, args);</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (BeansException ex) &#123;</span><br><span class="line">                                destroySingleton(beanName);</span><br><span class="line">                                <span class="keyword">throw</span> ex;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    bean = getObjectForBeanInstance(sharedInstance, name, beanName, mbd);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mbd.isPrototype()) &#123;</span><br><span class="line">                    <span class="comment">// ...</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// ...</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (BeansException ex) &#123;</span><br><span class="line">                cleanupAfterBeanCreationFailure(beanName);</span><br><span class="line">                <span class="keyword">throw</span> ex;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        <span class="keyword">return</span> (T) bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The statement <code>Object sharedInstance = getSingleton(beanName);</code> within the <code>getBean()</code> method is the core implementation of the Singleton pattern (Double Check) in Spring. The <code>getSingleton()</code> method is defined in the parent class of <code>AbstractBeanFactory</code>, which is <code>DefaultSingletonBeanRegistry</code>.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DefaultSingletonBeanRegistry</span> <span class="keyword">extends</span> <span class="title class_">SimpleAliasRegistry</span> <span class="keyword">implements</span> <span class="title class_">SingletonBeanRegistry</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Cache of singleton objects (fully initialized singleton beans): bean name -&gt; bean instance</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, Object&gt; singletonObjects = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;(<span class="number">256</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Cache of early singleton objects (currently being created singleton beans, partially created): bean name -&gt; bean instance</span></span><br><span class="line">    <span class="comment">// It&#x27;s the key to resolving circular dependencies.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, Object&gt; earlySingletonObjects = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Cache of singleton factories: bean name -&gt; ObjectFactory</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, ObjectFactory&lt;?&gt;&gt; singletonFactories = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getSingleton</span><span class="params">(String beanName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getSingleton(beanName, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the bean from cache based on DCL pattern</span></span><br><span class="line">    <span class="comment">// `singletonObjects` -&gt; `earlySingletonObjects` -&gt; `singletonFactories` -&gt; create the singleon bean through `singletonFactory.getObject()`</span></span><br><span class="line">    <span class="keyword">protected</span> Object <span class="title function_">getSingleton</span><span class="params">(String beanName, <span class="type">boolean</span> allowEarlyReference)</span> &#123;</span><br><span class="line">        <span class="comment">// (1) `singletonObjects`: check if the cache contains the bean</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">singletonObject</span> <span class="operator">=</span> <span class="built_in">this</span>.singletonObjects.get(beanName);</span><br><span class="line">        <span class="comment">// The singleton in `singletonObjects` is not found. &amp;&amp; The singleton bean is currently being created.</span></span><br><span class="line">        <span class="comment">// isSingletonCurrentlyInCreation(beanName): If it&#x27;s true, when the singleton bean is in the process of being created but not yet fully initialized.</span></span><br><span class="line">        <span class="keyword">if</span> (singletonObject == <span class="literal">null</span> &amp;&amp; isSingletonCurrentlyInCreation(beanName)) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (<span class="built_in">this</span>.singletonObjects) &#123; <span class="comment">// synchronized on the `singletonObjects` map to ensure thread safety</span></span><br><span class="line">                <span class="comment">// (2) `earlySingletonObjects`: this cache holds beans that are in the process of being created.</span></span><br><span class="line">                singletonObject = <span class="built_in">this</span>.earlySingletonObjects.get(beanName);</span><br><span class="line">                <span class="comment">// The singleton in `earlySingletonObjects` is not found. &amp;&amp; `allowEarlyReference` is true.</span></span><br><span class="line">                <span class="keyword">if</span> (singletonObject == <span class="literal">null</span> &amp;&amp; allowEarlyReference) &#123;</span><br><span class="line">                    <span class="comment">// When certain methods require early initialization, the `addSingleFactory()` method is called to store the corresponding `ObjectFactory` initialization strategy in the `singletonFactories` map.</span></span><br><span class="line">                    <span class="comment">// (3) `singletonFactories`: get the ObjectFactory by the beanName</span></span><br><span class="line">                    ObjectFactory&lt;?&gt; singletonFactory = <span class="built_in">this</span>.singletonFactories.get(beanName);</span><br><span class="line">                    <span class="keyword">if</span> (singletonFactory != <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="comment">// create and get the bean</span></span><br><span class="line">                        singletonObject = singletonFactory.getObject();</span><br><span class="line">                        <span class="comment">// update the two caches: `earlySingletonObjects` and `singletonFactories` are mutually exclusive.</span></span><br><span class="line">                        <span class="built_in">this</span>.earlySingletonObjects.put(beanName, singletonObject);</span><br><span class="line">                        <span class="built_in">this</span>.singletonFactories.remove(beanName);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (singletonObject != NULL_OBJECT ? singletonObject : <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In general, the first time <code>getSingleton()</code> is called in <code>doGetBean()</code>, the corresponding bean instance is not found in the cache. It then proceeds to the <code>if (mbd.isSingleton()) &#123; &#125;</code> block, where the overloaded <code>getSingleton()</code> method is called. Within this method, the bean is instantiated, and the instance is then cached in the <code>singletonObjects</code> map, allowing for the direct return of the singleton bean in subsequent requests.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DefaultSingletonBeanRegistry</span> <span class="keyword">extends</span> <span class="title class_">SimpleAliasRegistry</span> <span class="keyword">implements</span> <span class="title class_">SingletonBeanRegistry</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getSingleton</span><span class="params">(String beanName, ObjectFactory&lt;?&gt; singletonFactory)</span> &#123;</span><br><span class="line">        Assert.notNull(beanName, <span class="string">&quot;&#x27;beanName&#x27; must not be null&quot;</span>);</span><br><span class="line">        <span class="comment">// Since the creation process involves operations on the `singletonObjects`, locking is required.</span></span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="built_in">this</span>.singletonObjects) &#123;</span><br><span class="line">            <span class="comment">// 1. try to get the bean from `singletonObjects` map again and check if the bean has already been loaded. If the bean has been loaded, it is directly returned.</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">singletonObject</span> <span class="operator">=</span> <span class="built_in">this</span>.singletonObjects.get(beanName);</span><br><span class="line">            <span class="keyword">if</span> (singletonObject == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 2. If the current BeanFactory is in the process of being destroyed, an exception is thrown directly, and the creation of the singleton bean is not allowed.</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">this</span>.singletonsCurrentlyInDestruction) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BeanCreationNotAllowedException</span>(beanName,</span><br><span class="line">                                                              <span class="string">&quot;Singleton bean creation not allowed while singletons of this factory are in destruction &quot;</span> +</span><br><span class="line">                                                              <span class="string">&quot;(Do not request a bean from a BeanFactory in a destroy method implementation!)&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class="line">                    logger.debug(<span class="string">&quot;Creating shared instance of singleton bean &#x27;&quot;</span> + beanName + <span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 3. Some preparatory work before creating the bean: </span></span><br><span class="line">                <span class="comment">// The beanName is recorded as currently in the process of being loaded (added to the `singletonsCurrentlyInCreation` cache).</span></span><br><span class="line">                <span class="comment">// If the bean is already in the process of being loaded, an exception is thrown.</span></span><br><span class="line">                <span class="comment">// It&#x27;s to address the issue of circular references.</span></span><br><span class="line">                beforeSingletonCreation(beanName);</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">newSingleton</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">                <span class="type">boolean</span> <span class="variable">recordSuppressedExceptions</span> <span class="operator">=</span> (<span class="built_in">this</span>.suppressedExceptions == <span class="literal">null</span>);</span><br><span class="line">                <span class="keyword">if</span> (recordSuppressedExceptions) &#123;</span><br><span class="line">                    <span class="built_in">this</span>.suppressedExceptions = <span class="keyword">new</span> <span class="title class_">LinkedHashSet</span>&lt;Exception&gt;();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">// 4. Get the bean instance through a callback mechanism.</span></span><br><span class="line">                    singletonObject = singletonFactory.getObject();</span><br><span class="line">                    newSingleton = <span class="literal">true</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalStateException ex) &#123;</span><br><span class="line">                    <span class="comment">// Has the singleton object implicitly appeared in the meantime -&gt;</span></span><br><span class="line">                    <span class="comment">// if yes, proceed with it since the exception indicates that state.</span></span><br><span class="line">                    singletonObject = <span class="built_in">this</span>.singletonObjects.get(beanName);</span><br><span class="line">                    <span class="keyword">if</span> (singletonObject == <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> ex;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (BeanCreationException ex) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (recordSuppressedExceptions) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (Exception suppressedException : <span class="built_in">this</span>.suppressedExceptions) &#123;</span><br><span class="line">                            ex.addRelatedCause(suppressedException);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">throw</span> ex;</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (recordSuppressedExceptions) &#123;</span><br><span class="line">                        <span class="built_in">this</span>.suppressedExceptions = <span class="literal">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 5. Post-processing steps after the singleton bean is loaded: </span></span><br><span class="line">                    <span class="comment">// The record of the bean being currently in the process of creation is removed (the beanName is removed from the `singletonsCurrentlyInCreation` cache).</span></span><br><span class="line">                    afterSingletonCreation(beanName); <span class="comment">// 从 singletonsCurrentlyInCreation 中移除该 beanName</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (newSingleton) &#123;</span><br><span class="line">                    <span class="comment">// 6. added to the `singletonObjects` cache and removed from other auxiliary caches (e.g. `singletonFactories`, `earlySingletonObjects`)</span></span><br><span class="line">                    addSingleton(beanName, singletonObject);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> (singletonObject != NULL_OBJECT ? singletonObject : <span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="54-spring-orgspringframeworkcorereactiveadapterregistry-lazy-singleton-double-checked-locking"><a class="markdownIt-Anchor" href="#54-spring-orgspringframeworkcorereactiveadapterregistry-lazy-singleton-double-checked-locking"></a> 5.4. Spring - org.springframework.core.ReactiveAdapterRegistry (Lazy Singleton - Double-checked Locking)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReactiveAdapterRegistry</span> &#123;</span><br><span class="line">    <span class="comment">// holds the singleton instance: add volatile to prevent reordering</span></span><br><span class="line">    <span class="meta">@Nullable</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> ReactiveAdapterRegistry sharedInstance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use double-checked locking</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ReactiveAdapterRegistry <span class="title function_">getSharedInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ReactiveAdapterRegistry</span> <span class="variable">registry</span> <span class="operator">=</span> sharedInstance;</span><br><span class="line">        <span class="keyword">if</span> (registry == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (ReactiveAdapterRegistry.class) &#123;</span><br><span class="line">                registry = sharedInstance;</span><br><span class="line">                <span class="keyword">if</span> (registry == <span class="literal">null</span>) &#123;</span><br><span class="line">                    registry = <span class="keyword">new</span> <span class="title class_">ReactiveAdapterRegistry</span>();</span><br><span class="line">                    sharedInstance = registry;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> registry;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="55-spring-orgspringframeworkaopframeworkproxyfactorybean-lazy-singleton-synchronized"><a class="markdownIt-Anchor" href="#55-spring-orgspringframeworkaopframeworkproxyfactorybean-lazy-singleton-synchronized"></a> 5.5. Spring - org.springframework.aop.framework.ProxyFactoryBean (Lazy Singleton - synchronized)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyFactoryBean</span> <span class="keyword">extends</span> <span class="title class_">ProxyCreatorSupport</span></span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;Object&gt;, BeanClassLoaderAware, BeanFactoryAware &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Object singletonInstance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// controls access to the singleton instance: use synchronized method to ensure thread safety</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">synchronized</span> Object <span class="title function_">getSingletonInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.singletonInstance == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.targetSource = freshTargetSource();</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.autodetectInterfaces &amp;&amp; getProxiedInterfaces().length == <span class="number">0</span> &amp;&amp; !isProxyTargetClass()) &#123;</span><br><span class="line">                <span class="comment">// Rely on AOP infrastructure to tell us what interfaces to proxy.</span></span><br><span class="line">                Class&lt;?&gt; targetClass = getTargetClass();</span><br><span class="line">                <span class="keyword">if</span> (targetClass == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">FactoryBeanNotInitializedException</span>(<span class="string">&quot;Cannot determine target class for proxy&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                setInterfaces(ClassUtils.getAllInterfacesForClass(targetClass, <span class="built_in">this</span>.proxyClassLoader));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Initialize the shared singleton instance.</span></span><br><span class="line">            <span class="built_in">super</span>.setFrozen(<span class="built_in">this</span>.freezeProxy);</span><br><span class="line">            <span class="comment">// create AOP dynamic proxy and get the instance</span></span><br><span class="line">            <span class="built_in">this</span>.singletonInstance = getProxy(createAopProxy());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.singletonInstance;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="56-tomcat-orgapachecatalinawebresourcestomcaturlstreamhandlerfactory-lazy-singleton-double-checked-locking"><a class="markdownIt-Anchor" href="#56-tomcat-orgapachecatalinawebresourcestomcaturlstreamhandlerfactory-lazy-singleton-double-checked-locking"></a> 5.6. Tomcat - org.apache.catalina.webresources.TomcatURLStreamHandlerFactory (Lazy Singleton - Double-checked Locking)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TomcatURLStreamHandlerFactory</span> <span class="keyword">implements</span> <span class="title class_">URLStreamHandlerFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// holds the singleton instance: add volatile to prevent reordering</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> <span class="type">TomcatURLStreamHandlerFactory</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> TomcatURLStreamHandlerFactory <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        getInstanceInternal(<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use double-checked locking</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> TomcatURLStreamHandlerFactory <span class="title function_">getInstanceInternal</span><span class="params">(<span class="type">boolean</span> register)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Class</span> <span class="variable">var1</span> <span class="operator">=</span> TomcatURLStreamHandlerFactory.class;</span><br><span class="line">            <span class="keyword">synchronized</span>(TomcatURLStreamHandlerFactory.class) &#123;</span><br><span class="line">                <span class="keyword">if</span> (instance == <span class="literal">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">TomcatURLStreamHandlerFactory</span>(register);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="references"><a class="markdownIt-Anchor" href="#references"></a> References</h1><ul><li><a href="https://en.wikipedia.org/wiki/Singleton_pattern">Singleton pattern - Wikipedia</a></li><li><a href="https://java-design-patterns.com/patterns/singleton/">Singleton Pattern in Java: Implementing Global Access Points in Java Applications | Java Design Patterns (java-design-patterns.com)</a></li><li><a href="https://www.runoob.com/design-pattern/singleton-pattern.html">菜鸟教程-单例模式</a></li></ul>]]></content>
        
        
        <categories>
            
            <category> 23 Design Patterns </category>
            
            <category> 1. Creational Pattern </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Design_Pattern </tag>
            
            <tag> Creational_Pattern </tag>
            
        </tags>
        
    </entry>
    
    
    
    <entry>
        <title>Design Pattern Overview</title>
        <link href="/en/design-pattern/design-pattern-overview/"/>
        <url>/en/design-pattern/design-pattern-overview/</url>
        
        <content type="html"><![CDATA[<p><strong>1. Creational Pattern:</strong></p><ul class="contains-task-list"><li class="task-list-item"><input class="task-list-item-checkbox" checked="" disabled="" type="checkbox"> <a href="/en/design-pattern/singleton-pattern">1.1.Singleton Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" checked="" disabled="" type="checkbox"> <a href="/en/design-pattern/factory-method-pattern">1.2.Factory Method Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" checked="" disabled="" type="checkbox"> <a href="/en/design-pattern/abstract-factory-pattern">1.3.Abstract Factory Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">1.4.Builder Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">1.5.Prototype Pattern</a></li></ul><p><strong>2. Strctural Pattern:</strong></p><ul class="contains-task-list"><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">2.1.Adapter Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">2.2.Decorator Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">2.3.Proxy Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">2.4.Facade Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">2.5.Bridge Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">2.6.Composite Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">2.7.Flyweight Pattern</a></li></ul><p><strong>3. Behavioral Pattern:</strong></p><ul class="contains-task-list"><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.1.Strategy Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.2.Template Method Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.3.Observer Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.4.Iterator Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.5.Chain of Responsibility Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.6.Command Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.7.Memento Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.8.State Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.9.Visitor Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.10.Mediator Pattern</a></li><li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox"> <a href="#">3.11.Interpreter Pattern</a></li></ul>]]></content>
        
        
        <categories>
            
            <category> 23 Design Patterns </category>
            
            <category> 0. Overview </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Design_Pattern </tag>
            
            <tag> Overview </tag>
            
        </tags>
        
    </entry>
    
    
    
    
</search>